"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[161],{65557:function(e,n,t){var i=t(21831),o=t(75582),l=t(82684),r=t(80329);n.Z=function(e){var n=e.children,t=e.uuid,u=e.uuids,c=void 0===u?[]:u,s=(0,r.j)("apiReloads"),d=(0,o.Z)(s,1)[0],a=(0,i.Z)(c);t&&a.push(t);var f=a.map((function(e){return String(d[e])||"-"})).join("_");return l.cloneElement(n,{key:f})}},29618:function(e,n,t){t.d(n,{Z:function(){return B}});var i=t(82394),o=t(75582),l=t(17717),r=t(82684),u=t(80329),c=t(69864),s=t(40761),d=t(44425),a=t(71180),f=t(38626),v=t(97618),p=t(55485),h=t(28598),b=f.default.div.withConfig({displayName:"ButtonGroup__ButtonGroupStyle",componentId:"sc-15vbmc8-0"})([""]),m=f.default.div.withConfig({displayName:"ButtonGroup__VerticalDivider",componentId:"sc-15vbmc8-1"})(["width:1px;"]),g=function(e){var n=e.children,t=e.divider,i=r.Children.toArray(n).length;return(0,h.jsx)(b,{children:(0,h.jsx)(p.ZP,{children:r.Children.map(n,(function(e,n){return e&&(0,h.jsxs)(v.Z,{children:[n>=1&&t&&(0,h.jsx)(m,{}),r.cloneElement(e,{borderRadiusLeft:i>=2&&0===n,borderRadiusRight:i>=2&&n===i-1,halfPaddingLeft:i>=2&&0!==n,halfPaddingRight:i>=2&&n!==i-1,noBorder:i>=2&&n>0&&n<i-1,noBorderRight:i>=2&&n!==i-1})]},"button-group-child-".concat(n))}))})})},j=t(75810),k=t(89706),y=t(93369),x=t(57653),C=t(38276),P=t(35686),w=t(39643),Z=t(11498),O=t(85385),S=t(80330),F=t(86735),R=t(81728),_=t(72619),D=t(42041),E=t(44688);function I(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function T(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?I(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):I(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var B=function(e){var n,t=e.active,f=e.addNewBlock,v=e.disableRefreshWarning,b=e.fetchPipeline,m=e.fetchVariables,I=e.filePath,B=e.hideHeaderButtons,M=e.onContentChange,U=e.onUpdateFileSuccess,V=e.openSidekickView,N=e.pipeline,H=e.saveFile,A=e.selectedFilePath,z=e.sendTerminalMessage,L=e.setDisableShortcuts,W=e.setErrors,G=e.setFilesTouched,K=e.setSelectedBlock,X=(0,u.j)("apiReloads"),J=(0,o.Z)(X,2)[1],q=(0,r.useState)(null),$=q[0],Q=q[1],Y=(0,r.useState)(!1),ee=Y[0],ne=(Y[1],(0,r.useRef)(null)),te=(0,r.useMemo)((function(){return new s.Z}),[]),ie=(0,r.useMemo)((function(){return{api_key:Z.lG,token:te.decodedToken.token}}),[te]),oe=P.ZP.statuses.list().data,le=(0,r.useMemo)((function(){var e,n;return null===oe||void 0===oe||null===(e=oe.statuses)||void 0===e||null===(n=e[0])||void 0===n?void 0:n.repo_path}),[oe]),re=P.ZP.file_contents.detail(I).data;(0,r.useEffect)((function(){null!==re&&void 0!==re&&re.file_content?Q(re.file_content):null!==re&&void 0!==re&&re.error&&(0,_.h$)(re,{onErrorCallback:function(e,n){return W({errors:n,response:e})}})}),[re,W]);var ue=(0,r.useState)(null===$||void 0===$?void 0:$.content),ce=ue[0],se=ue[1],de=(0,r.useCallback)((function(e){se(e),M&&(null===M||void 0===M||M(e))}),[M]),ae=(0,r.useState)(!1),fe=ae[0],ve=ae[1];(0,r.useEffect)((function(){t&&L&&(null===L||void 0===L||L(!0))}),[t,L]),(0,r.useEffect)((function(){var e;A&&(null===ne||void 0===ne||null===(e=ne.current)||void 0===e||e.scrollIntoView())}),[A]);var pe=(0,c.Db)(P.ZP.file_contents.useUpdate((null===$||void 0===$?void 0:$.path)&&encodeURIComponent(null===$||void 0===$?void 0:$.path)),{onSuccess:function(e){return(0,_.wD)(e,{callback:function(e){var n=e.file_content;J((function(e){return T(T({},e),{},(0,i.Z)({},"FileVersions/".concat(null===$||void 0===$?void 0:$.path),Number(new Date)))})),U&&(null===U||void 0===U||U(n))},onErrorCallback:function(e,n){return null===W||void 0===W?void 0:W({errors:n,response:e})}})}}),he=(0,o.Z)(pe,1)[0],be=(0,r.useCallback)((function(e,n){if(H)return H(e,n);he({file_content:T(T({},n),{},{content:e})}).then((function(){decodeURIComponent(I).split(l.sep).pop()===k.dT.METADATA_YAML&&m&&(null===m||void 0===m||m())})),null===G||void 0===G||G((function(e){return T(T({},e),{},(0,i.Z)({},null===n||void 0===n?void 0:n.path,!1))})),ve(!1)}),[m,I,H,G,he]),me=(0,r.useMemo)((function(){return(0,S.lU)()}),[]),ge=(0,r.useMemo)((function(){var e,n,t,i;return null===(null===$||void 0===$||null===(e=$.path)||void 0===e?void 0:e.match(me))?k.Lu.TXT:null===$||void 0===$||null===(n=$.path)||void 0===n||null===(t=n.match(me))||void 0===t||null===(i=t[0])||void 0===i?void 0:i.split(".")[1]}),[me,$]),je=(0,r.useMemo)((function(){if(null!==$&&void 0!==$&&$.path)return(0,h.jsx)(j.Z,{autoHeight:!0,language:k.nB[ge],onChange:function(e){de(e),G&&G((function(e){return null!==e&&void 0!==e&&e[null===$||void 0===$?void 0:$.path]?e:T(T({},e),{},(0,i.Z)({},null===$||void 0===$?void 0:$.path,!0))})),ve(!0)},onSave:function(e){be(e,$)},padding:10,selected:!0,textareaFocused:!0,value:(0,R.Pb)(null===$||void 0===$?void 0:$.content)?JSON.stringify(JSON.parse(null===$||void 0===$?void 0:$.content),null,2):null===$||void 0===$?void 0:$.content,width:"100%"})}),[$,ge,be,de,G]),ke=null!==N&&void 0!==N&&N.blocks?(0,F.sE)(null===N||void 0===N?void 0:N.blocks,(function(e){var n=e.type;return d.tf.DATA_EXPORTER===n})):null,ye=(0,c.Db)(P.ZP.blocks.pipelines.useUpdate(encodeURIComponent(null===N||void 0===N?void 0:N.uuid),encodeURIComponent(null===ke||void 0===ke?void 0:ke.uuid)),{onSuccess:function(e){return(0,_.wD)(e,{callback:function(){null===b||void 0===b||b()}})}}),xe=(0,o.Z)(ye,1)[0],Ce=f&&N&&$&&k.tE.includes(ge)&&(0,S.ck)(null===$||void 0===$||null===(n=$.path)||void 0===n?void 0:n.split(l.sep))&&(0,h.jsx)(a.ZP,{onClick:function(){var e=(null===N||void 0===N?void 0:N.type)===x.qL.INTEGRATION,n=(0,S.TU)($,le,N);f(n,(function(n){e&&ke&&xe({block:T(T({},ke),{},{upstream_blocks:[n.uuid]})}),null===K||void 0===K||K(n)}))},primary:!0,children:"Add to current pipeline"}),Pe=z&&(0,h.jsx)(C.Z,{m:2,children:(0,h.jsx)(y.ZP,{disabled:!le,inline:!0,loading:ee,onClick:function(){null===V||void 0===V||V(O.cH.TERMINAL),null===z||void 0===z||z(JSON.stringify(T(T({},ie),{},{command:["stdin","pip install -r ".concat(le,"/requirements.txt\r")]})))},title:le?"Pip install packages from your saved requirements.txt file (\u2318+S to save).":"Please use right panel terminal to install packages.",uuid:"FileEditor/InstallPackages",children:"Install packages"})}),we="FileEditor/".concat(null===$||void 0===$?void 0:$.path),Ze=(0,E.y)(),Oe=Ze.registerOnKeyDown,Se=Ze.unregisterOnKeyDown;return(0,r.useEffect)((function(){return function(){Se(we)}}),[Se,we]),Oe(we,(function(e,n){if(t&&!v)if((0,D.y)([w.zX,w.Um],n)||(0,D.y)([w.PQ,w.Um],n))e.preventDefault(),be(ce,$);else if(fe&&(0,D.y)([w.zX,w.hS],n)){e.preventDefault();var i="".concat($.path," has changes that are unsaved. ")+"Click cancel and save your changes before reloading page.";"undefined"!==typeof location&&window.confirm(i)&&location.reload()}}),[t,ce,v,$,be,fe]),(0,h.jsxs)("div",{ref:ne,children:[!B&&(0,h.jsx)(C.Z,{p:2,children:(0,h.jsxs)(p.ZP,{justifyContent:"space-between",children:[(0,h.jsxs)(g,{children:[Ce,(0,h.jsx)(a.ZP,{disabled:!ce,onClick:function(e){e.preventDefault(),be(ce,$)},title:ce?null:"No changes have been made to this file.",children:"Save file content"})]}),V&&(0,h.jsx)(g,{children:(0,h.jsx)(a.ZP,{compact:!0,onClick:function(){V(O.cH.FILE_VERSIONS)},small:!0,title:"View previous changes to this file.",children:"Show versions"})})]})}),je,I===k.dT.REQS_TXT&&Pe]})}},69616:function(e,n,t){t.d(n,{Z:function(){return c}});var i=t(82684),o=t(38626),l=t(47041),r=o.default.div.withConfig({displayName:"indexstyle__ScrollerStyle",componentId:"sc-16b7ntp-0"})([""," align-items:center;display:flex;flex-direction:row;height:100%;overflow:auto;"],(0,l.y$)()),u=t(28598);var c=function(e){var n=e.children,t=(e.widthOffset,(0,i.useRef)(null)),o=(0,i.useRef)(null),l=(0,i.useState)(null),c=(l[0],l[1]);return(0,i.useEffect)((function(){setTimeout((function(){var e,n,i,l;c({scroll:(null===t||void 0===t||null===(e=t.current)||void 0===e||null===(n=e.getBoundingClientRect())||void 0===n?void 0:n.width)||0,tabs:(null===o||void 0===o||null===(i=o.current)||void 0===i||null===(l=i.getBoundingClientRect())||void 0===l?void 0:l.width)||0})}),1)}),[]),(0,u.jsx)(r,{ref:t,children:(0,u.jsx)("div",{ref:o,style:{height:"100%"},children:n})})}},28385:function(e,n,t){var i=t(82394),o=t(75582),l=t(17717),r=t(82684),u=t(80329),c=t(69864),s=t(71180),d=t(75810),a=t(89706),f=t(97618),v=t(55485),p=t(85854),h=t(38276),b=t(4190),m=t(75499),g=t(30160),j=t(35686),k=t(70515),y=t(80330),x=t(3917),C=t(81728),P=t(72619),w=t(95924),Z=t(86735),O=t(42122),S=t(28598);function F(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function R(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?F(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}n.Z=function(e){var n=e.onActionCallback,t=e.pipeline,F=e.selectedBlock,_=e.selectedFilePath,D=e.setErrors,E=e.width,I=(0,u.j)("apiReloads"),T=(0,o.Z)(I,2)[1],B=(0,r.useMemo)((function(){return _?encodeURIComponent(_):F?encodeURIComponent("".concat(null===F||void 0===F?void 0:F.type,"/").concat(null===F||void 0===F?void 0:F.uuid)):null}),[F,_]),M=j.ZP.file_versions.files.list(B,(0,O.hB)({block_uuid:null===F||void 0===F?void 0:F.uuid,pipeline_uuid:null===t||void 0===t?void 0:t.uuid})),U=M.data,V=M.mutate,N=(0,r.useMemo)((function(){return(null===U||void 0===U?void 0:U.file_versions)||[]}),[U]),H=(0,r.useState)(null),A=H[0],z=H[1],L=(0,r.useMemo)((function(){return null===N||void 0===N?void 0:N[A]}),[A,N]),W=j.ZP.file_contents.detail(L?encodeURIComponent(L.path):null).data,G=(0,r.useMemo)((function(){return null===W||void 0===W?void 0:W.file_content}),[W]),K=(0,r.useMemo)((function(){return(0,y.lU)()}),[]),X=(0,r.useMemo)((function(){var e,n,t;return null===_||void 0===_||null===(e=_.match(K))||void 0===e||null===(n=e[0])||void 0===n||null===(t=n.split("."))||void 0===t?void 0:t[1]}),[_,K]),J=(0,c.Db)(j.ZP.file_contents.useUpdate(B),{onSuccess:function(e){return(0,P.wD)(e,{callback:function(e){var t;_&&V();var o=null===e||void 0===e||null===(t=e.file_content)||void 0===t?void 0:t.path,r="FileEditor/".concat(o);if(o){var u=o.split(l.sep);if("pipelines"===u[0]){var c=u.slice(1,u.length-1).join(l.sep);r="PipelineDetail/".concat(c)}}T((function(e){return R(R({},e),{},(0,i.Z)({},r,Number(new Date)))})),z((function(e){return e+1})),null===n||void 0===n||n(null===e||void 0===e?void 0:e.file_content,{blockUUID:null===F||void 0===F?void 0:F.uuid})},onErrorCallback:function(e,n){return D({errors:n,response:e})}})}}),q=(0,o.Z)(J,2),$=q[0],Q=q[1].isLoading,Y=(0,r.useCallback)((function(e){var n=R({},e);return _||(n.block_uuid=null===F||void 0===F?void 0:F.uuid,n.pipeline_uuid=null===t||void 0===t?void 0:t.uuid),$({file_content:n})}),[t,F,_,$]),ee=(0,r.useMemo)((function(){var e=N.map((function(e){var n=e.name,t=e.path;return[(0,S.jsxs)(v.ZP,{alignItems:"center",justifyContent:"space-between",children:[(0,S.jsxs)(f.Z,{flex:1,children:[(0,S.jsx)(g.ZP,{default:!0,monospace:!0,children:(0,x.JX)(n,{withSeconds:!0})}),(0,S.jsx)(h.Z,{px:2*k.cd,children:(0,S.jsx)(g.ZP,{monospace:!0,children:n})})]}),L&&(null===L||void 0===L?void 0:L.path)===t&&(0,S.jsx)(s.ZP,{compact:!0,loading:Q,onClick:function(e){(0,w.j)(e),Y({version:n})},small:!0,children:"Replace with this version"})]},n)]}));if(L){var n=(0,S.jsx)(h.Z,{p:k.cd,children:(0,S.jsx)(b.Z,{},"spinner")});if(G&&(null===G||void 0===G?void 0:G.path)===(null===L||void 0===L?void 0:L.path)){var t=G.content,i=void 0===t?"":t;n=(0,S.jsx)(d.Z,{autoHeight:!0,language:a.nB[X],padding:2*k.iI,readOnly:!0,value:(0,C.Pb)(i)?JSON.stringify(JSON.parse(i),null,2):i,width:E})}e=(0,Z.Hk)([n],A+1,e)}return e}),[G,X,N,Q,L,A,Y,E]);return(0,S.jsxs)("div",{style:{width:E},children:[(0,S.jsxs)(h.Z,{p:k.cd,children:[(0,S.jsx)(p.Z,{level:5,children:"File versions"}),(0,S.jsx)(g.ZP,{inline:!0,monospace:!0,children:_?decodeURIComponent(_):null===F||void 0===F?void 0:F.uuid})]}),(0,S.jsx)(m.Z,{buildRowProps:function(e){if(L&&A+1===e)return{renderCell:function(e){return e},renderRow:function(e){return e}}},columnFlex:[1],columns:[{uuid:"Version"}],isSelectedRow:function(e){var n;return(null===(n=N[e])||void 0===n?void 0:n.name)===(null===L||void 0===L?void 0:L.name)},onClickRow:function(e){L?e===A?z(null):e<A?z(e):e>A+1&&z(e-1):z(e)},rows:ee})]})}},88353:function(e,n,t){t.d(n,{Z:function(){return N}});var i=t(82394),o=t(75582),l=t(82684),r=t(80329),u=t(69864),c=t(65557),s=t(29618),d=t(28598);var a=function(e){var n=e.addNewBlock,t=e.disableRefreshWarning,o=e.fetchPipeline,l=e.fetchVariables,r=e.onUpdateFileSuccess,u=e.openFilePaths,a=e.openSidekickView,f=e.pipeline,v=e.saveFile,p=e.selectedFilePath,h=e.sendTerminalMessage,b=e.setContentByFilePath,m=e.setDisableShortcuts,g=e.setErrors,j=e.setFilesTouched,k=e.setSelectedBlock;return(0,d.jsx)(d.Fragment,{children:null===u||void 0===u?void 0:u.map((function(e){return(0,d.jsx)("div",{style:{display:p===e?null:"none"},children:(0,d.jsx)(c.Z,{uuid:"FileEditor/".concat(decodeURIComponent(e)),children:(0,d.jsx)(s.Z,{active:p===e,addNewBlock:n,disableRefreshWarning:t,fetchPipeline:o,fetchVariables:l,filePath:e?encodeURIComponent(e):null,hideHeaderButtons:!0,onContentChange:function(n){return b((0,i.Z)({},e,n))},onUpdateFileSuccess:r,openSidekickView:a,pipeline:f,sendTerminalMessage:h,setDisableShortcuts:m,setSelectedBlock:k,saveFile:v,selectedFilePath:p,setErrors:g,setFilesTouched:j})})},e)}))})},f=t(85533),v=t(71180),p=t(50724),h=t(55485),b=t(70374),m=t(30160),g=t(72473),j=t(39643),k=t(58325),y=t(44688);var x=function(e){var n=e.children,t=e.fileVersionsVisible,i=e.onSave,o=e.setFilesVersionsVisible,r=(0,l.useState)(null),u=r[0],c=r[1],s=(0,l.useRef)(null),a=(0,l.useRef)(null),f=(0,l.useMemo)((function(){return[{disabled:!i,keyTextGroups:[[(0,k.V5)()?j.RJ:j.hE,j.SS]],label:function(){return"Save"},onClick:function(){return i?i():null},uuid:"save"}]}),[i]),x=(0,l.useMemo)((function(){return[{label:function(){return t?"Hide versions":"Show versions"},onClick:function(){return o(!t)},uuid:"versions"}]}),[t,o]),C="FileHeaderMenu/index",P=(0,y.y)(),w=P.registerOnKeyDown,Z=P.unregisterOnKeyDown;return(0,l.useEffect)((function(){return function(){Z(C)}}),[Z,C]),w(C,(function(e,n){null!==u&&(n[j.QK]?c((function(e){return 0===e?2:e-1})):n[j.DY]&&c((function(e){return 2===e?0:e+1})))}),[u,c]),(0,d.jsx)(p.Z,{onClickOutside:function(){return c(null)},open:!0,style:{height:"100%",position:"relative"},children:(0,d.jsxs)(h.ZP,{alignItems:"center",fullHeight:!0,fullWidth:!0,children:[(0,d.jsxs)("div",{style:{position:"relative"},children:[(0,d.jsx)(v.ZP,{compact:!0,noBackground:0!==u,noBorder:!0,highlightOnHoverAlt:!0,padding:"4px 12px",onClick:function(){return c((function(e){return 0===e?null:0}))},onMouseEnter:function(){return c((function(e){return null!==e?0:null}))},ref:s,children:(0,d.jsx)(m.ZP,{children:"File"})}),(0,d.jsx)(b.Z,{items:f,onClickCallback:function(){return c(null)},open:0===u,parentRef:s,uuid:"FileHeaderMenu/file"})]}),(0,d.jsxs)("div",{style:{position:"relative"},children:[(0,d.jsx)(v.ZP,{compact:!0,noBackground:1!==u,noBorder:!0,highlightOnHoverAlt:!0,padding:"4px 12px",onClick:function(){return c((function(e){return 1===e?null:1}))},onMouseEnter:function(){return c((function(e){return null!==e?1:null}))},ref:a,children:(0,d.jsx)(m.ZP,{children:"Edit"})}),(0,d.jsx)(b.Z,{items:x,onClickCallback:function(){return c(null)},open:1===u,parentRef:a,uuid:"FileHeaderMenu/edit"})]}),(0,d.jsx)("div",{style:{position:"relative"},children:(0,d.jsx)(v.ZP,{beforeIcon:(0,d.jsx)(g.$B,{muted:!t}),compact:!0,noBackground:!t,noBorder:!0,highlightOnHoverAlt:!0,padding:"4px 12px",onClick:function(){return o(!t)},children:(0,d.jsx)(m.ZP,{children:t?"Hide file versions":"Show file versions"})})}),n]})})},C=t(90758),P=t(28385),w=t(35686),Z=t(53808),O=t(86735),S="open_files";function F(){return(0,Z.U2)(S,[])}function R(e){(0,Z.t8)(S,e)}function _(e){var n=(0,Z.U2)(S,[]);return n.includes(e)||n.push(e),R(n),n}function D(e){var n=(0,Z.U2)(S,[]),t=(0,O.Od)(n,(function(n){return n===e}));return R(t),t}var E=t(17717);function I(e){var n=e.split(E.sep);return n[n.length-1]}var T=t(72619),B=t(42041),M=t(23780);function U(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function V(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?U(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):U(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.addNewBlock,t=e.blocks,s=e.deleteWidget,v=e.disableContextMenu,p=e.fetchAutocompleteItems,h=e.fetchPipeline,b=e.fetchVariables,m=e.onOpenFile,g=e.onSelectBlockFile,k=e.onSelectFile,Z=e.onUpdateFileSuccess,O=e.openSidekickView,S=e.pipeline,E=e.query,U=e.selectedFilePath,N=e.sendTerminalMessage,H=e.setDisableShortcuts,A=e.setSelectedBlock,z=e.uuid,L=e.widgets,W=(0,r.j)("apiReloads"),G=(0,o.Z)(W,2),K=G[1],X=(0,M.VI)(null,{},[],{uuid:"useFileComponents/".concat(z)}),J=(0,o.Z)(X,1),q=J[0],$=(0,l.useRef)(null),Q=(0,l.useRef)(null),Y=(0,l.useCallback)((function(e){Q.current||(Q.current={}),Q.current=V(V({},Q.current),e)}),[Q]),ee=(0,l.useState)([]),ne=ee[0],te=ee[1],ie=(0,l.useState)(null),oe=ie[0],le=ie[1],re=(0,l.useState)({}),ue=re[0],ce=re[1],se=(0,l.useState)(!1),de=se[0],ae=se[1],fe=(0,l.useMemo)((function(){return ne.reduce((function(e,n){var t=I(n);return e[t]||(e[t]=[]),e[t].push(n),e}),{})}),[ne]),ve=(0,l.useCallback)((function(e){R(e),te(e)}),[]),pe=(0,l.useCallback)((function(e){ve(_(e))}),[ve]),he=(0,l.useCallback)((function(e){Y((0,i.Z)({},e,null)),ce((function(n){return V(V({},n),{},(0,i.Z)({},e,!1))}));var n=D(e);ve(n),oe===e&&(null===n||void 0===n?void 0:n.length)>=1&&le(n[n.length-1]),0===(null===n||void 0===n?void 0:n.length)&&le(null)}),[oe,Y,ve]),be=(0,l.useCallback)((function(e,n){n||(pe(e),le(e)),m&&(null===m||void 0===m||m(e,n))}),[pe,m]);(0,l.useEffect)((function(){var e=F();ve(e),le(U||function(n){return!n&&(null===e||void 0===e?void 0:e.length)>=1?e[0]:n})}),[U,ve]);var me=w.ZP.files.list(E),ge=me.data,je=me.mutate,ke=(0,l.useMemo)((function(){return(null===ge||void 0===ge?void 0:ge.files)||[]}),[ge]),ye="Files/index",xe=(0,y.y)(),Ce=(xe.disableGlobalKeyboardShortcuts,xe.registerOnKeyDown),Pe=xe.unregisterOnKeyDown;(0,l.useEffect)((function(){return function(){Pe(ye)}}),[Pe,ye]),Ce(ye,(function(e,n){var t=Object.entries(ue).reduce((function(e,n){var t=(0,o.Z)(n,2),i=t[0];return t[1]?e.concat(i):e}),[]);if((0,B.y)([j.zX,j.hS],n)&&(null===t||void 0===t?void 0:t.length)>=1){e.preventDefault();var i="You have changes that are unsaved: ".concat(t.join(", "),". ")+"Click cancel and save your changes before reloading page.";"undefined"!==typeof location&&window.confirm(i)&&location.reload()}}),[ue]);var we=(0,u.Db)((function(e){return w.ZP.file_contents.useUpdate((null===e||void 0===e?void 0:e.path)&&encodeURIComponent(null===e||void 0===e?void 0:e.path))({file_content:e})}),{onSuccess:function(e){return(0,T.wD)(e,{callback:function(e){var n=e.file_content;K((function(e){return V(V({},e),{},(0,i.Z)({},"FileVersions/".concat(null===n||void 0===n?void 0:n.path),Number(new Date)))})),Y((0,i.Z)({},null===n||void 0===n?void 0:n.path,null))},onErrorCallback:function(e,n){return q({errors:n,response:e})}})}}),Ze=(0,o.Z)(we,1),Oe=Ze[0],Se=(0,l.useCallback)((function(e,n){Oe(V(V({},n),{},{content:e})),ce((function(e){return V(V({},e),{},(0,i.Z)({},null===n||void 0===n?void 0:n.path,!1))}))}),[ce,Oe]),Fe=(0,l.useMemo)((function(){return(0,d.jsx)(f.Z,{addNewBlock:n,blocks:t,deleteWidget:s,disableContextMenu:v,fetchAutocompleteItems:p,fetchFiles:je,fetchPipeline:h,files:ke,onClickFile:function(e){return be(e)},onClickFolder:function(e){return be(e,!0)},onSelectBlockFile:g,openSidekickView:O,pipeline:S,ref:$,showError:q,setSelectedBlock:A,uuid:z,widgets:L})}),[n,t,s,v,p,je,h,$,ke,g,be,O,S,A,q,z,L]),Re=(0,l.useMemo)((function(){return(0,d.jsx)(a,{addNewBlock:n,disableRefreshWarning:!0,fetchPipeline:h,fetchVariables:b,onUpdateFileSuccess:Z,openFilePaths:ne,openSidekickView:O,pipeline:S,saveFile:Se,selectedFilePath:oe,sendTerminalMessage:N,setContentByFilePath:Y,setDisableShortcuts:H,setErrors:q,setFilesTouched:ce,setSelectedBlock:A})}),[n,h,b,Z,ne,O,S,Se,oe,N,Y,H,ce,A,q]),_e=(0,l.useMemo)((function(){return(0,d.jsx)(x,{fileVersionsVisible:de,onSave:function(){var e,n;(null===Q||void 0===Q||null===(e=Q.current)||void 0===e||null===(n=e[oe])||void 0===n?void 0:n.length)>=1&&Se(Q.current[oe],{path:oe})},setFilesVersionsVisible:ae})}),[Q,de,Se,oe,ae]),De=(0,l.useMemo)((function(){return(0,d.jsx)(C.Z,{filePaths:ne,filesTouched:ue,isSelectedFilePath:function(e,n){return e===n},onClickTab:function(e){le(e),k&&(null===k||void 0===k||k(e))},onClickTabClose:function(e){return he(e)},renderTabTitle:function(e){var n=I(e),t=fe[n];return t&&(null===t||void 0===t?void 0:t.length)>=2?e:n},selectedFilePath:oe})}),[ue,k,ne,fe,he,oe]),Ee=(0,l.useMemo)((function(){return(0,d.jsx)(c.Z,{uuid:"FileVersions/".concat(oe?decodeURIComponent(oe):""),children:(0,d.jsx)(P.Z,{selectedFilePath:oe,setErrors:q})})}),[oe,q]);return{browser:Fe,controller:Re,fetchFiles:je,filePaths:ne,files:ke,filesTouched:ue,menu:_e,openFile:be,selectedFilePath:oe,tabs:De,versions:Ee,versionsVisible:de}}},90758:function(e,n,t){t.d(n,{Z:function(){return O}});var i=t(82394),o=t(26304),l=t(82684),r=t(38626),u=t(39867),c=t(55485),s=t(48670),d=t(38276),a=t(30160),f=t(12468),v=t(44897),p=t(29120),h=t(72473),b=t(97133),m=t(70515),g=t(15610),j=t(95924),k=t(28598),y=1.25*m.iI;var x=function(e){var n=e.filePath,t=e.filesTouched,i=void 0===t?{}:t,o=e.isLast,r=e.onClickTab,x=e.onClickTabClose,C=e.renderTabTitle,P=e.savePipelineContent,w=e.selected,Z=e.themeContext,O=(0,l.useState)(!1),S=O[0],F=O[1],R=(0,p.Z)({filePath:n,name:n,uuid:n}),_=R.BlockIcon,D=R.Icon,E=R.color,I=R.iconColor,T=R.isBlockFile;return(0,k.jsx)(c.ZP,{flexDirection:"column",fullHeight:!0,onClick:function(e){e.preventDefault(),w||(r?r(n):(null===P||void 0===P||P(),(0,g.u)({file_path:encodeURIComponent(n)})))},onMouseEnter:function(){return F(!0)},onMouseLeave:function(){return F(!1)},children:(0,k.jsx)(b.Gb,{last:o,selected:w,children:(0,k.jsxs)(c.ZP,{alignItems:"center",fullHeight:!0,children:[(0,k.jsx)(f.Z,{appearAbove:!0,appearBefore:!0,label:n,size:null,widthFitContent:!0,children:(0,k.jsxs)(c.ZP,{alignItems:"center",fullHeight:!0,children:[!i[n]&&(0,k.jsx)(k.Fragment,{children:T?(0,k.jsx)(_,{color:E,size:1*m.iI,square:!0}):(0,k.jsx)(D,{fill:I,size:1.5*m.iI})}),i[n]&&(0,k.jsx)(f.Z,{label:"Unsaved changes",size:null,widthFitContent:!0,children:(0,k.jsx)("div",{style:{padding:1},children:(0,k.jsx)(u.Z,{borderColor:(Z||v.Z).borders.danger,size:y})})}),(0,k.jsx)(d.Z,{mr:1}),(0,k.jsx)(a.ZP,{monospace:!0,muted:!w,noWrapping:!0,small:!0,children:C?C(n):n})]})}),x&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(d.Z,{mr:2}),(0,k.jsx)(f.Z,{label:"Close",size:null,widthFitContent:!0,children:(0,k.jsxs)(s.Z,{autoHeight:!0,block:!0,noHoverUnderline:!0,noOutline:!0,onClick:function(e){(0,j.j)(e),null===x||void 0===x||x(n)},preventDefault:!0,children:[(S||w)&&(0,k.jsx)(h.x8,{muted:!w,size:y}),!S&&!w&&(0,k.jsx)("div",{style:{width:y}})]})})]})]})})})},C=t(86735),P=["filePaths","isSelectedFilePath","onClickTab","onClickTabClose","selectedFilePath","tabsBefore"];function w(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function Z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?w(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var O=function(e){var n=e.filePaths,t=e.isSelectedFilePath,i=e.onClickTab,u=e.onClickTabClose,s=e.selectedFilePath,d=e.tabsBefore,a=(0,o.Z)(e,P),f=(0,l.useContext)(r.ThemeContext),v=(0,l.useMemo)((function(){return n.map((function(e){return decodeURIComponent(e)}))}),[n]),p=(0,l.useMemo)((function(){return(null===v||void 0===v?void 0:v.length)||0}),[v]);return(0,k.jsxs)(c.ZP,{alignItems:"center",fullHeight:!0,justifyContent:"flex-start",children:[(null===d||void 0===d?void 0:d.length)>=1&&(null===d||void 0===d?void 0:d.map((function(e){var n=e.label,o=e.onClick,l=e.uuid,r=t?t(l,s):s===encodeURIComponent(l);return(0,k.jsx)(x,{onClickTab:function(){return null===o||void 0===o?void 0:o({onClickTab:i})},renderTabTitle:function(){return n?null===n||void 0===n?void 0:n():l},selected:r,themeContext:f},l)}))),null===v||void 0===v?void 0:v.map((function(e,n){var o=t?t(e,s):s===encodeURIComponent(e);return(0,l.createElement)(x,Z(Z({},a),{},{filePath:e,isLast:n===p-1,key:e,onClickTab:i,onClickTabClose:function(e){if(u)u(e);else{var n=(0,C.Od)(v,(function(n){return n===e})).map((function(e){return encodeURIComponent(e)}));(0,g.u)({file_path:n[n.length-1]||null,"file_paths[]":n},{pushHistory:!0})}},selected:o,themeContext:f}))}))]})}},97133:function(e,n,t){t.d(n,{Gb:function(){return f},fm:function(){return d},lO:function(){return s},rK:function(){return a},zn:function(){return c}});var i=t(38626),o=t(44897),l=t(2842),r=t(70515),u=t(47041),c=300,s=i.default.div.withConfig({displayName:"indexstyle__PipelineContainerStyle",componentId:"sc-1sv9513-0"})([".pipeline-detail-enter-active{opacity:1;transition:opacity ","ms linear;}.pipeline-detail-enter-done{opacity:0;transition:opacity ","ms linear;}"],c,c),d=i.default.div.withConfig({displayName:"indexstyle__OverlayStyle",componentId:"sc-1sv9513-1"})(["height:100vh;opacity:1;position:fixed;width:100vw;z-index:9999;",""],(function(e){return"\n    background-color: ".concat((e.theme.background||o.Z.background).codeArea,";\n  ")})),a=i.default.div.withConfig({displayName:"indexstyle__PipelineHeaderStyle",componentId:"sc-1sv9513-2"})(["height:","px;position:sticky;top:","px;width:100%;z-index:5;"," "," "," ",""],l.Wi,l.Wi,(function(e){return"\n    background-color: ".concat((e.theme.background||o.Z.background).panel,";\n    border-bottom: 1px solid ").concat((e.theme.borders||o.Z.borders).medium,";\n  ")}),(function(e){return e.relativePosition&&"\n    position: relative;\n  "}),(function(e){return e.secondary&&"\n    height: ".concat(37,"px;\n    top: ").concat(l.Wi,"px;\n    overflow-x: auto;\n    z-index: 3;\n  ")}),(0,u.y$)()),f=i.default.div.withConfig({displayName:"indexstyle__FileTabStyle",componentId:"sc-1sv9513-3"})(["border-right:1px solid transparent;height:100%;padding:","px ","px;"," "," ",""],1*r.iI,1.5*r.iI,(function(e){return"\n    &:hover {\n      cursor: default;\n\n      p {\n        color: ".concat((e.theme.content||o.Z.content).active," !important;\n        cursor: default;\n      }\n    }\n  ")}),(function(e){return e.selected&&"\n    background-color: ".concat((e.theme.background||o.Z.background).codeTextarea,";\n  ")}),(function(e){return!e.selected&&!e.last&&"\n    border-color: ".concat((e.theme.borders||o.Z.borders).light," !important;\n  ")}));i.default.div.withConfig({displayName:"indexstyle__HeaderViewOptionsStyle",componentId:"sc-1sv9513-4"})(["left:50%;position:absolute;transform:translateX(-50%);"])},80329:function(e,n,t){t.d(n,{j:function(){return i}});var i=(0,t(44152).r)({apiReloads:{}}).useGlobalState}}]);