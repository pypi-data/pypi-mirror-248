Metadata-Version: 2.1
Name: MtxDrawer
Version: 0.0.23
Summary: Draw Mtx As Thumbnail
Home-page: https://github.com/Rhythmicc/DrawMtxAsThumbnail
Author: RhythmLian
Author-email: RhythmLian@outlook.com
License: MIT
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy
Requires-Dist: matplotlib
Requires-Dist: Qpro

# Draw Mtx As Thumbnail - å°† Mtx ç”»ä¸ºç¼©ç•¥å›¾

![help](https://cos.rhythmlian.cn/ImgBed/a9cdf3bef0655d1d6e2563c40069938b.png)

## æ ·ä¾‹

|      ![aver](./img/ash85_aver.png)<br />å¹³å‡å€¼      |   ![real](./img/ash85_real.png)<br />ä¸å¤„ç†    |
| :-------------------------------------------------: | :--------------------------------------------: |
| ![log](./img/ash85_log.png)<br /><b>å– 0 æ¬¡ log</b> | ![abs](./img/ash85_abs.png)<br /><b>ç»å¯¹å€¼</b> |

## å®‰è£…

```shell
pip3 install MtxDrawer -U
```

è‡ªåŠ¨å®‰è£…ä¾èµ–å¹¶æ³¨å†Œä¸€ä¸ªå‘½ä»¤`mtx-drawer`

ã€æ³¨æ„ã€‘ï¼šç”±äºä¾èµ–åº“çš„ç‰ˆæœ¬æ›´æ–°å¯èƒ½å¯¼è‡´æ—§ç‰ˆæœ¬ä¸å†èƒ½è¿è¡Œï¼Œè¯·æ³¨æ„ä¿æŒæ­¤å·¥å…·ä¸ºæœ€æ–°ç‰ˆæœ¬ã€‚

## ğŸ”¥é¢„å‘å¸ƒç‰ˆæœ¬: Cythonä¼˜åŒ–

è‡ªè¡Œå®ç°çš„é«˜æ€§èƒ½è¯»å–ç®—æ³•ï¼š

1. å†…å­˜éœ€æ±‚å¤§å¹…é™ä½ï¼Œä¸å†è¯»å–æ•´ä¸ªçŸ©é˜µå¤„ç†ï¼›
2. è¯»å–åŠ é€Ÿï¼Œæ²¡æµ‹è¿‡ä¹‹å‰çš„å¸¦å®½ï¼Œä½†è‚‰çœ¼å¯è§çš„æ›´å¿«ï¼›
3. å…¼å®¹æ€§æå‡ï¼Œzero base å’Œ one base éƒ½èƒ½è¯»ï¼›

![](./img/2.png)

PSï¼šèƒ½è·‘æ»¡ä¸€èˆ¬æœºæ¢°ç¡¬ç›˜çš„å¸¦å®½ï¼Œä½†ç›¸æ¯”æˆ‘è¿™ä¸ªç§»åŠ¨ç¡¬ç›˜çš„å¸¦å®½ï¼ˆå³°å€¼2.9GB/sï¼‰è¿˜æ˜¯æ…¢äº†å¾ˆå¤šã€‚

æ­¤ç‰ˆæœ¬å·²é¢„å…ˆå‘å¸ƒï¼Œç”±äºå…¶æ‰§è¡ŒæœŸé—´æš‚æ—¶æ— æ³•ä½¿ç”¨`ctrl + c`å¼ºåˆ¶ç»ˆæ­¢ï¼Œå› æ­¤è¿˜æœªåœ¨pypiä¸Šå‘å¸ƒï¼Œä¸careè¿™ä¸ªé—®é¢˜çš„è¯å¯ä»¥å…ˆé€šè¿‡å¦‚ä¸‹æ–¹å¼å®‰è£…ï¼š

```sh
pip3 install cython # é¦–å…ˆè¦æœ‰cythonç¯å¢ƒ
pip3 install git+https://github.com/Rhythmicc/DrawMtxAsThumbnail.git -U
```

## è¿è¡Œ

```shell
mtx-drawer draw-one [--force] [--log-times <n: int>] [--mat-size <n: int>] [--block-size <n: int>] <filepath> <-ops <aver | abs | real | log>... >
mtx-drawer draw [--force] [--log-times <n: int>] [--mat-size <n: int>] [--block-size <n: int>] <-ops <aver | abs | real | log>... >
```

### è§£é‡Š

1. ç¬¬ä¸€æ¡å‘½ä»¤æ˜¯ä¸ºæ–‡ä»¶`<filepath>`ç”»ç¼©ç•¥å›¾ (`filepath`æ— éœ€æ˜¯ mtx æ–‡ä»¶ï¼Œä½†éœ€è¦èƒ½è¢«`scipy.io.mmread`è¯»å–)ï¼Œå…¶ä¸­`<ops>`æ˜¯<font color="red">å¿…å¡«çš„å¤šé€‰å‚æ•°</font>åªèƒ½åœ¨å‘½ä»¤æœ«å°¾èµ‹å€¼ï¼Œç”¨äºæŒ‡å®šç¼©ç•¥å›¾çš„ç±»å‹ï¼Œå…¶ä¸­`<aver>`è¡¨ç¤ºå¹³å‡å€¼ï¼Œ`<abs>`è¡¨ç¤ºç»å¯¹å€¼ï¼Œ`<real>`è¡¨ç¤ºå®é™…å€¼ï¼Œ`<log>`è¡¨ç¤ºå¯¹æ•°å€¼è¿›è¡Œå¯¹æ•°å˜æ¢; `force`è¡¨ç¤ºå¼ºåˆ¶é‡æ–°ç”»ç¼©ç•¥å›¾é»˜è®¤ä¸ºå¦ï¼Œ`log-times`è¡¨ç¤ºç”»ç¼©ç•¥å›¾å¯¹åƒç´ å€¼å– log çš„æ¬¡æ•°é»˜è®¤ä¸º 2ï¼Œ`mat-size`è¡¨ç¤ºç¼©ç•¥å›¾çš„å°ºå¯¸ï¼ˆé»˜è®¤æ˜¯ 200 \* 200 çš„å›¾åƒï¼‰ï¼Œ`block-size`ç›´æ¥è®¾ç½®å—å¤§å°ï¼ˆå¼€å¯æ¬¡é€‰é¡¹åå°†è¦†ç›–æ‰`mat-size`å‚æ•°ï¼‰ã€‚
2. ç¬¬äºŒæ¡å‘½ä»¤ä¼šé€’å½’æœç´¢å½“å‰è·¯å¾„ä¸‹çš„æ‰€æœ‰ mtx æ–‡ä»¶å¹¶ç»˜åˆ¶ç¼©ç•¥å›¾ï¼Œå‚æ•°å«ä¹‰ä¸ä¸Šä¸€æ¡æè¿°ä¸€è‡´ã€‚

æ³¨æ„: ops ä½œä¸ºå¿…å¡«å¤šé€‰å‚æ•°ï¼Œå¿…é¡»åœ¨å‘½ä»¤çš„æœ«å°¾ä¸ºå…¶èµ‹å€¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚

### ä¾‹å­

```shell
mtx-drawer draw-one 2.mtx --force --log-times 0 -ops aver abs log real # ä¸€æ¬¡æ€§ç»˜åˆ¶2.mtxçš„å››ç§å›¾ï¼Œlogå–0æ¬¡ï¼Œå¼ºåˆ¶æ›¿æ¢
mtx-drawer draw-one 2.mtx  -ops aver abs log real # ä¸€æ¬¡æ€§ç»˜åˆ¶2.mtxçš„å››ç§å›¾ï¼Œlogå–2æ¬¡ï¼Œä¸å¼ºåˆ¶æ›¿æ¢
mtx-drawer draw --force -ops aver abs log # ç»˜åˆ¶å½“å‰ç›®å½•åŠå­ç›®å½•ä¸‹çš„å…¨éƒ¨mtxæ–‡ä»¶çš„ä¸‰ç§å›¾ï¼Œå¼ºåˆ¶æ›¿æ¢
mtx-drawer draw -ops aver abs log real # ç»˜åˆ¶å½“å‰ç›®å½•åŠå­ç›®å½•ä¸‹çš„å…¨éƒ¨mtxæ–‡ä»¶çš„ä¸‰ç§å›¾ï¼Œä¸å¼ºåˆ¶æ›¿æ¢ä¸”logå–2æ¬¡
```

### ç‰¹æ®Šè¯´æ˜

å­çŸ©é˜µåˆ’åˆ†æ–¹å¼ï¼šå½“è¡Œåˆ—ä¸ç›¸ç­‰æ—¶ï¼Œè¾ƒå¤§çš„å±æ€§è¢«åˆ†ä¸º`matSize`å—ï¼Œè¾ƒå°çš„å±æ€§ä¸º`rate * matSize`å—ï¼›å…¶ä¸­`rate`ä¸º$ min(m,n)/max(m,n) $

### å‘½ä»¤è¡Œè¡¥å…¨

åŸºäº[QuickProject.Commmander](https://github.com/Rhythmicc/QuickProject)å¼€å‘çš„å‘½ä»¤è¡Œ APP å¯ä»¥æä¾› zsh æˆ– [fig](https://fig.io/) çš„è¡¥å…¨è„šæœ¬ï¼š

```sh
mtx-drawer complete
```

## åŸºäº Drawer ç±»çš„è‡ªå®šä¹‰å¼€å‘

å½“é»˜è®¤æä¾›çš„å››ç§ç®—æ³•æ— æ³•æ»¡è¶³éœ€è¦æ—¶ï¼Œå¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼è‡ªè¡Œè®¾è®¡ç®—æ³•ï¼š

```python
from MtxDrawer.Drawer import Drawer

"""
æ‚¨å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è‡ªå®šä¹‰ç®—æ³•å¹¶é€šè¿‡Drawerå¯¹è±¡çš„callæ–¹æ³•æ¥è°ƒç”¨ï¼›
è‡ªå®šä¹‰ç®—æ³•å¯æ¥å—çš„å‚æ•°å°†åœ¨ä¸‹è¡¨ä¸­è¯´æ˜ï¼Œæ­¤å¤–ï¼Œè‡ªå®šä¹‰ç®—æ³•å¿…é¡»è¿”å›ä¸€ä¸ªæ•°å€¼ç”¨äºè¡¨ç¤ºcolor_barçš„æ˜¾ç¤ºèŒƒå›´ï¼ˆè¿”å›1åˆ™è¡¨ç¤º-1~1ï¼‰
"""

@Drawer.algorithmWrapper() # ç®—æ³•è£…é¥°å™¨
def myOwnAlgorithm(mat, extern_arg): # å‚æ•°å‘½åè¦ç¬¦åˆä¸‹è¡¨çš„è¦æ±‚ï¼Œmatæ˜¯ä¸‹è¡¨ç¬¬9é¡¹ï¼Œextern_argæ˜¯ä¸‹è¡¨ç¬¬15é¡¹
    print(extern_arg)
    return max(abs(max([max(i) for i in mat])), abs(min([min(i) for i in mat])))


drawer = Drawer('dist/2.mtx', False, set_log-times=0, force_update=True)
drawer.call('myOwnAlgorithm', extern_arg=1)

"""
---ç»“æœ---

[ä¿¡æ¯] è·¯å¾„æ¨¡æ¿: "dist/2_{}.svg"
1
[ä¿¡æ¯] absVal = 1
"""
```

| åºå· | åˆæ³•å‚æ•°       | è¯´æ˜                                               |
| :--: | -------------- | -------------------------------------------------- |
|  1   | `has_aver`     | æ˜¯å¦æœ‰å–å¹³å‡å€¼é€‰é¡¹ => div æ˜¯å¦å¯ç”¨                 |
|  2   | `log-times`    | å¤–éƒ¨è®¾å®šçš„å– log çš„æ¬¡æ•°                            |
|  3   | `mat-size`     | çŸ©é˜µè¡Œåˆ—å€¼è¾ƒå¤§çš„å±æ€§è¢«åˆ†çš„å—æ•°                     |
|  4   | `mtx`          | æ–‡ä»¶çš„ scipy.sparse.coo\*matrix å¯¹è±¡ï¼Œæœªåšä»»ä½•æ›´æ”¹ |
|  5   | `coo_shape`    | mtx çš„å°ºå¯¸                                         |
|  6   | `coo_data`     | çŸ©é˜µçš„éé›¶å…ƒå€¼                                     |
|  7   | `coo_rows`     | çŸ©é˜µçš„éé›¶å…ƒç´ è¡Œç´¢å¼•æ˜ å°„åˆ° mat çš„è¡Œå€¼              |
|  8   | `coo_cols`     | çŸ©é˜µçš„éé›¶å…ƒç´ åˆ—ç´¢å¼•æ˜ å°„åˆ° mat çš„åˆ—å€¼              |
|  9   | `mat`          | è¢«åˆå§‹åŒ–å¥½çš„äºŒç»´ç”»å¸ƒå¯¹è±¡ï¼Œç±»å‹ä¸º numpy.array       |
|  10  | `div`          | å­çŸ©é˜µéé›¶å…ƒæ•°ï¼Œåªæœ‰å½“ has_aver ä¸º True æ—¶æ‰ä¼šæœ‰æ•ˆ |
|  11  | `row_size`     | mat çš„è¡Œæ•°                                         |
|  12  | `col_size`     | mat çš„åˆ—æ•°                                         |
|  13  | `row_block_sz` | åˆ’åˆ†çš„å­çŸ©é˜µçš„è¡Œæ•°                                 |
|  14  | `col_block_sz` | åˆ’åˆ†çš„å­çŸ©é˜µçš„åˆ—æ•°                                 |
|  15  | `extern_*`     | é¢å¤–çš„å‚æ•°å‘½åæ–¹å¼ï¼Œéœ€ä»¥"extern_xx=bala"çš„æ–¹å¼è°ƒç”¨ |

### ç°ä»£ IDE ä¸‹çš„æç¤º

![IDE](./img/1.png)

