import numpy
import pprint

from cmb_ck import combiner as cmb_ck
#---------------------------------------------
def get_eff_rjpsi_cov():
    d_rjpsi = {'2017_TIS': 1.065318474674305,
              '2017_TOS': 1.000568740530071,
              '2018_TIS': 0.9869016988808864,
              '2018_TOS': 0.9812528134640833,
              'r1_TIS': 0.9437732868419378,
              'r1_TOS': 0.9614985893040463,
              'r2p1_TIS': 0.9776810306685778,
              'r2p1_TOS': 0.9354884665588733}

    d_eff   = {'2017_TIS': (0.0035908913251958825, 0.00015052192356141255),
             '2017_TOS': (0.0035908913251958825, 0.0008375830705846808),
             '2018_TIS': (0.0036240178602974242, 0.0001431026100691915),
             '2018_TOS': (0.0036240178602974242, 0.0007778208266892523),
             'r1_TIS': (0.0020073416804087868, 5.110977966651073e-05),
             'r1_TOS': (0.0020073416804087868, 0.0003050688571206793),
             'r2p1_TIS': (0.0034103649346729895, 0.00013301059960353168),
             'r2p1_TOS': (0.0034103649346729895, 0.0008093257601250072)}

    cov     = numpy.array([[ 8.76798971e-06,  9.60408876e-08,  7.76939747e-06,
                  -4.47402382e-07,  8.43823535e-06, -8.58327673e-07,
                  7.95897971e-06, -6.21499193e-07],
                 [ 9.60408876e-08,  4.14292827e-07, -5.91437888e-07,
                  2.51529870e-07, -7.97890965e-07,  3.38958158e-07,
                  -6.90553044e-07,  2.86756408e-07],
                 [ 7.76939747e-06, -5.91437888e-07,  1.36931714e-05,
                  -1.08769014e-06,  1.32455783e-05, -1.88940238e-06,
                  1.17594623e-05, -1.67088147e-06],
                 [-4.47402382e-07,  2.51529870e-07, -1.08769014e-06,
                  4.69486932e-07, -1.36841021e-06,  4.84910022e-07,
                  -1.17621058e-06,  4.29231021e-07],
                 [ 8.43823535e-06, -7.97890965e-07,  1.32455783e-05,
                  -1.36841021e-06,  1.83408801e-05, -2.12516511e-06,
                  1.41094113e-05, -1.95816236e-06],
                 [-8.58327673e-07,  3.38958158e-07, -1.88940238e-06,
                  4.84910022e-07, -2.12516511e-06,  9.46127345e-07,
                  -1.89389444e-06,  5.72272753e-07],
                 [ 7.95897971e-06, -6.90553044e-07,  1.17594623e-05,
                  -1.17621058e-06,  1.41094113e-05, -1.89389444e-06,
                  1.44294071e-05, -1.44654180e-06],
                 [-6.21499193e-07,  2.86756408e-07, -1.67088147e-06,
                  4.29231021e-07, -1.95816236e-06,  5.72272753e-07,
                  -1.44654180e-06,  8.20119371e-07]])

    return d_rjpsi, d_eff, cov
#---------------------------------------------
def test_simple():
    d_rjpsi, d_eff, cov = get_eff_rjpsi_cov()
    cmb                 = cmb_ck(rjp=d_rjpsi, eff=d_eff, cov=cov)
    cmb.out_dir         = 'tests/cmb_eff/simple'
    d_rjpsi, d_eff, cov = cmb.get_combination(add_tis=False)

    pprint.pprint(d_rjpsi, sort_dicts=False)
    pprint.pprint(d_eff  , sort_dicts=False)
    pprint.pprint(cov    , sort_dicts=False)
#---------------------------------------------
if __name__ == '__main__':
    test_simple()
