<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="solrad.climate package" href="solrad.climate.html" /><link rel="prev" title="solrad package" href="solrad.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2023.09.10 -->
        <title>solrad.atmosphere package - solrad 0.0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=369552022d0b975c8e74270ce6eabe0fb7978f24" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">solrad 0.0.2 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">solrad 0.0.2 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="modules.html">src</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of src</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="solrad.html">solrad package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of solrad package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">solrad.atmosphere package</a></li>
<li class="toctree-l3"><a class="reference internal" href="solrad.climate.html">solrad.climate package</a></li>
<li class="toctree-l3"><a class="reference internal" href="solrad.radiation.html">solrad.radiation package</a></li>
<li class="toctree-l3"><a class="reference internal" href="solrad.sun.html">solrad.sun package</a></li>
<li class="toctree-l3"><a class="reference internal" href="solrad.terrain.html">solrad.terrain package</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="solrad-atmosphere-package">
<h1>solrad.atmosphere package<a class="headerlink" href="#solrad-atmosphere-package" title="Permalink to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-solrad.atmosphere.aerosol_asymmetry_factor">
<span id="solrad-atmosphere-aerosol-asymmetry-factor-module"></span><h2>solrad.atmosphere.aerosol_asymmetry_factor module<a class="headerlink" href="#module-solrad.atmosphere.aerosol_asymmetry_factor" title="Permalink to this heading">#</a></h2>
<p>This module contains all functions, methods and classes related to the
computation and manipulation of the aerosol asymmetry factor of a site.</p>
<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.aerosol_asymmetry_factor.compute_aerosol_asymmetry_factor_using_SF">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.aerosol_asymmetry_factor.</span></span><span class="sig-name descname"><span class="pre">compute_aerosol_asymmetry_factor_using_SF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.aerosol_asymmetry_factor.compute_aerosol_asymmetry_factor_using_SF" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the aerosol asymmetry factor using the Shettel and Fenn (SF) model
as described in [1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RH</strong> (<em>float</em><em> or </em><em>array_like</em><em> of </em><em>floats</em>) – Relative Humidity of the air in %. Must be a non-negative number or array
of numbers between 0 and 100.</p></li>
<li><p><strong>wavelength</strong> (<em>float</em><em> or </em><em>array_like</em><em> of </em><em>floats</em>) – Wavelength in nanometers for which the aerosol asymmetry factor
is to be computed. Must be a number or array of numbers between 200
and 4500.</p></li>
<li><p><strong>model</strong> (<em>{“Rural”</em><em>, </em><em>“Urban” and &quot;Maritime&quot;}</em>) – Model to be used in the computation of the Aerosol Asymmetry Factor.</p></li>
<li><p><strong>interp_method</strong> (<em>{&quot;linear&quot;</em><em>, </em><em>&quot;nearest&quot;</em><em>, </em><em>&quot;cubic&quot;}</em><em>, </em><em>optional</em>) – Method of interpolation to use on the data. Default is “linear”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>aerosol_asymmetry_factor</strong> – Aerosol asymmetry factor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array of floats</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>1) ‘RH’’ can be an array of any length, while ‘wavelength’ is a float;
and viceversa. However, if ‘RH’ and ‘wavelength’ are both arrays,
they should be the same length.</p>
<p class="rubric">References</p>
<p>[1] Shettle, Eric &amp; Fenn, Robert. (1979). Models for the Aerosols of the
Lower Atmosphere and the Effects of Humidity Variations on their Optical
Properties. Environ. Res.. 94.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solrad.atmosphere.aerosol_asymmetry_factor</span> <span class="kn">import</span> <span class="n">compute_aerosol_asymmetry_factor_using_SF</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RHs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Rural&quot;</span><span class="p">,</span> <span class="s2">&quot;Urban&quot;</span><span class="p">,</span> <span class="s2">&quot;Maritime&quot;</span><span class="p">]:</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">RHs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">RH</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">RHs</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">compute_aerosol_asymmetry_factor_using_SF</span><span class="p">(</span><span class="n">RH</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">interp_method</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">RH</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelengths [nm]&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Aerosol Asymmetry Factor [-]&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model= </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Relative Humidity&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-solrad.atmosphere.angstrom_exponent">
<span id="solrad-atmosphere-angstrom-exponent-module"></span><h2>solrad.atmosphere.angstrom_exponent module<a class="headerlink" href="#module-solrad.atmosphere.angstrom_exponent" title="Permalink to this heading">#</a></h2>
<p>This module contains all functions, methods and classes related to the
computation and manipulation of the Angstrom Turbidity Exponent of a site.</p>
<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.angstrom_exponent.compute_angstrom_exponent_using_SF">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.angstrom_exponent.</span></span><span class="sig-name descname"><span class="pre">compute_angstrom_exponent_using_SF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Urban'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.angstrom_exponent.compute_angstrom_exponent_using_SF" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the Ansgtrom turbidity exponent suing the Shettel and Fenn model,
as detailed in [1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RH</strong> (<em>float</em><em> or </em><em>array_like</em><em> of </em><em>floats</em>) – Relative Humidity of the air in %. Must be a non-negative number or array
of numbers between 0 and 100.</p></li>
<li><p><strong>wavelength</strong> (<em>float</em><em>, </em><em>optional</em>) – Wavelength in nanometers for which the Angstrom turbidity exponent
is to be computed. Must be a non-ngeative number. Default is 500.</p></li>
<li><p><strong>model</strong> (<em>{“Rural”</em><em>, </em><em>“Urban” and &quot;Maritime&quot;}</em><em>, </em><em>optional</em>) – Model to be used in the computation of the the Angstrom exponent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>alpha</strong> – Angstrom turbidity coefficient.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1] Gueymard, Chris. (1995). SMARTS2, a simple model of the atmospheric
radiative transfer of sunshine: algorithms and performance assessment.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solrad.atmosphere.angstrom_exponent</span> <span class="kn">import</span> <span class="n">compute_angstrom_exponent_using_SF</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RHs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Rural&quot;</span><span class="p">,</span> <span class="s2">&quot;Urban&quot;</span><span class="p">,</span> <span class="s2">&quot;Maritime&quot;</span><span class="p">]:</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">alpha1</span> <span class="o">=</span> <span class="n">compute_angstrom_exponent_using_SF</span><span class="p">(</span><span class="n">RHs</span><span class="p">,</span> <span class="mi">499</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">alpha2</span> <span class="o">=</span> <span class="n">compute_angstrom_exponent_using_SF</span><span class="p">(</span><span class="n">RHs</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">RHs</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;λ &lt; 500 nm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">RHs</span><span class="p">,</span> <span class="n">alpha2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;λ ≥ 500 nm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;RH [%]&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Angstrom Exponent&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model = </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Spectral Range&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-solrad.atmosphere.aod_550nm">
<span id="solrad-atmosphere-aod-550nm-module"></span><h2>solrad.atmosphere.aod_550nm module<a class="headerlink" href="#module-solrad.atmosphere.aod_550nm" title="Permalink to this heading">#</a></h2>
<p>This module contains all functions, methods and classes related to the
computation and manipulation of the Aerosol Optical Depth at 550nm (AOD_550)
of a site.</p>
<p><strong>CLIMATE DATA STORE</strong></p>
<p>“The Copernicus - Climate Data Store (CDS) is an online open and free service
that allows users to browse and access a wide range of climate datasets via a
searchable catalogue. It also allows users to build their own applications,
maps and graphs.”</p>
<p>1) CDS webpage at:
<a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/home">https://cds.climate.copernicus.eu/cdsapp#!/home</a></p>
<p>2) More info about its API, at:
<a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to">https://cds.climate.copernicus.eu/api-how-to</a></p>
<p>3) Useful tutorial on how to use the API, at
<a class="reference external" href="https://youtu.be/cVtiVTSVdlo">https://youtu.be/cVtiVTSVdlo</a></p>
<p><strong>NOTE:</strong> As described by the links in 2) and 3), it is necessary to have a CDS
account (and be currently logged in) account in order to be able to use
the API. Furtheremore, the user’s key and the API website link should be
stored in a place, recognisable by the system being used.</p>
<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.aod_550nm.fill_CDS_aod_550nm_data_nans">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.aod_550nm.</span></span><span class="sig-name descname"><span class="pre">fill_CDS_aod_550nm_data_nans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.aod_550nm.fill_CDS_aod_550nm_data_nans" title="Permalink to this definition">#</a></dt>
<dd><p>Fill NaNs with suitable numeric aproximation of CDS aod_550nm raw data.</p>
<p>The data retrieved from the Climate Data Store (CDS) database referenced
in [1] has a considerable amount of missing or defective values in its files.
This is inconvenient for later computations. As such, this function reads all
‘raw.npy’ files in the directory specified by the <em>path</em> argument (i.e, the local
aod_550nm database), that were obtained via the function <a class="reference internal" href="#solrad.atmosphere.aod_550nm.get_CDS_aod_550nm_data" title="solrad.atmosphere.aod_550nm.get_CDS_aod_550nm_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_CDS_aod_550nm_data()</span></code></a>; and
uses the function <a class="reference internal" href="solrad.html#solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace" title="solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace"><code class="xref py py-func docutils literal notranslate"><span class="pre">fill_CDS_globe_nans_using_laplace()</span></code></a> to fill each file’s
NaN values with a suitable numeric approximation and then saves each modified file back
to the same directory as a ‘filled_NaNs.npy’ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>path-str</em>) – Path of the folder where the raw.npy files, containing the aerosol
optical depth at 550 nm (aod_550nm) information downloaded from the
aforementioned database, are stored. The resulting filled_NaNs.npy
files will also be stored in this same directory.</p></li>
<li><p><strong>iterations</strong> (<em>int</em>) – Number of iterations that the <a class="reference internal" href="solrad.html#solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace" title="solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace"><code class="xref py py-func docutils literal notranslate"><span class="pre">fill_CDS_globe_nans_using_laplace()</span></code></a>
function should use for computing the numerical approximation to the
NaN values, before stopping (must be non-negative). The greater the
number of iterations, the greater the chance that convergence of the
computed values has been reached. However, the time of computation also
increases. Default is 20000.</p></li>
<li><p><strong>show_progress</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, after processing each file, it prints how many files
have been processed as of yet. If False, it prints nothing.
Default is False.</p></li>
<li><p><strong>replace</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to errase the original raw.npy files, after the new filled_NaNs.npy
files (with have been created. This, as a way to save space in memory).
Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>1</strong><strong>) </strong><strong>Exception</strong> – “Local aod_550nm database is empty. No aod_550nm raw.npy files to retrieve were found.”</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1] Copernicus Climate Change Service, Climate Data Store, (2019): Aerosol
properties gridded data from 1995 to present derived from satellite observation.
Copernicus Climate Change Service (C3S) Climate Data Store (CDS). DOI: 10.24381/cds.239d815c</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.aod_550nm.get_CDS_aod_550nm_data">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.aod_550nm.</span></span><span class="sig-name descname"><span class="pre">get_CDS_aod_550nm_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numpy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.aod_550nm.get_CDS_aod_550nm_data" title="Permalink to this definition">#</a></dt>
<dd><p>Connects to the Climate Data Store (CDS) through its API and downloads the
monthly-averaged aerosol optical depth at 550 nm (aod_550nm) data
from the database in [1], for the requested time frame. A new folder
(whose path is specified by the user) is then automatically created
to store the downloaded files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>path-str</em>) – Path of the folder where one wishes to store the downloaded files in.</p></li>
<li><p><strong>year</strong> (<em>list</em><em> of </em><em>str</em>) – List of years for which the water-column data is to be retieved.
The years must be of type str rather than int.
Eg.: year = [“2020”, “2021”, “2022”].</p></li>
<li><p><strong>month</strong> (<em>None</em><em> or </em><em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – If is None (default), all months for the selected years are retrieved.
If not None, it must be list of months for which to retrieve the data.
Said months must be of type str rather than int.
Eg.: month = [“01”, “02”, “11”, “12”].</p></li>
<li><p><strong>file_format</strong> (<em>{'NetCDF4'</em><em>, </em><em>'numpy'}</em><em>, </em><em>optional</em>) – Format in which the data is to be downloaded.
If ‘NetCDF4’, the data is downloaded in its original format and no changes are made to it.
If ‘numpy’  , the relevant aod_550nm data are downloaded, along with the latitude
and longitude data, as numpy arrays. We also convert units from kg/m² to atm-cm (see notes
for more info). Default is ‘numpy’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>For this function to work, the user must have a Climate Data Store
account and be currently logged in. Furthermore, the user’s key and the
API website link should be stored in a place, recognisable by the system being used.
See <a class="reference external" href="https://youtu.be/DIdgltyoIYg?si=q7Ylu2p0IDFT9UGm">https://youtu.be/DIdgltyoIYg?si=q7Ylu2p0IDFT9UGm</a> for a quick Youtube tutorial about it.
See <a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to">https://cds.climate.copernicus.eu/api-how-to</a> for the official documentation.</p></li>
<li><p>For more information on the specific databse used, see:
<a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-total-column-water-vapour-land-ocean">https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-total-column-water-vapour-land-ocean</a>?tab=overview</p></li>
</ol>
<p class="rubric">References</p>
<p>[1] Copernicus Climate Change Service, Climate Data Store, (2019): Aerosol
properties gridded data from 1995 to present derived from satellite observation.
Copernicus Climate Change Service (C3S) Climate Data Store (CDS). DOI: 10.24381/cds.239d815c</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.aod_550nm.process_CDS_aod_550nm_data">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.aod_550nm.</span></span><span class="sig-name descname"><span class="pre">process_CDS_aod_550nm_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.aod_550nm.process_CDS_aod_550nm_data" title="Permalink to this definition">#</a></dt>
<dd><p>Process Aerosol Optical Depth at 550nm (aod_550nm) data located in the local aod_550nm database.
This function reads all the raw.ny and filled_NaNs.npy aod_550nm files (files which
were obtained via the <a class="reference internal" href="#solrad.atmosphere.aod_550nm.get_CDS_aod_550nm_data" title="solrad.atmosphere.aod_550nm.get_CDS_aod_550nm_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_CDS_aod_550nm_data()</span></code></a> and
<a class="reference internal" href="solrad.html#solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace" title="solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace"><code class="xref py py-func docutils literal notranslate"><span class="pre">fill_CDS_globe_nans_using_laplace()</span></code></a> functions) stored at the directory specified by
<em>path</em> and then computes multiple useful quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>path-str</em>) – Path of the folder where the aod_550nm raw.ny and filled_NaNs.npy files
are stored. That is, the path to the local aod_550nm database.</p></li>
<li><p><strong>percentile</strong> (<em>float</em>) – Percentile for computing the ‘percentile_data’ and ‘percentile_data_funcs’
dictionaries. Must be a number between 0 and 1. Default is 0.5.</p></li>
<li><p><strong>interp_method</strong> (<em>{'linear'</em><em>, </em><em>'nearest'</em><em>, </em><em>'slinear'</em><em>, </em><em>'cubic'</em><em>, </em><em>'quintic'}</em>) – The method of interpolation to perform when computing the
res[‘filled_nans_data_funcs’], res[‘avg_data_funcs’] and res[‘percentile_data_funcs’]
dictionaries. Supported methods are the same as supported by scipy’s
RegularGridInterpolator. Default is “linear”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>res</strong> – Dictionary of computed quantities. It has the following key-value
pairs:</p>
<blockquote>
<div><dl>
<dt>“latitude”<span class="classifier">numpy.array of floats (npoints,)</span></dt><dd><p>Array of latitude values (in degrees) used by the raw.npy and filled_NaNs.npy
files to specify the locations at which the aod_550nm data is
reported.</p>
</dd>
<dt>”longitude”<span class="classifier">numpy.array of floats (mpoints,)</span></dt><dd><p>Array of longitude values (in degrees) used by the raw.npy and filled_NaNs.npy
files to specify the locations at which the aod_550nm data is
reported.</p>
</dd>
<dt>”raw_data”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the raw data of aod_550nm values stored by the
raw.npy files in the local aod_550nm database. It has the following
key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>(year, month)<span class="classifier">2D numpy.array of floats (npoints, mpoints)</span></dt><dd><p>Where ‘year’ and ‘month’ are integers that specify the
time period for the array of data (with units atm-cm).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”filled_nan_data”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the filled-NaN data of aod_550nm values stored by the
filled_NaNs.npy files in the local aod_550nm database. It has the
following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>(year, month)<span class="classifier">2D numpy.array of floats (npoints, mpoints)</span></dt><dd><p>Where ‘year’ and ‘month’ are integers that specify the
time period for the array of data (with units atm-cm).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”filled_nan_data_funcs”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the interpolating functions of the
filled-NaN data of aod_550nm values stored in the local
aod_550nm database. It has the following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>(year, month)<span class="classifier">scipy.interpolate.RegularGridInterpolator object</span></dt><dd><p>Where ‘year’ and ‘month’ are integers that specify the
time period for the array of data (with units atm-cm)
that the function interpolates. It takes as input a value
of latitude and longitude and returns the aod_550nm value
expected at that location.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”avg_data”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the year-wise averaged data of filled-NaN
aod_550nm values stored in the local aod_550nm database, for each
month. It has the following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">2D numpy.arrays of floats (npoints, mpoints)</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”avg_data_funcs”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the interpolating functions of the year-wise
averaged data of filled-NaN aod_550nm values stored in the local
aod_550nm database, for each month. It has the following key-value pair
format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">scipy.interpolate.RegularGridInterpolator object</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm)
that the function interpolates. It takes as input a value
of latitude and longitude and returns the aod_550nm value
expected at that location.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”percentile_data”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the year-wise ‘percentile’-th percentile
of the filled-NaN aod_550nm data values stored in the local
water database, for each month. It has the following key-value
pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">2D numpy.arrays of floats (npoints, mpoints)</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”percentile_data_funcs”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the interpolating functions of the filled-NaN
year-wise ‘percentile’-th percentile data of aod_550nm
values stored in the local aod_550nm database. It has the
following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">scipy.interpolate.RegularGridInterpolator object</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm)
that the function interpolates. It takes as input a value
of latitude and longitude and returns the aod_550nm value
expected at that location.</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>1</strong><strong>) </strong><strong>Exception</strong> – “Local aod_550nm database is empty. No aod_550nm raw.npy nor filled_NaNs.npy files to retrieve were found.”</p></li>
<li><p><strong>2</strong><strong>) </strong><strong>Exception</strong> – “Latitude data could not be recovered. No latitude.npy files are present in the database.”</p></li>
<li><p><strong>3</strong><strong>) </strong><strong>Exception</strong> – “Longitude data could not be recovered. No longitude.npy files are present in the database.”</p></li>
</ul>
</dd>
<dt class="field-odd">Warns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>1) Warning</strong> – “Local aod_550nm database is empty of filled_NaNs.npy files. No aod_550nm filled_NaNs.npy files to retrieve were found.”</p></li>
<li><p><strong>2) Warning</strong> – “Local aod_550nm database is empty of raw.npy files. No aod_550nm raw.npy files to retrieve were found.”</p></li>
<li><p><strong>3) Warning</strong> – “Not all raw.npy files have an associated filled_NaNs.npy file in the database, and viceversa. Therefore, not all information will be available for all files.”</p></li>
<li><p><strong>4) Warning</strong> – “WARNING: Local aod_550nm database lacks raw.npy data files for all 12 months of the year.”</p></li>
<li><p><strong>5) Warning</strong> – “WARNING: Local aod_550nm database lacks filled_NaNs.npy data files for all 12 months of the year.”</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>res[“raw_data”] contains as many key-value pairs as there are raw.npy
files in the local aod_550nm database.</p></li>
<li><p>res[“filled_nan_data”], res[“filled_nan_data_funcs”], res[“avg_data”],
res[“avg_data_funcs”], res[“precentile_data”] and res[“precentile_data_funcs”]
as many key-value pairs as there are filled_NaNs.npy files in the local aod_550nm
database.</p></li>
<li><p>Latitude of -90° corresponds to the geographic South pole, while a
latitude of 90° corresponds to the geographic North Pole.</p></li>
<li><p>A negative longitude correspondes to a point west of the greenwhich
meridian, while a positive longitude means it is east of the greenwhich
meridian.</p></li>
</ol>
</dd></dl>

</section>
<section id="module-solrad.atmosphere.ozone_column">
<span id="solrad-atmosphere-ozone-column-module"></span><h2>solrad.atmosphere.ozone_column module<a class="headerlink" href="#module-solrad.atmosphere.ozone_column" title="Permalink to this heading">#</a></h2>
<p>This module contains all functions, methods and classes related to the
computation and manipulation of the atmospheric ozone column of a site.</p>
<p><strong>CLIMATE DATA STORE</strong></p>
<p>“The Copernicus - Climate Data Store (CDS) is an online open and free service
that allows users to browse and access a wide range of climate datasets via a
searchable catalogue. It also allows users to build their own applications,
maps and graphs.”</p>
<p>1) CDS webpage at:
<a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/home">https://cds.climate.copernicus.eu/cdsapp#!/home</a></p>
<p>2) More info about its API, at:
<a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to">https://cds.climate.copernicus.eu/api-how-to</a></p>
<p>3) Useful tutorial on how to use the API, at
<a class="reference external" href="https://youtu.be/cVtiVTSVdlo">https://youtu.be/cVtiVTSVdlo</a></p>
<p><strong>NOTE:</strong> As described by the links in 2) and 3), it is necessary to have a CDS
account (and be currently logged in) account in order to be able to use
the API. Furtheremore, the user’s key and the API website link should be
stored in a place, recognisable by the system being used.</p>
<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.ozone_column.compute_van_Heuklon_ozone">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.ozone_column.</span></span><span class="sig-name descname"><span class="pre">compute_van_Heuklon_ozone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.ozone_column.compute_van_Heuklon_ozone" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the ozone contents in atm-cm for the given latitude/longitude and
timestamp according to van Heuklon’s Ozone model. The model is described in
Van Heuklon, ‘T. K. (1979). Estimating atmospheric ozone for solar radiation
models. Solar Energy, 22(1), 63-68’. This function uses numpy functions,
so you can pass arrays and it will return an array of results. The
timestamp argument can be either an array/list or a single value.
If timestamp is a single value then this will be used for all lat/lon
values given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (<em>float</em><em> or </em><em>array-like</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Site’s latitude in degrees. Values must be between -90 and 90.</p></li>
<li><p><strong>longitude</strong> (<em>float</em><em> or </em><em>array-like</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Site’s longitude in degrees. Values must be between -180 and 180.</p></li>
<li><p><strong>timestamp</strong> (<em>pandas.Timestamp object</em><em> or </em><em>array-like</em><em> of </em><em>pandas.Timestamp objects float</em><em> or </em><em>array-like</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – The times for which the ozone is to be computed. It is strongly
recommend that the timestamp use an ISO 8601 format of yyyy-mm-dd.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong> – Ozone amount in atm-cm.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>1</strong><strong>) </strong><strong>ValueError</strong> – “lan and lon arrays must be the same length”</p></li>
<li><p><strong>2</strong><strong>) </strong><strong>ValueError</strong> – “Timestamp must be the same length as lat and lon”</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>This function was directly taken from <a class="reference external" href="https://github.com/robintw/vanHOzone">https://github.com/robintw/vanHOzone</a>
all credit goes to him. I copy-pasted the code rather than directly
downloading tthe pachage from pip as I wanted to add some very minor
changes.</p></li>
<li><p>The function supports array-like inputs for latitude, longitude
and timestamp, as long as all 3 arguments are the same length.</p></li>
<li><p>Latitude of -90° corresponds to the geographic South pole, while a
latitude of 90° corresponds to the geographic North Pole.</p></li>
<li><p>A negative longitude correspondes to a point west of the greenwhich
meridian, while a positive longitude means it is east of the greenwhich
meridian.</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.ozone_column.get_CDS_ozone_column_data">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.ozone_column.</span></span><span class="sig-name descname"><span class="pre">get_CDS_ozone_column_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numpy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.ozone_column.get_CDS_ozone_column_data" title="Permalink to this definition">#</a></dt>
<dd><p>Connects to the Climate Data Store (CDS) through its API and downloads the
ozone-column data from the database in [1], for the requested time frame.
A new folder (whose path is specified by the user) is then automatically
created to store the downloaded files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>path-str</em>) – Path of the folder where one wishes to store the downloaded files.</p></li>
<li><p><strong>year</strong> (<em>list</em><em> of </em><em>str</em>) – List of years for which the ozone-column data is to be retieved.
The years must be of type str rather than int.
Eg.: year = [“2019”, “2020”, “2021”].</p></li>
<li><p><strong>month</strong> (<em>None</em><em> or </em><em>list</em><em> of </em><em>str</em>) – If is None (default), all months for the selected years are retrieved.
If not None, it must be list of months for which to retrieve the data.
Said months must be of type str rather than int.
Eg.: month = [“01”, “02”, “11”, “12”].</p></li>
<li><p><strong>file_format</strong> (<em>{'NetCDF4'</em><em>, </em><em>'numpy'}</em><em>, </em><em>optional</em>) – Format in which the data is to be downloaded.
If ‘NetCDF4’, the data is downloaded in its original format and no changes are made to it.
If ‘numpy’  , the relevant water column data are downloaded, along with the latitude
and longitude data, as numpy arrays. We also convert units from Dobson to atm-cm (see notes
for more info). Default is ‘numpy’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1] Copernicus Climate Change Service, Climate Data Store, (2020):
Ozone monthly gridded data from 1970 to present derived from satellite observations.
Copernicus Climate Change Service (C3S) Climate Data Store (CDS). DOI: 10.24381/cds.4ebfe4eb</p>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>For this function to work, the user must have a Climate Data Store
account and be currently logged in. Furthermore, the user’s key and the
API website link should be stored in a place, recognisable by the system being used.
See <a class="reference external" href="https://youtu.be/DIdgltyoIYg?si=q7Ylu2p0IDFT9UGm">https://youtu.be/DIdgltyoIYg?si=q7Ylu2p0IDFT9UGm</a> for a quick Youtube tutorial about it.
See <a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to">https://cds.climate.copernicus.eu/api-how-to</a> for the official documentation.</p></li>
<li><p>For more information on the specific databse used, see:
<a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-ozone-v1">https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-ozone-v1</a>?tab=overview</p></li>
<li><p>The downloaded data are .nc files holding the monthly-average of ozone-column data
(in m atm-cm, i.e, Dobson) of the whole globe, for the requested time frame.</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.ozone_column.process_CDS_ozone_column_data">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.ozone_column.</span></span><span class="sig-name descname"><span class="pre">process_CDS_ozone_column_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.ozone_column.process_CDS_ozone_column_data" title="Permalink to this definition">#</a></dt>
<dd><p>Process ozone data located in the local ozone database. This function reads the raw.npy
ozone-column files (files which were obtained via the <a class="reference internal" href="#solrad.atmosphere.ozone_column.get_CDS_ozone_column_data" title="solrad.atmosphere.ozone_column.get_CDS_ozone_column_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_CDS_ozone_column_data()</span></code></a> function)
stored at the directory specified by <em>path</em> and then computes multiple useful quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>path-str</em>) – Path of the folder where the water column raw.ny and filled_NaNs.npy files
are stored. That is, the path to the local water column database.</p></li>
<li><p><strong>percentile</strong> (<em>float</em>) – Percentile for computing the ‘percentile_data’ and ‘percentile_data_funcs’
dictionaries. Must be a number between 0 and 1. Default is 0.5.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>interp_method<span class="classifier">{‘linear’, ‘nearest’, ‘slinear’, ‘cubic’, ‘quintic’}</span></dt><dd><p>The method of interpolation to perform when computing the
res[‘raw_data_funcs’], res[‘avg_data_funcs’] and res[‘percentile_data_funcs’]
dictionaries. Supported methods are the same as supported by scipy’s
RegularGridInterpolator. Default is “linear”.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p><strong>res</strong> – Dictionary of computed quantities. It has the following key-value
pairs:</p>
<blockquote>
<div><dl>
<dt>“latitude”<span class="classifier">numpy.array of floats (npoints,)</span></dt><dd><p>Array of latitude values (in degrees) used by the raw.npy and filled_NaNs.npy
files to specify the locations at which the water column data is
reported.</p>
</dd>
<dt>”longitude”<span class="classifier">numpy.array of floats (mpoints,)</span></dt><dd><p>Array of longitude values (in degrees) used by the raw.npy and filled_NaNs.npy
files to specify the locations at which the water column data is
reported.</p>
</dd>
<dt>”raw_data”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the raw data of ozone-column values stored by the
raw.npy files in the local water column database. It has the following
key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>(year, month)<span class="classifier">2D numpy.array of floats (npoints, mpoints)</span></dt><dd><p>Where ‘year’ and ‘month’ are integers that specify the
time period for the array of data (with units atm-cm).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”raw_data_funcs”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the interpolating functions of the raw
data of ozone-column values stored in the local ozone database.
It has the following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>(year, month)<span class="classifier">scipy.interpolate.RegularGridInterpolator object</span></dt><dd><p>Where ‘year’ and ‘month’ are integers that specify the
time period for the array of data (with units atm-cm)
that the function interpolates. It takes as input a value
of latitude and longitude and returns the ozone-column value
expected at that location.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”avg_data”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the year-wise averaged data of ozone-column
values stored in the local ozone database, for each month. It has
the following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">2D numpy.arrays of floats (npoints, mpoints)</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”avg_data_funcs”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the interpolating functions of the year-wise
averaged data of ozone-column values stored in the local ozone database,
for each month. It has the following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">scipy.interpolate.RegularGridInterpolator object</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm)
that the function interpolates. It takes as input a value
of latitude and longitude and returns the ozone-column value
expected at that location.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”percentile_data”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the year-wise ‘percentile’-th percentile
of the ozone-column data values stored in the local ozone
database, for each month. It has the following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">2D numpy.arrays of floats (npoints, mpoints)</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”percentile_data_funcs”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the interpolating functions of the year-wise
‘percentile’-th percentile of the ozone-column data values stored in
the local ozone database, for each month. It has the following
key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">scipy.interpolate.RegularGridInterpolator object</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm)
that the function interpolates. It takes as input a value
of latitude and longitude and returns the ozone-column value
expected at that location.</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>1</strong><strong>) </strong><strong>Exception</strong> – “Local ozone column database is empty. No ozone column raw.npy nor filled_NaNs.npy files to retrieve were found.”</p></li>
<li><p><strong>2</strong><strong>) </strong><strong>Exception</strong> – “Latitude data could not be recovered. No latitude.npy files are present in the database.”</p></li>
<li><p><strong>3</strong><strong>) </strong><strong>Exception</strong> – “Longitude data could not be recovered. No longitude.npy files are present in the database.”</p></li>
</ul>
</dd>
<dt class="field-even">Warns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>1) Warning</strong> – “WARNING: Local ozone column database lacks raw.npy data files for all 12 months of the year.”</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>res[“raw_data”], res[“raw_data_funcs”], res[“avg_data”], res[“avg_data_funcs”],
res[“precentile_data”] and res[“precentile_data_funcs”] as many key-value pairs
as there are raw.npy files in the local ozone database.</p></li>
<li><p>Latitude of -90° corresponds to the geographic South pole, while a
latitude of 90° corresponds to the geographic North Pole.</p></li>
<li><p>A negative longitude correspondes to a point west of the greenwhich
meridian, while a positive longitude means it is east of the greenwhich
meridian.</p></li>
</ol>
</dd></dl>

</section>
<section id="module-solrad.atmosphere.single_scattering_albedo">
<span id="solrad-atmosphere-single-scattering-albedo-module"></span><h2>solrad.atmosphere.single_scattering_albedo module<a class="headerlink" href="#module-solrad.atmosphere.single_scattering_albedo" title="Permalink to this heading">#</a></h2>
<p>This module contains all functions, methods and classes related to the
computation and manipulation of the Single-Scattering Albedo of a site.</p>
<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.single_scattering_albedo.compute_single_scattering_albedo_using_SF">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.single_scattering_albedo.</span></span><span class="sig-name descname"><span class="pre">compute_single_scattering_albedo_using_SF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.single_scattering_albedo.compute_single_scattering_albedo_using_SF" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the single scattering albedo using the Shettel and Fenn (SF) model
as described in [1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RH</strong> (<em>float</em><em> or </em><em>array_like</em><em> of </em><em>floats</em>) – Relative Humidity of the air in %. Must be a non-negative number or array
of numbers between 0 and 100.</p></li>
<li><p><strong>wavelength</strong> (<em>float</em><em> or </em><em>array_like</em><em> of </em><em>floats</em>) – Wavelength in nanometers for which the single scattering albedo
is to be computed. Must be a number or array of numbers between 200
and 4500.</p></li>
<li><p><strong>model</strong> (<em>{“Rural”</em><em>, </em><em>“Urban”</em><em>, </em><em>&quot;Maritime&quot;}</em>) – Model to be used in the computation of the single scattering albedo.</p></li>
<li><p><strong>interp_method</strong> (<em>{&quot;linear&quot;</em><em>, </em><em>&quot;nearest&quot;</em><em>, </em><em>&quot;cubic&quot;}</em><em>, </em><em>optional</em>) – Method of interpolation to use on the data. Default is “linear”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>single_scattering_albedo</strong> – Single scattering albedo.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array of floats</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>1) ‘RH’’ can be an array of any length, while ‘wavelength’ is a float;
and viceversa. However, if ‘RH’ and ‘wavelength’ are both arrays,
they should be the same length.</p>
<p class="rubric">References</p>
<p>[1] Shettle, Eric &amp; Fenn, Robert. (1979). Models for the Aerosols of the
Lower Atmosphere and the Effects of Humidity Variations on their Optical
Properties. Environ. Res.. 94.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solrad.atmosphere.single_scattering_albedo</span> <span class="kn">import</span> <span class="n">compute_single_scattering_albedo_using_SF</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RHs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Rural&quot;</span><span class="p">,</span> <span class="s2">&quot;Urban&quot;</span><span class="p">,</span> <span class="s2">&quot;Maritime&quot;</span><span class="p">]:</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">RHs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">RH</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">RHs</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">compute_single_scattering_albedo_using_SF</span><span class="p">(</span><span class="n">RH</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">interp_method</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">RH</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelengths [nm]&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Single Scattering Albedo [-]&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model= </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Relative Humidity&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-solrad.atmosphere.water_column">
<span id="solrad-atmosphere-water-column-module"></span><h2>solrad.atmosphere.water_column module<a class="headerlink" href="#module-solrad.atmosphere.water_column" title="Permalink to this heading">#</a></h2>
<p>This module contains all functions, methods and classes related to the
computation and manipulation of the precipitable water column of a site.</p>
<p><strong>CLIMATE DATA STORE</strong></p>
<p>“The Copernicus - Climate Data Store (CDS) is an online open and free service
that allows users to browse and access a wide range of climate datasets via a
searchable catalogue. It also allows users to build their own applications,
maps and graphs.”</p>
<p>1) CDS webpage at:
<a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/home">https://cds.climate.copernicus.eu/cdsapp#!/home</a></p>
<p>2) More info about its API, at:
<a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to">https://cds.climate.copernicus.eu/api-how-to</a></p>
<p>3) Useful tutorial on how to use the API, at
<a class="reference external" href="https://youtu.be/cVtiVTSVdlo">https://youtu.be/cVtiVTSVdlo</a></p>
<p><strong>NOTE:</strong> As described by the links in 2) and 3), it is necessary to have a CDS
account (and be currently logged in) account in order to be able to use
the API. Furtheremore, the user’s key and the API website link should be
stored in a place, recognisable by the system being used.</p>
<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.water_column.fill_CDS_water_column_data_nans">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.water_column.</span></span><span class="sig-name descname"><span class="pre">fill_CDS_water_column_data_nans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.water_column.fill_CDS_water_column_data_nans" title="Permalink to this definition">#</a></dt>
<dd><p>Fill NaNs with suitable numeric aproximation of CDS water column raw data.</p>
<p>The data retrieved from the Climate Data Store (CDS) database referenced
in [1] has a considerable amount of missing or defective values in its files.
This is inconvenient for later computations. As such, this function reads all
‘raw.npy’ files in the directory specified by the <em>path</em> argument (i.e, the local water
column database), that were obtained via the function <a class="reference internal" href="#solrad.atmosphere.water_column.get_CDS_water_column_data" title="solrad.atmosphere.water_column.get_CDS_water_column_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_CDS_water_column_data()</span></code></a>; and
uses the function <a class="reference internal" href="solrad.html#solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace" title="solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace"><code class="xref py py-func docutils literal notranslate"><span class="pre">fill_CDS_globe_nans_using_laplace()</span></code></a> to fill each file’s
NaN values with a suitable numeric approximation and then saves each modified file back
to the same directory as a ‘filled_NaNs.npy’ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>path-str</em>) – Path of the folder where the raw.npy files, containing the water
column information downloaded from the aforementioned database, are
stored. The resulting filled_NaNs.npy files will also be stored in
this same directory.</p></li>
<li><p><strong>iterations</strong> (<em>int</em>) – Number of iterations that the <a class="reference internal" href="solrad.html#solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace" title="solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace"><code class="xref py py-func docutils literal notranslate"><span class="pre">fill_CDS_globe_nans_using_laplace()</span></code></a>
function should use for computing the numerical approximation to the
NaN values, before stopping (must be non-negative). The greater the
number of iterations, the greater the chance that convergence of the
computed values has been reached. However, the time of computation also
increases. Default is 20000.</p></li>
<li><p><strong>show_progress</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, after processing each file, it prints how many files
have been processed as of yet. If False, it prints nothing.
Default is False.</p></li>
<li><p><strong>replace</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to errase the original raw.npy files, after the new filled_NaNs.npy
files (with have been created. This, as a way to save space in memory.
Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>1</strong><strong>) </strong><strong>Exception :</strong> – “Local water column database is empty. No water column raw.npy files to retrieve were found.”</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1] Preusker, R., El Kassar, R. (2022): Monthly total column water vapour over
land and ocean from 2002 to 2012 derived from satellite observation. Copernicus
Climate Change Service (C3S) Climate Data Store (CDS). DOI: 10.24381/cds.8e0e4724</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.water_column.get_CDS_water_column_data">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.water_column.</span></span><span class="sig-name descname"><span class="pre">get_CDS_water_column_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numpy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.water_column.get_CDS_water_column_data" title="Permalink to this definition">#</a></dt>
<dd><p>Connects to the Climate Data Store (CDS) through its API and downloads the
monthly-averaged water column data from the database in [1], for the requested
time frame. A new folder (whose path is specified by the user) is then automatically
created to store the downloaded files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>path-str</em>) – Path of the folder where one wishes to store the downloaded files in.</p></li>
<li><p><strong>year</strong> (<em>list</em><em> of </em><em>str</em>) – List of years for which the water-column data is to be retieved.
The years must be of type str rather than int.
Eg.: year = [“2009”, “2010”, “2011”].</p></li>
<li><p><strong>month</strong> (<em>None</em><em> or </em><em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – If is None (default), all months for the selected years are retrieved.
If not None, it must be list of months for which to retrieve the data.
Said months must be of type str rather than int.
Eg.: month = [“01”, “02”, “11”, “12”].</p></li>
<li><p><strong>file_format</strong> (<em>{'NetCDF4'</em><em>, </em><em>'numpy'}</em><em>, </em><em>optional</em>) – Format in which the data is to be downloaded.
If ‘NetCDF4’, the data is downloaded in its original format and no changes are made about it.
If ‘numpy’  , the relevant water column data are downloaded, along with the latitude
and longitude data, as numpy arrays. We also convert units from kg/m² to atm-cm (see notes
for more info). Default is ‘numpy’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>1) For this function to work, the user must have a Climate Data Store
account and be currently logged in. Furtheremore, the user’s key and the
API website link should be stored in a place, recognisable by the system being used.
See <a class="reference external" href="https://youtu.be/DIdgltyoIYg?si=q7Ylu2p0IDFT9UGm">https://youtu.be/DIdgltyoIYg?si=q7Ylu2p0IDFT9UGm</a> for a quick Youtube tutorial about it.
See <a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to">https://cds.climate.copernicus.eu/api-how-to</a> for the official documentation.</p>
<p>2) For more information on the specific databse used, see:
<a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-total-column-water-vapour-land-ocean">https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-total-column-water-vapour-land-ocean</a>?tab=overview</p>
<p>3) The original, unaltered, downloaded data are .nc files holding the Total Column
Water Vapour (in kg/m²) of the whole globe, for the requested time frame.</p>
<p>4) “Total Column Water Vapour (also called integrated Water Vapour (IWV) or
Precipitable Water Vapour (PWV)) is the integrated mass of gaseous water
in the total column of the atmosphere over an area of 1 m²” and it is
usually given in kg/m². However, another common way of expressing this
same variable, is as the height (in cm) that a column of x kilograms
of water would have, when being bounded by a cube whose base has an area
of 1 m². Using the average density of water (997 kg/m³ ≈ 1000 kg/m³),
we see that a Total column of water vapour of x kg/m² would roughly
equate to a x/10 cm water column.</p>
<p class="rubric">References</p>
<p>[1] Preusker, R., El Kassar, R. (2022): Monthly total column water vapour over
land and ocean from 2002 to 2012 derived from satellite observation. Copernicus
Climate Change Service (C3S) Climate Data Store (CDS). DOI: 10.24381/cds.8e0e4724</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.atmosphere.water_column.process_CDS_water_column_data">
<span class="sig-prename descclassname"><span class="pre">solrad.atmosphere.water_column.</span></span><span class="sig-name descname"><span class="pre">process_CDS_water_column_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.atmosphere.water_column.process_CDS_water_column_data" title="Permalink to this definition">#</a></dt>
<dd><p>Process the water column data located in the local water column database.
This function reads all the raw.ny and filled_NaNs.npy water column files (files which
were obtained via the <a class="reference internal" href="#solrad.atmosphere.water_column.get_CDS_water_column_data" title="solrad.atmosphere.water_column.get_CDS_water_column_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_CDS_water_column_data()</span></code></a> function) and
<a class="reference internal" href="solrad.html#solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace" title="solrad.auxiliary_funcs.fill_CDS_globe_nans_using_laplace"><code class="xref py py-func docutils literal notranslate"><span class="pre">fill_CDS_globe_nans_using_laplace()</span></code></a> functions) stored at the directory
specified by <em>path</em> and then computes multiple useful quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>path-str</em>) – Path of the folder where the water column raw.ny and filled_NaNs.npy files
are stored. That is, the path to the local water column database.</p></li>
<li><p><strong>percentile</strong> (<em>float</em>) – Percentile for computing the ‘percentile_data’ and ‘percentile_data_funcs’
dictionaries. Must be a number between 0 and 1. Default is 0.5.</p></li>
<li><p><strong>interp_method</strong> (<em>{'linear'</em><em>, </em><em>'nearest'</em><em>, </em><em>'slinear'</em><em>, </em><em>'cubic'</em><em>, </em><em>'quintic'}</em>) – The method of interpolation to perform when computing the
res[‘filled_nans_data_funcs’], res[‘avg_data_funcs’] and res[‘percentile_data_funcs’]
dictionaries. Supported methods are the same as supported by scipy’s
RegularGridInterpolator. Default is “linear”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>res</strong> – Dictionary of computed quantities. It has the following key-value
pairs:</p>
<blockquote>
<div><dl>
<dt>“latitude”<span class="classifier">numpy.array of floats (npoints,)</span></dt><dd><p>Array of latitude values (in degrees) used by the raw.npy and filled_NaNs.npy
files to specify the locations at which the water column data is
reported.</p>
</dd>
<dt>”longitude”<span class="classifier">numpy.array of floats (mpoints,)</span></dt><dd><p>Array of longitude values (in degrees) used by the raw.npy and filled_NaNs.npy
files to specify the locations at which the water column data is
reported.</p>
</dd>
<dt>”raw_data”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the raw data of water-column values stored by the
raw.npy files in the local water column database. It has the following
key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>(year, month)<span class="classifier">2D numpy.array of floats (npoints, mpoints)</span></dt><dd><p>Where ‘year’ and ‘month’ are integers that specify the
time period for the array of data (with units atm-cm).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”filled_nan_data”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the filled-NaN data of water-column values stored by the
filled_NaNs.npy files in the local water column database. It has the
following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>(year, month)<span class="classifier">2D numpy.array of floats (npoints, mpoints)</span></dt><dd><p>Where ‘year’ and ‘month’ are integers that specify the
time period for the array of data (with units atm-cm).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”filled_nan_data_funcs”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the interpolating functions of the
filled-NaN data of water-column values stored in the local
water column database. It has the following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>(year, month)<span class="classifier">scipy.interpolate.RegularGridInterpolator object</span></dt><dd><p>Where ‘year’ and ‘month’ are integers that specify the
time period for the array of data (with units atm-cm)
that the function interpolates. It takes as input a value
of latitude and longitude and returns the water-column value
expected at that location.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”avg_data”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the year-wise averaged data of filled-NaN
water-column values stored in the local water database, for each
month. It has the following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">2D numpy.arrays of floats (npoints, mpoints)</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”avg_data_funcs”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the interpolating functions of the year-wise
averaged data of filled-NaN water-column values stored in the local
water database, for each month. It has the following key-value pair
format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">scipy.interpolate.RegularGridInterpolator object</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm)
that the function interpolates. It takes as input a value
of latitude and longitude and returns the water-column value
expected at that location.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”percentile_data”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the year-wise ‘percentile’-th percentile
of the filled-NaN water-column data values stored in the local
water database, for each month. It has the following key-value
pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">2D numpy.arrays of floats (npoints, mpoints)</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>”percentile_data_funcs”<span class="classifier">dict</span></dt><dd><p>Dictionary containing the interpolating functions of the filled-NaN
year-wise ‘percentile’-th percentile data of water-column
values stored in the local water column database. It has the
following key-value pair format:</p>
<blockquote>
<div><dl class="simple">
<dt>month<span class="classifier">scipy.interpolate.RegularGridInterpolator object</span></dt><dd><p>Where ‘month’ is an integer that specifies the
time period for the array of data (with units atm-cm)
that the function interpolates. It takes as input a value
of latitude and longitude and returns the water-column value
expected at that location.</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>1</strong><strong>) </strong><strong>Exception</strong> – “Local water column database is empty. No water column raw.npy nor filled_NaNs.npy files to retrieve were found.”</p></li>
<li><p><strong>2</strong><strong>) </strong><strong>Exception</strong> – “Latitude data could not be recovered. No latitude.npy files are present in the database.”</p></li>
<li><p><strong>3</strong><strong>) </strong><strong>Exception</strong> – “Longitude data could not be recovered. No longitude.npy files are present in the database.”</p></li>
</ul>
</dd>
<dt class="field-odd">Warns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>1) Warning</strong> – “Local water column database is empty of filled_NaNs.npy files. No column water filled_NaNs.npy files to retrieve were found.”</p></li>
<li><p><strong>2) Warning</strong> – “Local water column database is empty of raw.npy files. No column water raw.npy files to retrieve were found.”</p></li>
<li><p><strong>3) Warning</strong> – “Not all raw.npy files have an associated filled_NaNs.npy file in the database, and viceversa. Therefore, not all information will be available for all files.”</p></li>
<li><p><strong>4) Warning</strong> – “WARNING: Local water column database lacks raw.npy data files for all 12 months of the year.”</p></li>
<li><p><strong>5) Warning</strong> – “WARNING: Local water column database lacks filled_NaNs.npy data files for all 12 months of the year.”</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>1) res[“raw_data”] contains as many key-value pairs as there are raw.npy
files in the local water database.</p>
<p>2) res[“filled_nan_data”], res[“filled_nan_data_funcs”], res[“avg_data”],
res[“avg_data_funcs”], res[“precentile_data”] and res[“precentile_data_funcs”]
as many key-value pairs as there are filled_NaNs.npy files in the local water
database.</p>
<p>3) Latitude of -90° corresponds to the geographic South pole, while a
latitude of 90° corresponds to the geographic North Pole.</p>
<p>4) A negative longitude correspondes to a point west of the greenwhich
meridian, while a positive longitude means it is east of the greenwhich
meridian.</p>
</dd></dl>

</section>
<section id="module-solrad.atmosphere">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-solrad.atmosphere" title="Permalink to this heading">#</a></h2>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="solrad.climate.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">solrad.climate package</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="solrad.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">solrad package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Andrés Yesid Moreno Villa
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">solrad.atmosphere package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-solrad.atmosphere.aerosol_asymmetry_factor">solrad.atmosphere.aerosol_asymmetry_factor module</a><ul>
<li><a class="reference internal" href="#solrad.atmosphere.aerosol_asymmetry_factor.compute_aerosol_asymmetry_factor_using_SF"><code class="docutils literal notranslate"><span class="pre">compute_aerosol_asymmetry_factor_using_SF()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-solrad.atmosphere.angstrom_exponent">solrad.atmosphere.angstrom_exponent module</a><ul>
<li><a class="reference internal" href="#solrad.atmosphere.angstrom_exponent.compute_angstrom_exponent_using_SF"><code class="docutils literal notranslate"><span class="pre">compute_angstrom_exponent_using_SF()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-solrad.atmosphere.aod_550nm">solrad.atmosphere.aod_550nm module</a><ul>
<li><a class="reference internal" href="#solrad.atmosphere.aod_550nm.fill_CDS_aod_550nm_data_nans"><code class="docutils literal notranslate"><span class="pre">fill_CDS_aod_550nm_data_nans()</span></code></a></li>
<li><a class="reference internal" href="#solrad.atmosphere.aod_550nm.get_CDS_aod_550nm_data"><code class="docutils literal notranslate"><span class="pre">get_CDS_aod_550nm_data()</span></code></a></li>
<li><a class="reference internal" href="#solrad.atmosphere.aod_550nm.process_CDS_aod_550nm_data"><code class="docutils literal notranslate"><span class="pre">process_CDS_aod_550nm_data()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-solrad.atmosphere.ozone_column">solrad.atmosphere.ozone_column module</a><ul>
<li><a class="reference internal" href="#solrad.atmosphere.ozone_column.compute_van_Heuklon_ozone"><code class="docutils literal notranslate"><span class="pre">compute_van_Heuklon_ozone()</span></code></a></li>
<li><a class="reference internal" href="#solrad.atmosphere.ozone_column.get_CDS_ozone_column_data"><code class="docutils literal notranslate"><span class="pre">get_CDS_ozone_column_data()</span></code></a></li>
<li><a class="reference internal" href="#solrad.atmosphere.ozone_column.process_CDS_ozone_column_data"><code class="docutils literal notranslate"><span class="pre">process_CDS_ozone_column_data()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-solrad.atmosphere.single_scattering_albedo">solrad.atmosphere.single_scattering_albedo module</a><ul>
<li><a class="reference internal" href="#solrad.atmosphere.single_scattering_albedo.compute_single_scattering_albedo_using_SF"><code class="docutils literal notranslate"><span class="pre">compute_single_scattering_albedo_using_SF()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-solrad.atmosphere.water_column">solrad.atmosphere.water_column module</a><ul>
<li><a class="reference internal" href="#solrad.atmosphere.water_column.fill_CDS_water_column_data_nans"><code class="docutils literal notranslate"><span class="pre">fill_CDS_water_column_data_nans()</span></code></a></li>
<li><a class="reference internal" href="#solrad.atmosphere.water_column.get_CDS_water_column_data"><code class="docutils literal notranslate"><span class="pre">get_CDS_water_column_data()</span></code></a></li>
<li><a class="reference internal" href="#solrad.atmosphere.water_column.process_CDS_water_column_data"><code class="docutils literal notranslate"><span class="pre">process_CDS_water_column_data()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-solrad.atmosphere">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>