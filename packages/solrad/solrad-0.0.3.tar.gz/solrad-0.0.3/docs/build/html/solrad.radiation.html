<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="solrad.sun package" href="solrad.sun.html" /><link rel="prev" title="solrad.climate package" href="solrad.climate.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2023.09.10 -->
        <title>solrad.radiation package - solrad 0.0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=369552022d0b975c8e74270ce6eabe0fb7978f24" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">solrad 0.0.2 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">solrad 0.0.2 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="modules.html">src</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of src</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="solrad.html">solrad package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of solrad package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="solrad.atmosphere.html">solrad.atmosphere package</a></li>
<li class="toctree-l3"><a class="reference internal" href="solrad.climate.html">solrad.climate package</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">solrad.radiation package</a></li>
<li class="toctree-l3"><a class="reference internal" href="solrad.sun.html">solrad.sun package</a></li>
<li class="toctree-l3"><a class="reference internal" href="solrad.terrain.html">solrad.terrain package</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="solrad-radiation-package">
<h1>solrad.radiation package<a class="headerlink" href="#solrad-radiation-package" title="Permalink to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-solrad.radiation.diffuse_radiance_model">
<span id="solrad-radiation-diffuse-radiance-model-module"></span><h2>solrad.radiation.diffuse_radiance_model module<a class="headerlink" href="#module-solrad.radiation.diffuse_radiance_model" title="Permalink to this heading">#</a></h2>
<p>This module contains all functions related to the computation of the
spatial distribution of diffuse irradiance, also called diffuse radiance. This is
accomplished by implementing the model developed by Iagawa et al.
in their 2004 and 2014 papers (see references). The implementation here is mainly based off the
2014 paper, but making use of some expressions that only appeared in the 2004
paper.</p>
<p class="rubric">References</p>
<p>[1] Norio Igawa, Yasuko Koga, Tomoko Matsuzawa, Hiroshi Nakamura, Models of sky radiance distribution and sky luminance distribution,
Solar Energy, Volume 77, Issue 2, 2004, Pages 137-157, ISSN 0038-092X,
<a class="reference external" href="https://doi.org/10.1016/j.solener.2004.04.016">https://doi.org/10.1016/j.solener.2004.04.016</a>. (<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0038092X04001070">https://www.sciencedirect.com/science/article/pii/S0038092X04001070</a>)</p>
<p>[2] Norio Igawa, Improving the All Sky Model for the luminance and radiance distributions of the sky,
Solar Energy, Volume 105, 2014, Pages 354-372, ISSN 0038-092X,
<a class="reference external" href="https://doi.org/10.1016/j.solener.2014.03.020">https://doi.org/10.1016/j.solener.2014.03.020</a>. (<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0038092X14001546">https://www.sciencedirect.com/science/article/pii/S0038092X14001546</a>)</p>
<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.compute_angular_distance_between_sun_and_sky_element_Zeta">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_angular_distance_between_sun_and_sky_element_Zeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">El</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_apel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.compute_angular_distance_between_sun_and_sky_element_Zeta" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the angular distance between the sun and one or multiple sky
elements on the sky.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Az</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>,</em><em>1</em><em>)</em>) – If float, it should be the azimuth coordinate (in degrees) of the sky element for which the angular
distance to the sun is to be calculated. If array, it should be a grid of azimuth coordinates (in degrees) of
the sky elements for which the angular distance to the sun is to be calculated; and its values should also vary along axis 1.
In any case, all values should be between 0 and 360 (inclusive).</p></li>
<li><p><strong>El</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>,</em><em>1</em><em>)</em>) – If float, it should be the elevation coordinate (in degrees) of the sky element for which the angular
distance to the sun is to be calculated. If array, it should be a grid of elevation coordinates (in degrees) of
the sky elements for which the angular distance to the sun is to be calculated; and its values should also vary along axis 0.
In any case, all values should be between 0 and 90 (inclusive).</p></li>
<li><p><strong>sun_az</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Azimuth coordinate of the sun (in degrees) across time.
Values of must lie between 0 and 360 (inclusive).</p></li>
<li><p><strong>sun_apel</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Apparent elevation coordinate of the sun (in degrees) across time.
Values of must lie between 0 and 90 (inclusive).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Zeta</strong> – Angular distance between the sun and a/all sky element(s) (in degrees)
at a time or across multiple times.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats with shape (E,A,T)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>One can</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.compute_clear_sky_index_Kc">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_clear_sky_index_Kc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Gh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ghs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.compute_clear_sky_index_Kc" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Igawa’s ‘clear sky index’ (Kc) parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Gh</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Global horizontal irradiance [W/m^2]. Values must be non-negative.</p></li>
<li><p><strong>Ghs</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Standard global irradiance [W/m^2]. Values must be non-negative.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Kc</strong> – Igawa’s ‘clear sky index’ (Kc) parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats (npoints,)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>1) Values of Kc above 1.2 are clipped down to 1.2. The reason is that
in Igawa’s 2014 paper, all values reported for Kc were at or below 1.2,
which makes me believe that a Cle of Kc is the maximum
physically-sensible value for Kc.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.compute_cloud_ratio_Ce">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_cloud_ratio_Ce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Gdh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.compute_cloud_ratio_Ce" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Igawa’s ‘cloud ratio’ (Ce) parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Gdh</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Diffuse horizontal irradiance. Values must be non-negative.</p></li>
<li><p><strong>Gh</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Global horizontal irradiance. Values must be positive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Ce</strong> – Igawa’s ‘cloud ratio’ (Ce) parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats (npoints,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.compute_cloudless_index_Cle">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_cloudless_index_Cle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ce</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ces</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.compute_cloudless_index_Cle" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Igawa’s ‘cloudless index’ (Cle) parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ce</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Igawa’s ‘cloud ratio’ (Ce) parameter. Values must be between 0 and 1.</p></li>
<li><p><strong>Ces</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Igawa’s ‘standard cloud ratio’ (Ces) parameter. Values must be between 0 and 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>CLe</strong> – Igawa’s ‘cloudless index’ (Cle) parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats (npoints,)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>Values of Cle above 1.2 are clipped down to 1.2. The reason is that
in Igawa’s 2014 paper, all values reported for Cle were at or below 1.2,
which makes me believe that a Cle of 1.2 is the maximum
physically-sensible value for Cle.</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.compute_diffuse_radiance">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_diffuse_radiance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">El</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dAz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dEl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gdh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_Gbn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_apel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_airmass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.compute_diffuse_radiance" title="Permalink to this definition">#</a></dt>
<dd><p>Compute diffuse sky radiance using Igawa’s 2014 model detailed in [1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Az</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>,</em><em>1</em><em>)</em>) – Grid of azimuth coordinates (in degrees) of the sky elements for which the
diffuse radiance is to be calculated. Its values should vary along axis 1.
In any case, all values should be between 0 and 360 (inclusive).</p></li>
<li><p><strong>El</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>,</em><em>1</em><em>)</em>) – Grid of elevation coordinates (in degrees) of the sky elements for which the
diffuse radiance is to be calculated. Its values should vary along axis 0.
In any case, all values should be between 0 and 90 (inclusive).</p></li>
<li><p><strong>dAz</strong> (<em>float</em>) – Angular resolution of <em>Az</em> in degrees.</p></li>
<li><p><strong>dEl</strong> (<em>float</em>) – Angular resolution of <em>El</em> in degrees.</p></li>
<li><p><strong>Gh</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Global horizontal irradiance [W/m^2] across time. Must be a
non-negative array of numbers.</p></li>
<li><p><strong>Gdh</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Diffuse horizontal irradiance[W/m^2] across time. Must be a non-negative
array of numbers.</p></li>
<li><p><strong>extra_Gbn</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Extraterrestrial normal irradiance [W/m^2]. Must be a non-negative
array of numbers.</p></li>
<li><p><strong>sun_apel</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Sun’s apparent elevation (in degrees) across time. Values must lie
between 0 and 90 (inclusive).</p></li>
<li><p><strong>sun_az</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Suns’s azimuth (in degrees) across time. Values must lie
between 0 and 360 (inclusive).</p></li>
<li><p><strong>rel_airmass</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Relative airmass [unitless] across time. Values must be non-negative.</p></li>
<li><p><strong>num_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of iterations to use when filling NaN data. Default is 500.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>res</strong> – Dictionary containing result variables. It has the following Key-Value
pairs:</p>
<blockquote>
<div><dl class="simple">
<dt>Siv<span class="classifier">numpy.array of floats with shape (1,1,T)</span></dt><dd><p>Igawa’s ‘Sky Index’ parameter across time.</p>
</dd>
<dt>”Kc”<span class="classifier">numpy.array of floats with shape (1,1,T)</span></dt><dd><p>Igawa’s ‘Clear Sky Index’ parameter across time.</p>
</dd>
<dt>”Cle”<span class="classifier">numpy.array of floats with shape (1,1,T)</span></dt><dd><p>Igawa’s ‘Cloudless Index’ parameter across time.</p>
</dd>
<dt>”Lea”<span class="classifier">numpy.array of floats with shape (E,A,T)</span></dt><dd><p>Diffuse sky radiance distribution [W/m^2/sr] across time.</p>
</dd>
<dt>”Le”<span class="classifier">numpy.array of floats with shape (E,A,T)</span></dt><dd><p>Relative sky radiance distribution [adm] across time.</p>
</dd>
<dt>”Lez”<span class="classifier">numpy.array of floats with shape (1,1,T)</span></dt><dd><p>Zenith radiance distribution [W/m^2/sr] across time.</p>
</dd>
<dt>”LzEd”<span class="classifier">numpy.array of floats with shape (1,1,T)</span></dt><dd><p>Inverse of the integration value of relative sky radiance
distribution.</p>
</dd>
</dl>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>This function computes ‘LzEd’ numerically. I tried using the shortcut
method proposed by the authors (i.e, the best fit constants) but the
resulting values were quite bad.</p></li>
</ol>
<p class="rubric">References</p>
<p>[1] Norio Igawa, Improving the All Sky Model for the luminance and radiance distributions of the sky,
Solar Energy, Volume 105, 2014, Pages 354-372, ISSN 0038-092X,
<a class="reference external" href="https://doi.org/10.1016/j.solener.2014.03.020">https://doi.org/10.1016/j.solener.2014.03.020</a>. (<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0038092X14001546">https://www.sciencedirect.com/science/article/pii/S0038092X14001546</a>)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.compute_improved_all_sky_model_coeffs">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_improved_all_sky_model_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coeff_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Kc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.compute_improved_all_sky_model_coeffs" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Igawa’s improved all sky model coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coeff_name</strong> (<em>{'a'</em><em>, </em><em>'b'</em><em>, </em><em>'c'</em><em>, </em><em>'d'</em><em>, </em><em>'e'}</em>) – Name of the coefficient to compute.</p></li>
<li><p><strong>Kc</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – <dl class="simple">
<dt>Igawa’s ‘clear sky index’ (Kc) parameter. Values must be</dt><dd><p>between 0 and 1.2.</p>
</dd>
</dl>
</p></li>
<li><p><strong>Cle</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Igawa’s ‘cloudless index’ (Cle) parameter. Values must be
between 0 and 1.2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>coeff_val</strong> – Value of the specified sky model coefficients.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats (npoints,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.compute_inverse_of_the_integration_value_of_relative_sky_radiance_distribution_numerically_LzEd">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_inverse_of_the_integration_value_of_relative_sky_radiance_distribution_numerically_LzEd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Le</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">El</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dAz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dEl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.compute_inverse_of_the_integration_value_of_relative_sky_radiance_distribution_numerically_LzEd" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the inverse of the integration value of relative sky radiance
distribution, according to Igawa’s 2014 paper, by numerically computing the
integral of the relative sky radiance distribution using the trapezoidal
rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Le</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>,</em><em>T</em><em>)</em>) – Unnormalized relative sky radiance distribution in W/m^2/sr,
across time. <em>Le[n,m,t]</em> holds the radiance of a sky element with
elevation specified by n, azimuth specified by m on a time specified by
t. In other words, axis 0 of <em>Le</em> takes account of the variation of
radiance across the sky with respect to elevation, axis 1 accounts for
the variation with respect to azimuth and axis 2 accounts for the
variation with respect to time. Values of <em>Le</em> must be non-negative.</p></li>
<li><p><strong>El</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>,</em><em>1</em><em>)</em>) – Grid of elevation coordinates (in degrees) of the sky elements for which
<em>LzEd</em> is to be calculated. Its values should vary along axis 0.
In any case, all values should be between 0 and 90 (inclusive).</p></li>
<li><p><strong>dAz</strong> (<em>float</em>) – Angular resolution of azimuth values in degrees.
Values must be positive.</p></li>
<li><p><strong>dEl</strong> (<em>float</em>) – Angular resolution of elevation values in degrees.
Values must be positive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>LzEd</strong> – Inverse of the integration value of relative sky radiance distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats with shape (1,1,T)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.compute_inverse_of_the_integration_value_of_relative_sky_radiance_distribution_using_constants_LzEd">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_inverse_of_the_integration_value_of_relative_sky_radiance_distribution_using_constants_LzEd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Kc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_apel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.compute_inverse_of_the_integration_value_of_relative_sky_radiance_distribution_using_constants_LzEd" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the inverse of the integration value of relative sky radiance
distribution, according to Igawa’s 2014 paper, using the non-linear
regression constants proposed by the author.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Kc</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Igawa’s ‘clear sky index’ (Kc) parameter. values must be between 0 and 1.2.</p></li>
<li><p><strong>Cle</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Igawa’s ‘cloudless index’ (Cle) parameter. values must be between 0 and 1.2.</p></li>
<li><p><strong>sun_apel</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Sun’s apparent elevation in degrees. Values must be between 0 and 90.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>LzEd</strong> – Inverse of the integration value of relative sky radiance distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats (npoints,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.compute_sky_index_Siv">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_sky_index_Siv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Kc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.compute_sky_index_Siv" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Igawa’s ‘Sky index’ (Siv) parameter used for classifying types of
sky.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Kc</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Igawa’s ‘clear sky index’ (Kc) parameter. Values must be
between 0 and 1.2.</p></li>
<li><p><strong>Cle</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Igawa’s ‘cloudless index’ (Cle) parameter. Values must be
between 0 and 1.2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Siv</strong> – Igawa’s ‘Sky index’ (Siv) parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats (npoints,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.compute_standard_cloud_ratio_Ces">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_standard_cloud_ratio_Ces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sun_apel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.compute_standard_cloud_ratio_Ces" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Igawa’s ‘standard cloud ratio’ (Ces) parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sun_apel</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Sun’s apparent elevation in degrees. Values must be between 0 and 90.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Ces</strong> – Igawa’s ‘standard cloud ratio’ (Ces) parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats (npoints,)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>1) Ces must be a number between 0 and 1. As such, any values above 1 are
clipped down to 1.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.compute_standard_global_irradiance_Ghs">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_standard_global_irradiance_Ghs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_Gbn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_airmass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.compute_standard_global_irradiance_Ghs" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Igawa’s ‘standard global irradiance’ (Ghs) parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extra_Gbn</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Extraterrestrial normal irradiance [W/m^2]. Values must be non-negative.</p></li>
<li><p><strong>rel_airmass</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> (</em><em>npoints</em><em>,</em><em>)</em>) – Relative airmass [adimensional]. Values must be positive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Ghs</strong> – Igawa’s ‘standard global irradiance’ (Ghs) parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats (npoints,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.diffusion_indicatrix_function">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">diffusion_indicatrix_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Zeta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.diffusion_indicatrix_function" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Igawa’s diffusion indicatrix function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Zeta</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>,</em><em>T</em><em>)</em>) – Angular distance between the sun and_sky element(s) (in degrees).
If a numpy.array, axis 0 and axis 1 take account of the spatial
varaition of ‘Zeta’ with respect to the Elevation and the Azimuth,
respectively, while axis 2 takes account of its temporal variation.</p></li>
<li><p><strong>c</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Igawa’s improved all sky model coefficient ‘c’.</p></li>
<li><p><strong>d</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Igawa’s improved all sky model coefficient ‘d’.</p></li>
<li><p><strong>e</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Igawa’s improved all sky model coefficient ‘e’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>diffusion_indicatrix</strong> – Values of the diffusion indicatrix at a time or across multiple times.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats with shape (E,A,T)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.diffuse_radiance_model.gradation_function">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.diffuse_radiance_model.</span></span><span class="sig-name descname"><span class="pre">gradation_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">El</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.diffuse_radiance_model.gradation_function" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Igawa’s gradation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>El</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>,</em><em>1</em><em>)</em>) – If float, it should be the elevation coordinate (in degrees) of the sky element for which the
gradation is to be calculated. If array, it should be a grid of elevation coordinates (in degrees) of
the sky elements for which the gradiation is to be calculated; and its values should also vary along axis 0.
In any case, all values should be between 0 and 90 (inclusive).</p></li>
<li><p><strong>a</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Igawa’s improved all sky model coefficient ‘a’.</p></li>
<li><p><strong>b</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Igawa’s improved all sky model coefficient ‘b’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gradation</strong> – Values of the gradation function, at a time or across multiple times.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.array of floats with shape (E,A,T)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-solrad.radiation.direct_radiance_model">
<span id="solrad-radiation-direct-radiance-model-module"></span><h2>solrad.radiation.direct_radiance_model module<a class="headerlink" href="#module-solrad.radiation.direct_radiance_model" title="Permalink to this heading">#</a></h2>
<p>This module contains all functions related to the computation of the
spatial distribution of direct/beam irradiance, also called direct/beam
radiance. This is accomplished by modelling the direct irradiance as a
point-like source of radiance, i.e, a dirac delta. However, since the the
discretization of the sky does not have infinite resolution, I implement a
procedure whereby the irradiance of a point, gets proportionately redistributed
to the nearest points which do appear in the regular grid.</p>
<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.direct_radiance_model.compute_direct_radiance">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.direct_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_direct_radiance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">El</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gbn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_apel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.direct_radiance_model.compute_direct_radiance" title="Permalink to this definition">#</a></dt>
<dd><p>Compute direct sky radiance by modelling it as dirac delta function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Az</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>,</em><em>1</em><em>)</em>) – Grid of azimuth coordinates (in degrees) of the sky elements for which the
direct radiance is to be calculated. Its values should vary along axis 1.
In any case, all values should be between 0 and 360 (inclusive).</p></li>
<li><p><strong>El</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>,</em><em>1</em><em>)</em>) – Grid of elevation coordinates (in degrees) of the sky elements for which the
direct radiance is to be calculated. Its values should vary along axis 0.
In any case, all values should be between 0 and 90 (inclusive).</p></li>
<li><p><strong>Gbn</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Direct normal irradiance [W/m^2] across time. Must be a
non-negative array of numbers.</p></li>
<li><p><strong>sun_apel</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Sun’s apparent elevation (in degrees) across time. Values must lie
between 0 and 90 (inclusive).</p></li>
<li><p><strong>sun_az</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>1</em><em>,</em><em>1</em><em>,</em><em>T</em><em>)</em>) – Suns’s azimuth (in degrees) across time. Values must lie
between 0 and 360 (inclusive).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Lea</strong> – Direct sky radiance distribution [W/m^2/sr] across time.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array of floats with shape (E,A,T)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-solrad.radiation.spectral_radiance_model">
<span id="solrad-radiation-spectral-radiance-model-module"></span><h2>solrad.radiation.spectral_radiance_model module<a class="headerlink" href="#module-solrad.radiation.spectral_radiance_model" title="Permalink to this heading">#</a></h2>
<p>This module contains all functions related to the computation of the
spatial and spectral distribution of direct and diffuse irradiance, also called
spectral radiance. This is accomplished by the combination of various models.
More specifically, one model for the spatial distribution of the diffuse component,
one model for the spatial distribution of the direct component and one model
for the spectral distribution of both components.</p>
<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.spectral_radiance_model.compute_spectral_radiance">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.spectral_radiance_model.</span></span><span class="sig-name descname"><span class="pre">compute_spectral_radiance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">El</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dAz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dEl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DatetimeIndex_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_apel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_Gbn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gbn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gdh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_airmass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H2O</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">O3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aod_500nm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_500nm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectrally_averaged_aaf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_scattering_albedo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_albedo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_surface_tilt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.spectral_radiance_model.compute_spectral_radiance" title="Permalink to this definition">#</a></dt>
<dd><p>Compute direct and diffuse components of spectral radiance across time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Az</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>)</em>) – Grid of azimuth coordinates (in degrees) of the sky elements for which the
spectral radiance is to be calculated. Its values should vary along axis 1.
In any case, all values should be between 0 and 360 (inclusive).</p></li>
<li><p><strong>El</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>E</em><em>,</em><em>A</em><em>)</em>) – Grid of elevation coordinates (in degrees) of the sky elements for which the
spectral radiance is to be calculated. Its values should vary along axis 0.
In any case, all values should be between 0 and 90 (inclusive).</p></li>
<li><p><strong>dAz</strong> (<em>float</em>) – Angular resolution of <em>Az</em> in degrees.</p></li>
<li><p><strong>dEl</strong> (<em>float</em>) – Angular resolution of <em>El</em> in degrees.</p></li>
<li><p><strong>DatetimeIndex_obj</strong> (<em>pandas.DatetimeIndex object with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – An index of Timestamp values detailing the times at which each of the
samples of the time-dependent variables were taken. We denote its
length as T.</p></li>
<li><p><strong>sun_apel</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Sun’s apparent elevation (in degrees) across time. Values must lie
between 0 and 90 (inclusive).</p></li>
<li><p><strong>sun_az</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Suns’s azimuth (in degrees) across time. Values must lie
between 0 and 360 (inclusive).</p></li>
<li><p><strong>Gh</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Global horizontal irradiance [W/m^2] across time. Must be a
non-negative array of numbers.</p></li>
<li><p><strong>extra_Gbn</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Extraterrestrial normal irradiance [W/m^2] across time. Must be a
non-negative array of numbers.</p></li>
<li><p><strong>Gbn</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Direct normal irradiance [W/m^2] across time. Must be a
non-negative array of numbers.</p></li>
<li><p><strong>Gdh</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Diffuse horizontal irradiance [W/m^2] across time. Must be a
non-negative array of numbers.</p></li>
<li><p><strong>SP</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Surface Pressure [Pa] across time.</p></li>
<li><p><strong>rel_airmass</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Relative airmass [unitless] across time.</p></li>
<li><p><strong>H2O</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Atmospheric water vapor content [cm] across time.</p></li>
<li><p><strong>O3</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Atmospheric ozone content [atm-cm] across time.</p></li>
<li><p><strong>aod_500nm</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Aerosol turbidity at 500 nm [unitless] across time.</p></li>
<li><p><strong>alpha_500nm</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Angstrom turbidity exponent at 500nm [unitless] across time.</p></li>
<li><p><strong>spectrally_averaged_aerosol_asymmetry_factor</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em>) – Average across selected range of wavelengths of the Aerosol asymmetry
factor (mean cosine of scattering angle) [unitless], across time.</p></li>
<li><p><strong>single_scattering_albedo</strong> (<em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>122</em><em>)</em>) – Aerosol single scattering albedo at multiple wavelengths. It is a matrix
of size Tx122 where the second dimension spans the wavelength range and
the first one spans the number of simulations (i.e, length of
<em>DatetimeIndex_obj</em>) [unitless].</p></li>
<li><p><strong>ground_albedo</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>122</em><em>)</em><em>, </em><em>optional</em>) – Albedo [0-1] of the ground surface. Can be provided as a scalar value
if albedo is not spectrally-dependent, or as a Tx122 matrix where
the second dimension spans the wavelength range and the first one spans
the number of simulations (i.e, length of <em>DatetimeIndex_obj</em>).
[unitless]. Default is 0.</p></li>
<li><p><strong>mean_surface_tilt</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>T</em><em>,</em><em>)</em><em>, </em><em>optional</em>) – Mean panel tilt from horizontal [degrees] across time. Default is 0.</p></li>
<li><p><strong>num_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of iterations to use when filling NaN data. Default is 500.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>res</strong> – Dictionary containing result variables. It has the following Key-Value
pairs:</p>
<blockquote>
<div><dl class="simple">
<dt>“Siv”<span class="classifier">numpy.array of floats with shape (T,)</span></dt><dd><p>Igawa’s ‘Sky Index’ parameter across time.</p>
</dd>
<dt>”Kc”<span class="classifier">numpy.array of floats with shape (T,)</span></dt><dd><p>Igawa’s ‘Clear Sky Index’ parameter across time.</p>
</dd>
<dt>”Cle”<span class="classifier">numpy.array of floats with shape (T,)</span></dt><dd><p>Igawa’s ‘Cloudless Index’ parameter across time.</p>
</dd>
<dt>”wavelengths”<span class="classifier">numpy.array of floats with shape (122,)</span></dt><dd><p>Wavelengths in nanometers.</p>
</dd>
<dt>”DatetimeIndex_obj”<span class="classifier">pandas.Series of pandas.Timestamp objects with shape (T,)</span></dt><dd><p>Series of Timestamp values detailing the times at which each of the
samples of the time-dependent variables were taken. We denote its
length as T.</p>
</dd>
<dt>”direct”<span class="classifier">List with length T of numpy.arrays of floats with shape (E,A,122)</span></dt><dd><p>Direct component of spectral radiance across time. It has units
of W/m^2/sr.</p>
</dd>
<dt>”diffuse”<span class="classifier">List with length T of numpy.arrays of floats with shape (E,A,122)</span></dt><dd><p>Diffuse component of sepctral radiance across time. It has units
of W/m^2/sr.</p>
</dd>
</dl>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p><em>mean_surface_tilt</em> variable really only affects the computation of
the spectral distribution of diffuse radiance. It has no effect on
the actual value.</p></li>
</ol>
</dd></dl>

</section>
<section id="module-solrad.radiation.spectrl2">
<span id="solrad-radiation-spectrl2-module"></span><h2>solrad.radiation.spectrl2 module<a class="headerlink" href="#module-solrad.radiation.spectrl2" title="Permalink to this heading">#</a></h2>
<p>Pvlib’s ‘spectrl2’ module that implements the Bird Simple Spectral Model.</p>
<p>This module is almost the same as that of the pvlib source:
<a class="reference external" href="https://pvlib-python.readthedocs.io/en/v0.8.1/_modules/pvlib/spectrum/spectrl2.html#spectrl2">https://pvlib-python.readthedocs.io/en/v0.8.1/_modules/pvlib/spectrum/spectrl2.html#spectrl2</a></p>
<p>However, some minor have been made to it. First, some of the comments and
descriptions were changed to better suit the standard being used in other
modules of this package. Second, the ‘spectrl2’ function was slightly altered
in order to accomodate the use of the Shettel and Fenn models (see reference [1]) for the
Aerosol Asymmetry Factor and the Single Scattering Albedo. Third, one extra
function has been added: <a class="reference internal" href="#solrad.radiation.spectrl2.compute_direct_and_diffuse_normalized_spectra" title="solrad.radiation.spectrl2.compute_direct_and_diffuse_normalized_spectra"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_direct_and_diffuse_normalized_spectra()</span></code></a> which
basically just uses spectrl2 and then normalizes the obtained irradiance spectra.
To be absolutely clear, most of this code is not mine (just the changes
mentioned above) and was taken from the source mentioned above. Credit for the
spctrl2 implementation belongs to them.</p>
<p class="rubric">References</p>
<p>[1] Shettle, Eric &amp; Fenn, Robert. (1979). Models for the Aerosols of the Lower
Atmosphere and the Effects of Humidity Variations on their Optical Properties. Environ. Res.. 94.</p>
<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.spectrl2.compute_direct_and_diffuse_normalized_spectra">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.spectrl2.</span></span><span class="sig-name descname"><span class="pre">compute_direct_and_diffuse_normalized_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sun_apzen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_airmass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H2O</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">O3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aod_500nm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_500nm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_scattering_albedo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectrally_averaged_aaf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_albedo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_surface_tilt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dayofyear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.spectrl2.compute_direct_and_diffuse_normalized_spectra" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate spectral irradiance using the Bird Simple Spectral Model
(pvlib’s SPECTRL2) and then return the normalized spectra for direct/beam
and diffuse irradiance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sun_apzen</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em><em> of </em><em>length N</em>) – Solar zenith angle of the sun [degrees].</p></li>
<li><p><strong>SP</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em><em> of </em><em>length N</em>) – Surface Pressure [Pa]. If it is a pandas.Series, it should have the same index as
<em>apzen</em>.</p></li>
<li><p><strong>rel_airmass</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em><em> of </em><em>length N</em>) – Relative airmass [unitless]. If it is a pandas.Series, it should have the same
index as <em>apzen</em>.</p></li>
<li><p><strong>H2O</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em><em> of </em><em>length N</em>) – Atmospheric water vapor content [cm]. If it is a pandas.Series,
it should have the same index as <em>apzen</em>.</p></li>
<li><p><strong>O3</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em><em> of </em><em>length N</em>) – Atmospheric ozone content [atm-cm]. If it is a pandas.Series,
it should have the same index as <em>apzen</em>.</p></li>
<li><p><strong>aod_500nm</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em><em> of </em><em>length N</em>) – Aerosol turbidity at 500 nm [unitless]. If it is a pandas.Series,
it should have the same index as <em>apzen</em>.</p></li>
<li><p><strong>alpha_500nm</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em><em> of </em><em>length N</em>) – Angstrom turbidity exponent at 500nm [unitless]. If it is a pandas.Series,
it should have the same index as <em>apzen</em>.</p></li>
<li><p><strong>single_scattering_albedo</strong> (<em>2D-numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>N</em><em>,</em><em>122</em><em>)</em>) – Aerosol single scattering albedo at multiple wavelengths. It is matrix
of size Nx122 where the second dimension spans the wavelength range and
the first one spans the number of simulations (i.e, length of
<em>apzen</em>) [unitless].</p></li>
<li><p><strong>spectrally_averaged_aerosol_asymmetry_factor</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em><em> of </em><em>length N</em>) – Average across selected range of wavelengths of the Aerosol asymmetry
factor (mean cosine of scattering angle) [unitless]. If it is a pandas.Series,
it should have the same index as <em>apzen</em>.</p></li>
<li><p><strong>ground_albedo</strong> (<em>float</em><em> or </em><em>2D-numpy.array</em><em> of </em><em>floats with shape</em><em> (</em><em>N</em><em>,</em><em>122</em><em>)</em>) – Albedo [0-1] of the ground surface. Can be provided as a scalar value
if albedo is not spectrally-dependent, or as a Nx122 matrix where
the second dimension spans the wavelength range and the first one spans
the number of simulations (i.e, length of <em>apzen</em>).
[unitless]. Default is 0.</p></li>
<li><p><strong>mean_surface_tilt</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em><em> of </em><em>length N</em>) – Mean panel tilt from horizontal [degrees]. IIf it is a pandas.Series,
it should have the same index as <em>apzen</em>.</p></li>
<li><p><strong>dayofyear</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em> of </em><em>length N</em><em>, </em><em>optional.</em>) – The day of year [1-365].  Must be provided if <cite>apzen</cite> is
not a pandas Series. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>res</strong> – Dictionary containing result variables. It has the following Key-Value
pairs:</p>
<blockquote>
<div><dl class="simple">
<dt>“direct”<span class="classifier">numpy.array of floats with shape (122,) or 2D numpy.array of floats with (N, 122)</span></dt><dd><p>Normalized spectrum of direct/beam irradiance. The shape of the output
depends on the shape of the inputs. If <em>apzen</em> is a single value,
<em>res[“direct”]</em> will have shape (122,). Else, it will have shape
(N, 122) where N is the length of <em>apzen</em>. The 122 makes reference to
the number of wavelengths at which the results are given.</p>
</dd>
<dt>”diffuse”<span class="classifier">numpy.array of floats with shape (122,) or 2D numpy.array of floats with (N, 122)</span></dt><dd><p>Normalized spectrum of diffuse irradiance. The shape of the output
depends on the shape of the inputs. If <em>apzen</em> is a single value,
<em>res[“diffuse”]</em> will have shape (122,). Else, it will have shape
(N, 122) where N is the length of <em>apzen</em>. The 122 makes reference to
the number of wavelengths at which the results are given.</p>
</dd>
<dt>”wavelengths”<span class="classifier">numpy.array of floats with shape (122,)</span></dt><dd><p>Wavelengths in nanometers, at which the normalized spectra are
given.</p>
</dd>
</dl>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>1</strong><strong>) </strong><strong>TypeError :</strong> – The following TypeError was raised: ‘loop of ufunc does not support argument 0 of type
    float which has no callable exp method’. This usually happens when <em>single_scattering_albedo</em>
    is not an numpy.array of floats. Attempt to pass <code class="docutils literal notranslate"><span class="pre">numpy.array(single_scattering_albedo).astype(float)</span></code> instead.”</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>The <em>mean_surface_tilt</em> argument really only affects the computation of
the spectral distribution of diffuse radiance. It has no effect on
the actual value.</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solrad.radiation.spectrl2.spectrl2">
<span class="sig-prename descclassname"><span class="pre">solrad.radiation.spectrl2.</span></span><span class="sig-name descname"><span class="pre">spectrl2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apparent_zenith</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aoi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_tilt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_albedo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_airmass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precipitable_water</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ozone</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aerosol_turbidity_500nm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scattering_albedo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectrally_averaged_aerosol_asymmetry_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dayofyear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#solrad.radiation.spectrl2.spectrl2" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate spectral irradiance using the Bird Simple Spectral Model
(SPECTRL2).</p>
<p>The Bird Simple Spectral Model <a href="#id1"><span class="problematic" id="id1">[1]_</span></a> produces terrestrial spectra between
300 and 4000 nm with a resolution of approximately 10 nm. Direct and
diffuse spectral irradiance are modeled for horizontal and tilted surfaces
under cloudless skies. SPECTRL2 models radiative transmission, absorption,
and scattering due to atmospheric aerosol, water vapor, and ozone content.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>apparent_zenith</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em>) – Solar zenith angle  of the sun [degrees].</p></li>
<li><p><strong>aoi</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em>) – Angle of incidence of the solar vector on the panel [degrees]. If it
is a numpy.array or a pandas.Series, it must be the same length as
‘apparent_zenith’ and, additionally, if it is a pandas.Series, it
should have the same index as ‘apparent_zenith’.</p></li>
<li><p><strong>surface_tilt</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em>) – Panel tilt from horizontal [degrees]. If it is a numpy.array or a
pandas.Series, it must be the same length as ‘apparent_zenith’ and,
additionally, if it is a pandas.Series, it should have the same index
as ‘apparent_zenith’.</p></li>
<li><p><strong>ground_albedo</strong> (<em>float</em><em> or </em><em>2D-numpy.array</em><em> of </em><em>floats</em>) – Albedo [0-1] of the ground surface. Can be provided as a scalar value
if albedo is not spectrally-dependent, or as a 122xN matrix where
the first dimension spans the wavelength range and the second one spans
the number of simulations (i.e, length of ‘apparent zenith’)
[unitless].</p></li>
<li><p><strong>surface_pressure</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em>) – Surface pressure [Pa]. If it is a numpy.array or a pandas.Series,
it must be the same length as ‘apparent_zenith’ and, additionally, if
it is a pandas.Series, it should have the same index as
‘apparent_zenith’.</p></li>
<li><p><strong>relative_airmass</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em>) – Relative airmass [unitless]. If it is a numpy.array or a pandas.Series,
it must be the same length as ‘apparent_zenith’ and, additionally, if
it is a pandas.Series, it should have the same index as
‘apparent_zenith’.</p></li>
<li><p><strong>precipitable_water</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em>) – Atmospheric water vapor content [cm]. If it is a numpy.array or a
pandas.Series, it must be the same length as ‘apparent_zenith’ and,
additionally, if it is a pandas.Series, it should have the same index
as ‘apparent_zenith’.</p></li>
<li><p><strong>ozone</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em>) – Atmospheric ozone content [atm-cm]. If it is a numpy.array or a
pandas.Series, it must be the same length as ‘apparent_zenith’ and,
additionally, if it is a pandas.Series, it should have the same index
as ‘apparent_zenith’.</p></li>
<li><p><strong>aerosol_turbidity_500nm</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em>) – Aerosol turbidity at 500 nm [unitless]. If it is a numpy.array or a
pandas.Series, it must be the same length as ‘apparent_zenith’ and,
additionally, if it is a pandas.Series, it should have the same index
as ‘apparent_zenith’.</p></li>
<li><p><strong>scattering_albedo</strong> (<em>2D-numpy.array</em><em> of </em><em>floats</em>) – Aerosol single scattering albedo at multiple wavelengths. It is matrix
of size Nx122 where the second dimension spans the wavelength range and
the  first one spans the number of simulations (i.e, length of
‘apparent zenith’) [unitless]. That is, it should be a matrix
of size matrix.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em>) – Angstrom turbidity exponent at 500nm [unitless]. If it is a numpy.array or a
pandas.Series, it must be the same length as ‘apparent_zenith’ and,
additionally, if it is a pandas.Series, it should have the same index
as ‘apparent_zenith’.</p></li>
<li><p><strong>spectrally_averaged_aerosol_asymmetry_factor</strong> (<em>float</em><em>, </em><em>numpy.array</em><em> of </em><em>floats</em><em> or </em><em>pandas.Series</em><em> of </em><em>floats</em>) – Average across selected range of wavelengths of the Aerosol asymmetry
factor (mean cosine of scattering angle) [unitless]. If it is a
numpy.array or a pandas.Series, it must be the same length as
‘apparent_zenith’ and, additionally, if it is a pandas.Series,
it should have the same index as ‘apparent_zenith’.</p></li>
<li><p><strong>dayofyear</strong> (<em>float</em><em> or </em><em>numpy.array</em><em> of </em><em>floats</em><em>, </em><em>optional.</em>) – The day of year [1-365].  Must be provided if <cite>apparent_zenith</cite> is
not a pandas Series.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>spectra</strong> – A dict of arrays.  With the exception of <cite>wavelength</cite>, which has length
122, each array has shape (122, N) where N is the length of the
input <code class="docutils literal notranslate"><span class="pre">apparent_zenith</span></code>.  All values are spectral irradiance
with units W/m^2/nm except for <cite>wavelength</cite>, which is in nanometers.</p>
<blockquote>
<div><ul class="simple">
<li><p>wavelength         : Wavelengths in nanometers.</p></li>
<li><p>dni_extra          : Direct normal extraterrestrial solar spectrum.</p></li>
<li><p>dhi                : Diffuse horizontal irradiance.</p></li>
<li><p>dni                : Direct normal irradiance.</p></li>
<li><p>poa_sky_diffuse    : Diffuse irradiance from the sky on a tilted surface.</p></li>
<li><p>poa_ground_diffuse : Diffuse irradiance from the ground reflections on a tilted surface.</p></li>
<li><p>poa_direct         : Direct irradiance on tilted surface.</p></li>
<li><p>poa_global         : Global irradiance on a tilted surface.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>NREL’s C implementation <code class="docutils literal notranslate"><span class="pre">spectrl2_2.c</span></code> <a href="#id2"><span class="problematic" id="id2">[2]_</span></a> of the model differs in
several ways from the original report <a href="#id3"><span class="problematic" id="id3">[1]_</span></a>.  The report itself also has
a few differences between the in-text equations and the code appendix.
The list of known differences is shown below.  Note that this
implementation follows <code class="docutils literal notranslate"><span class="pre">spectrl2_2.c</span></code>.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Equation</p></th>
<th class="head"><p>Report</p></th>
<th class="head"><p>Appendix</p></th>
<th class="head"><p>spectrl2_2.c</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2-4</p></td>
<td><p>1.335</p></td>
<td><p>1.335</p></td>
<td><p>1.3366</p></td>
</tr>
<tr class="row-odd"><td><p>2-11</p></td>
<td><p>118.93</p></td>
<td><p>118.93</p></td>
<td><p>118.3</p></td>
</tr>
<tr class="row-even"><td><p>3-8</p></td>
<td><p>To’</p></td>
<td><p>Tu’</p></td>
<td><p>Tu’</p></td>
</tr>
<tr class="row-odd"><td><p>3-5, 3-6, 3-7, 3-1</p></td>
<td><p>double Cs</p></td>
<td><p>single Cs</p></td>
<td><p>single Cs</p></td>
</tr>
<tr class="row-even"><td><p>2-5</p></td>
<td><p>kasten1966</p></td>
<td><p>kasten1966</p></td>
<td><p>kastenyoung1989</p></td>
</tr>
</tbody>
</table>
</div>
<p>This implementation also deviates from the reference by including a
check for angles of incidence greater than 90 degrees; without this,
the model might return negative spectral irradiance values when the
sun is behind the plane of array.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Bird, R, and Riordan, C., 1984, “Simple solar spectral model for
direct and diffuse irradiance on horizontal and tilted planes at the
earth’s surface for cloudless atmospheres”, NREL Technical Report
TR-215-2436 doi:10.2172/5986936.</p>
</aside>
<aside class="footnote brackets" id="id5" role="note">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Bird Simple Spectral Model: spectrl2_2.c.
<a class="reference external" href="https://www.nrel.gov/grid/solar-resource/spectral.html">https://www.nrel.gov/grid/solar-resource/spectral.html</a></p>
</aside>
</aside>
</dd></dl>

</section>
<section id="module-solrad.radiation">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-solrad.radiation" title="Permalink to this heading">#</a></h2>
<hr class="footnotes docutils" />
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="solrad.sun.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">solrad.sun package</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="solrad.climate.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">solrad.climate package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Andrés Yesid Moreno Villa
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">solrad.radiation package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-solrad.radiation.diffuse_radiance_model">solrad.radiation.diffuse_radiance_model module</a><ul>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.compute_angular_distance_between_sun_and_sky_element_Zeta"><code class="docutils literal notranslate"><span class="pre">compute_angular_distance_between_sun_and_sky_element_Zeta()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.compute_clear_sky_index_Kc"><code class="docutils literal notranslate"><span class="pre">compute_clear_sky_index_Kc()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.compute_cloud_ratio_Ce"><code class="docutils literal notranslate"><span class="pre">compute_cloud_ratio_Ce()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.compute_cloudless_index_Cle"><code class="docutils literal notranslate"><span class="pre">compute_cloudless_index_Cle()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.compute_diffuse_radiance"><code class="docutils literal notranslate"><span class="pre">compute_diffuse_radiance()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.compute_improved_all_sky_model_coeffs"><code class="docutils literal notranslate"><span class="pre">compute_improved_all_sky_model_coeffs()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.compute_inverse_of_the_integration_value_of_relative_sky_radiance_distribution_numerically_LzEd"><code class="docutils literal notranslate"><span class="pre">compute_inverse_of_the_integration_value_of_relative_sky_radiance_distribution_numerically_LzEd()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.compute_inverse_of_the_integration_value_of_relative_sky_radiance_distribution_using_constants_LzEd"><code class="docutils literal notranslate"><span class="pre">compute_inverse_of_the_integration_value_of_relative_sky_radiance_distribution_using_constants_LzEd()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.compute_sky_index_Siv"><code class="docutils literal notranslate"><span class="pre">compute_sky_index_Siv()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.compute_standard_cloud_ratio_Ces"><code class="docutils literal notranslate"><span class="pre">compute_standard_cloud_ratio_Ces()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.compute_standard_global_irradiance_Ghs"><code class="docutils literal notranslate"><span class="pre">compute_standard_global_irradiance_Ghs()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.diffusion_indicatrix_function"><code class="docutils literal notranslate"><span class="pre">diffusion_indicatrix_function()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.diffuse_radiance_model.gradation_function"><code class="docutils literal notranslate"><span class="pre">gradation_function()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-solrad.radiation.direct_radiance_model">solrad.radiation.direct_radiance_model module</a><ul>
<li><a class="reference internal" href="#solrad.radiation.direct_radiance_model.compute_direct_radiance"><code class="docutils literal notranslate"><span class="pre">compute_direct_radiance()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-solrad.radiation.spectral_radiance_model">solrad.radiation.spectral_radiance_model module</a><ul>
<li><a class="reference internal" href="#solrad.radiation.spectral_radiance_model.compute_spectral_radiance"><code class="docutils literal notranslate"><span class="pre">compute_spectral_radiance()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-solrad.radiation.spectrl2">solrad.radiation.spectrl2 module</a><ul>
<li><a class="reference internal" href="#solrad.radiation.spectrl2.compute_direct_and_diffuse_normalized_spectra"><code class="docutils literal notranslate"><span class="pre">compute_direct_and_diffuse_normalized_spectra()</span></code></a></li>
<li><a class="reference internal" href="#solrad.radiation.spectrl2.spectrl2"><code class="docutils literal notranslate"><span class="pre">spectrl2()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-solrad.radiation">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>