"use strict";(self.webpackChunklino_react=self.webpackChunklino_react||[]).push([[395],{7038:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LinoBbar:()=>LinoBbar,name:()=>name});var _LinoBbar_css__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4989),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(537),prop_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9761),prop_types__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_4__),_Base__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9281),_Base__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_Base__WEBPACK_IMPORTED_MODULE_2__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(683);const name="LinoBbar";let ex;const exModulePromises=ex={_:__webpack_require__.e(2844).then(__webpack_require__.t.bind(__webpack_require__,8289,23)),prButton:Promise.all([__webpack_require__.e(7353),__webpack_require__.e(5155),__webpack_require__.e(9961),__webpack_require__.e(3081),__webpack_require__.e(9749),__webpack_require__.e(968)]).then(__webpack_require__.bind(__webpack_require__,7215)),prSplitButton:Promise.all([__webpack_require__.e(9880),__webpack_require__.e(7353),__webpack_require__.e(5155),__webpack_require__.e(9961),__webpack_require__.e(3081),__webpack_require__.e(5894),__webpack_require__.e(9749),__webpack_require__.e(5419)]).then(__webpack_require__.bind(__webpack_require__,1333))};(0,_Base__WEBPACK_IMPORTED_MODULE_2__.RegisterImportPool)(ex);class LinoBbar extends _Base__WEBPACK_IMPORTED_MODULE_2__.Component{constructor(e){super(e),this.state={...this.state,overflowShow:!1},this.action2buttonProps=this.action2buttonProps.bind(this),this.render_buttons=this.render_buttons.bind(this),this.render_overflow=this.render_overflow.bind(this),this.render_actionbutton=this.render_actionbutton.bind(this),this.render_splitActionButton=this.render_splitActionButton.bind(this),this.runAction=this.runAction.bind(this)}runAction(action,tba,event){if(tba.js_handler)return void eval(tba.js_handler);let runnable={an:action.an,actorId:this.context.static.actorData.id};action.hasOwnProperty("actor")&&(runnable.actorId=action.actor),action.select_rows&&(runnable.sr=this.context.sr),event.ctrlKey&&(runnable.clickCatch=!0),this.context.controller.actionHandler.checkAndRunAction(runnable)}render_overflow(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(this.ex.prButton.Button,{icon:"pi pi-ellipsis-v",onClick:this.setState({overflowShow:!this.state.overflowShow})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{})]})}action2buttonProps(e,t,n){let s={label:t.label};return t.icon?(s.icon=t.icon,s.label=n?void 0:s.label):t.button_text&&(s.label=t.button_text),s.disabled=t.select_rows&&this.context.sr&&0===this.context.sr.length||this.context.controller.disabled(t.an)||"submit_detail"===t.an&&!this.context.editing_mode||this.props.onSide&&!t.show_in_side_toolbar&&"submit_detail"!==t.an||this.props.nonCollapsibles&&!t.never_collapse,s.tooltip=e.help_text||t.label,s.tooltipOptions={position:this.props.onSide?"left":"bottom"},s}render_actionbutton(e){let{action:t}=this.context.controller.actionHandler.getAction(e.an,!1);if(t){let n=this.action2buttonProps(e,t,!0);if(n.disabled)return;return(0,react__WEBPACK_IMPORTED_MODULE_1__.createElement)(this.ex.prButton.Button,{...n,key:Math.random(),onClick:n=>this.runAction(t,e,n)})}}render_splitActionButton(e){let t=e.menu.map((e=>this.context.controller.actionHandler.getAction(e.an,!1).action));if(t[0]){let n=t.map(((t,n)=>{let s=this.action2buttonProps(e.menu[n],t,0===n);return s.command=s=>this.runAction(t,e.menu[n],s),s})),s=this.ex._.default.cloneDeep(n[0]);if(s.disabled)return;let i=s.command;return delete s.command,(0,react__WEBPACK_IMPORTED_MODULE_1__.createElement)(this.ex.prSplitButton.SplitButton,{...s,key:Math.random(),model:n,onClick:i})}}render_buttons(){let e=this.context.static.actorData.actions_list.find((e=>e.an===this.props.an));if(!e)return;let t=e.toolbarActions;return t&&t.map(((e,t)=>e.combo?this.render_splitActionButton(e):this.render_actionbutton(e)))}render(){return this.state.ready?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment,{children:[this.props.resetable&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(this.ex.prButton.Button,{icon:"pi pi-refresh",onClick:e=>this.context.controller.actionHandler.reload(),tooltip:"Reload this view from the underlying database",tooltipOptions:{position:"bottom"}}),this.render_buttons()]}):null}}LinoBbar.requiredModules=["prButton","prSplitButton","_"],LinoBbar.iPool=ex,LinoBbar.contextType=_Base__WEBPACK_IMPORTED_MODULE_2__.URLContextType,LinoBbar.propTypes={an:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string.isRequired,nonCollapsibles:prop_types__WEBPACK_IMPORTED_MODULE_4___default().bool,onSide:prop_types__WEBPACK_IMPORTED_MODULE_4___default().bool,resetable:prop_types__WEBPACK_IMPORTED_MODULE_4___default().bool},LinoBbar.defaultProps={nonCollapsibles:!1,onSide:!1,resetable:!0}},1562:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{N:()=>DialogFactory});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(537),prop_types__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(9761),prop_types__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_6__),_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(50),_Base__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9281),_Base__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_Base__WEBPACK_IMPORTED_MODULE_2__),_SiteContext__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2985),_LinoBbar__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7038),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(683);const name="LinoDialog";let ex;const exModulePromises=ex={queryString:Promise.all([__webpack_require__.e(1473),__webpack_require__.e(6521)]).then(__webpack_require__.bind(__webpack_require__,5876)),prButton:Promise.all([__webpack_require__.e(7353),__webpack_require__.e(5155),__webpack_require__.e(9961),__webpack_require__.e(3081),__webpack_require__.e(9749),__webpack_require__.e(968)]).then(__webpack_require__.bind(__webpack_require__,7215)),prDialog:Promise.all([__webpack_require__.e(9880),__webpack_require__.e(5155),__webpack_require__.e(9961),__webpack_require__.e(5894),__webpack_require__.e(5092),__webpack_require__.e(9371)]).then(__webpack_require__.bind(__webpack_require__,9133)),u:Promise.resolve().then(__webpack_require__.bind(__webpack_require__,6367)),lc:Promise.all([__webpack_require__.e(1295),__webpack_require__.e(3486),__webpack_require__.e(1473),__webpack_require__.e(7353),__webpack_require__.e(6125),__webpack_require__.e(5155),__webpack_require__.e(9961),__webpack_require__.e(3081),__webpack_require__.e(5894),__webpack_require__.e(9749),__webpack_require__.e(4087),__webpack_require__.e(2847),__webpack_require__.e(5997),__webpack_require__.e(9158),__webpack_require__.e(6622)]).then(__webpack_require__.bind(__webpack_require__,7170)),lwc:Promise.all([__webpack_require__.e(7353),__webpack_require__.e(5155),__webpack_require__.e(9961),__webpack_require__.e(3081),__webpack_require__.e(9749),__webpack_require__.e(6130)]).then(__webpack_require__.t.bind(__webpack_require__,2671,23))};(0,_Base__WEBPACK_IMPORTED_MODULE_2__.RegisterImportPool)(ex);class DialogFactory extends _Base__WEBPACK_IMPORTED_MODULE_2__.Component{constructor(e){super(e),this.state={...this.state,children:new Map,callbacks:new Map},this.dialogRefs={},this.create=this.create.bind(this),this.createCallback=this.createCallback.bind(this),this.remove=this.remove.bind(this),this.removeCallback=this.removeCallback.bind(this)}async create(e,t){let n=!(e.context.value.static.actorData&&e.context.value.static.actorData.id===t.actorId),s={factory:this,id:e.context.newSlug().toString(),unknownActor:n},i={},o=`api/${t.actorId.split(".").join("/")}`;i.params={action_dialog:"insert"!==t.action.an,[_constants__WEBPACK_IMPORTED_MODULE_1__.URL_PARAM_DISPLAY_MODE]:_constants__WEBPACK_IMPORTED_MODULE_1__.DISPLAY_MODE_DETAIL,[_constants__WEBPACK_IMPORTED_MODULE_1__.URL_PARAM_WINDOW_TYPE]:_constants__WEBPACK_IMPORTED_MODULE_1__.WINDOW_TYPE_DETAIL,an:t.action.an},i.params.action_dialog||(i.params[_constants__WEBPACK_IMPORTED_MODULE_1__.URL_PARAM_WINDOW_TYPE]=_constants__WEBPACK_IMPORTED_MODULE_1__.WINDOW_TYPE_INSERT),i.status=t.status||{},i.parentContext=e.context,n?i.path=`/${o}`:(i.inherit=!0,s.contextController=e.context),s.urlContextProps=i;let r={executeArgs:t},a={data:{disabled_fields:{}}},_=t.status;if(_&&("verify"===t.action.an?Object.assign(a.data,{email:this.APP.state.user_settings.email,verification_code:""}):_.data_record?a=_.data_record:_.field_values&&Object.assign(a.data,_.field_values)),"insert"===t.action.an){if(!_||!_.data_record){this.props.APP.setLoadMask();let s=n?{...t.preprocessedStack}:e.defaultStaticParams();Object.assign(s,{fmt:"json"}),a=await e.silentFetch({path:`${o}/-99999?${this.ex.queryString.default.stringify(s)}`}),this.props.APP.unsetLoadMask()}i.params.sr=[-99999],i.params[_constants__WEBPACK_IMPORTED_MODULE_1__.URL_PARAM_WINDOW_TYPE]=_constants__WEBPACK_IMPORTED_MODULE_1__.WINDOW_TYPE_INSERT}a.title||(a.title=a.data.title||t.action.label),r.data=a,this.state.children.set(s.id,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(DialogContext,{...s,ref:e=>this.dialogRefs[s.id]=e,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(LinoDialog,{...r})},s.id)),this.setState({}),t.preprocessedStack.callback&&"postWindowInit"===t.preprocessedStack.callback.callbackType&&t.preprocessedStack.callback.callback(s.id)}createWebcamDialog(e,t,n){const s=e.newSlug().toString();this.state.children.set(s,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(LinoWebCamDialog,{factory:this,holderId:n,id:s,preprocessedStack:t},s)),this.setState({})}createCallback(e={}){e.factory=this,this.state.callbacks.set(e.id,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(LinoCallbackDialog,{...e},e.id)),this.setState({})}remove(e){this.state.children.delete(e),delete this.dialogRefs[e],this.setState({})}removeCallback(e){this.state.callbacks.delete(e),this.setState({})}render(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[Array.from(this.state.children.values()),Array.from(this.state.callbacks.values())]})}}function onKeyDown(e,t=!1){return n=>{if(n.stopPropagation(),(n.ctrlKey||n.metaKey)&&83===n.keyCode)t||e.context.action_dialog||(n.preventDefault(),n.stopPropagation(),e.context.controller.actionHandler.submit({}));else if(13===n.keyCode){let t=e.dialogRef.current.getFooter().getElementsByClassName("l-confirm-yes")[0];t&&t.click()}else if(27===n.keyCode){let t=e.dialogRef.current.getFooter().getElementsByClassName("l-confirm-no")[0];t&&t.click()}}}function ConfirmButtons(e){const t=(0,_Base__WEBPACK_IMPORTED_MODULE_2__.getExReady)(ex,["prButton"]);return t.ready?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(t.prButton.Button,{className:"l-confirm-yes",label:e.agreeLabel,onClick:e.agree}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(t.prButton.Button,{className:"l-confirm-no",label:e.disagreeLabel,onClick:e.disagree})]}):null}DialogFactory.requiredModules=["queryString","u"],DialogFactory.iPool=ex,DialogFactory.propTypes={APP:prop_types__WEBPACK_IMPORTED_MODULE_6___default().object.isRequired},ConfirmButtons.propTypes={agree:prop_types__WEBPACK_IMPORTED_MODULE_6___default().func.isRequired,agreeLabel:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string,disagree:prop_types__WEBPACK_IMPORTED_MODULE_6___default().func.isRequired,disagreeLabel:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string},ConfirmButtons.defaultProps={agreeLabel:"OK",disagreeLabel:"Cancel"};class DialogContext extends react__WEBPACK_IMPORTED_MODULE_0__.Component{attachContextRoot(e){e&&(this.dialog=e,e.root=this)}render(){let e=react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(this.props.children,{ref:e=>this.attachContextRoot(e)});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_SiteContext__WEBPACK_IMPORTED_MODULE_3__.URLContext,{...this.props.urlContextProps,simple:!0,children:e})}}function LinoWebCamDialog(e){const[t,n]=react__WEBPACK_IMPORTED_MODULE_0__.useState(!1),s=(0,_Base__WEBPACK_IMPORTED_MODULE_2__.getExReady)(ex,["prDialog","lwc"],(t=>{const s=()=>{e.holderId in e.factory.dialogRefs&&e.factory.dialogRefs[e.holderId].dialog&&e.factory.dialogRefs[e.holderId].dialog.dialogRef.current?n(!0):setTimeout(s,100)};return s(),t})),[i,o]=react__WEBPACK_IMPORTED_MODULE_0__.useState({height:null,width:null}),r=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((t=>{e.preprocessedStack.image=t;const n=e.factory.dialogRefs[e.holderId].dialog,s=n.dialogRef.current.getContent().offsetWidth;let i=`<img src="${t}" style="max-width: ${Math.round(.9*s)}px; display: block; margin: auto; max-height: 50vh;"/>`;n.setState({beforeContent:i}),e.factory.remove(e.id)}));return t?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(s.prDialog.Dialog,{closable:!0,closeOnEscape:!0,draggable:!1,header:"Capture Image",maximizable:!1,maximized:!0,modal:!0,onHide:t=>e.factory.remove(e.id),resizable:!1,visible:!0,children:null===i.height?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{ref:e=>{e&&o({height:e.parentElement.offsetHeight,width:e.parentElement.offsetWidth})}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"vertical-center",style:{textAlign:"center"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(s.lwc.LinoWebCam,{captureDone:r,height:Math.round(.9*i.height),width:Math.round(.9*i.width)})})}):null}function LinoCallbackDialog(props){const dialogRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef(),localEx=(0,_Base__WEBPACK_IMPORTED_MODULE_2__.getExReady)(ex,["prButton","prDialog"]);return localEx.ready?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{onKeyDown:onKeyDown({dialogRef},!0),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(localEx.prDialog.Dialog,{closable:!1,closeOnEscape:!1,footer:props.simple?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ConfirmButtons,{agree:props.agree,disagree:props.disagree}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:props.xcallback.buttons.map((button=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(localEx.prButton.Button,{className:`p-button-secondary l-confirm-${button[0]}`,label:button[1],onClick:()=>{props.factory.removeCallback(props.id),eval(props.xcallback[button[0]+"_resendEvalJs"])}},button[0])))}),header:props.title,maximizable:!0,modal:!0,onHide:e=>props.factory.removeCallback(props.id),ref:dialogRef,visible:!0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{dangerouslySetInnerHTML:{__html:props.message},ref:e=>{e&&e.focus()},tabIndex:0})})}):null}DialogContext.propTypes={children:prop_types__WEBPACK_IMPORTED_MODULE_6___default().element.isRequired,factory:prop_types__WEBPACK_IMPORTED_MODULE_6___default().instanceOf(DialogFactory).isRequired,id:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string.isRequired,unknownActor:prop_types__WEBPACK_IMPORTED_MODULE_6___default().bool,urlContextProps:prop_types__WEBPACK_IMPORTED_MODULE_6___default().object.isRequired},DialogContext.defaultProps={unknownActor:!1},LinoWebCamDialog.propTypes={factory:prop_types__WEBPACK_IMPORTED_MODULE_6___default().instanceOf(DialogFactory).isRequired,holderId:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string.isRequired,id:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string.isRequired,preprocessedStack:prop_types__WEBPACK_IMPORTED_MODULE_6___default().object.isRequired},LinoCallbackDialog.propTypes={agree:(e,...t)=>{if(e.simple)return prop_types__WEBPACK_IMPORTED_MODULE_6___default().func.isRequired(e,...t)},disagree:(e,...t)=>{if(e.simple)return prop_types__WEBPACK_IMPORTED_MODULE_6___default().func.isRequired(e,...t)},factory:prop_types__WEBPACK_IMPORTED_MODULE_6___default().instanceOf(DialogFactory).isRequired,id:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string.isRequired,message:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string.isRequired,simple:prop_types__WEBPACK_IMPORTED_MODULE_6___default().bool,title:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string.isRequired,xcallback:(e,...t)=>{if(!e.simple)return prop_types__WEBPACK_IMPORTED_MODULE_6___default().object.isRequired(e,...t)}},LinoCallbackDialog.defaultProps={simple:!1};class LinoDialog extends _Base__WEBPACK_IMPORTED_MODULE_2__.Component{constructor(e){super(e),this.state={...this.state,actionMeta:null,afterContent:e.afterContent,beforeContent:e.beforeContent,context:null},this.dialogRef=react__WEBPACK_IMPORTED_MODULE_0__.createRef(),this.close=this.close.bind(this),this.forceClose=this.forceClose.bind(this),this.ok=this.ok.bind(this),this.renderDialogStyle=this.renderDialogStyle.bind(this),this.renderDialogContentStyle=this.renderDialogContentStyle.bind(this)}async prepare(){this.DataContext=new _SiteContext__WEBPACK_IMPORTED_MODULE_3__.DataContext({root:this,context:this.props.data,next:e=>{this.state.context=e.mutableContext;let t=this.context.controller;t.contextType=_constants__WEBPACK_IMPORTED_MODULE_1__.CONTEXT_TYPE_ACTION,t.attachDataContext(this.DataContext);let n={...this.context.static.actorData.actions_list.find((e=>e.an===this.props.executeArgs.action.an))};n.windowSize=this.context.controller.APP.state.site_data.form_panels[n.window_layout].window_size,this.setState({actionMeta:n})}})}forceClose(){this.root.props.factory.remove(this.root.props.id)}close(e){this.context.controller.isModified()?this.context.controller.actionHandler.discardModDConfirm({agree:e=>this.root.props.factory.remove(this.root.props.id)}):this.root.props.factory.remove(this.root.props.id)}ok(){this.context.controller.actionHandler.executeAction(this.props.executeArgs)}renderDialogContentStyle(e){return e&&e[1]&&"auto"!==e[1]?{height:3*e[1]+"ch"}:{}}renderDialogStyle(e){return e&&e[0]?{width:Math.floor(1.5*e[0])+"ch"}:{}}render(){return this.state.ready?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_SiteContext__WEBPACK_IMPORTED_MODULE_3__.DataContext.Context.Provider,{value:this.state.context,children:null!==this.state.actionMeta&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{onKeyDown:onKeyDown(this),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(this.ex.prDialog.Dialog,{closable:this.props.closable,closeOnEscape:this.props.closeOnEscape,contentStyle:this.renderDialogContentStyle(this.state.actionMeta.windowSize),footer:this.context.action_dialog?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ConfirmButtons,{agree:this.ok,disagree:this.close}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"l-bbar",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_LinoBbar__WEBPACK_IMPORTED_MODULE_4__.LinoBbar,{an:this.props.executeArgs.action.an,resetable:!1})}),header:this.state.context.title,maximizable:!0,modal:!1,onHide:this.close,ref:this.dialogRef,style:this.renderDialogStyle(this.state.actionMeta.windowSize),visible:!0,children:[this.state.beforeContent&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{dangerouslySetInnerHTML:{__html:this.state.beforeContent}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(this.ex.lc.LinoLayout,{editing_mode:!0,window_layout:this.state.actionMeta.window_layout,wt:this.context[_constants__WEBPACK_IMPORTED_MODULE_1__.URL_PARAM_WINDOW_TYPE]}),this.state.afterContent&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{dangerouslySetInnerHTML:{__html:this.state.afterContent}})]})})}):null}}LinoDialog.requiredModules=["prDialog","lc"],LinoDialog.iPool=ex,LinoDialog.contextType=_Base__WEBPACK_IMPORTED_MODULE_2__.URLContextType,LinoDialog.propsTypes={afterContent:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string,beforeContent:prop_types__WEBPACK_IMPORTED_MODULE_6___default().string,closable:prop_types__WEBPACK_IMPORTED_MODULE_6___default().bool,closeOnEscape:prop_types__WEBPACK_IMPORTED_MODULE_6___default().bool,data:prop_types__WEBPACK_IMPORTED_MODULE_6___default().object.isRequired,executeArgs:prop_types__WEBPACK_IMPORTED_MODULE_6___default().object.isRequired},LinoDialog.defaultProps={afterContent:null,beforeContent:null,closeOnEscape:!1,closable:!0}},6915:(e,t,n)=>{n.r(t),n.d(t,{LinoLoadMask:()=>c,LinoProgressBar:()=>d,LoadingMask:()=>p,name:()=>a});n(537);var s=n(9761),i=n.n(s),o=n(9281),r=n(683);const a="LoadingMask";let _;const l=_={prProgressSpinner:Promise.all([n.e(9880),n.e(5155)]).then(n.bind(n,3365)),prProgressBar:Promise.all([n.e(9880),n.e(5155)]).then(n.bind(n,6478))};function c(e){const t=(0,o.getExReady)(_,["prProgressSpinner"]);return t.ready?(0,r.jsx)("div",{style:{height:"100vh",width:"100vw",background:"#1b2c3159",textAlign:"center",position:"fixed",top:"0",left:"0",bottom:"0",right:"0",zIndex:"99999"},children:(0,r.jsx)(t.prProgressSpinner.ProgressSpinner,{animationDuration:"1s",className:"vertical-center",strokeWidth:"50",style:{borderRadius:"50%",overflow:"hidden",width:"150px",height:"150px"}})}):null}(0,o.RegisterImportPool)(l);class p extends o.Component{render(){if(!this.state.ready)return null;const{masking:e,children:t,mask:n,fillHeight:s,backgroundColor:i}=this.props;let o={position:"relative"};return s?o.height="100%":o.overflow="hidden",(0,r.jsxs)("div",{style:o,children:[(0,r.jsx)("div",{className:"lino-loading-mask",style:{display:n?"block":"none",backgroundColor:i},children:(0,r.jsx)("div",{style:{position:"absolute",top:"50%",right:"50%",transform:"translate(50%,-50%)"},children:(0,r.jsx)(this.ex.prProgressSpinner.ProgressSpinner,{})})}),t]})}}function d(e){const t=(0,o.getExReady)(_,["prProgressBar"]);return t.ready?(0,r.jsx)(t.prProgressBar.ProgressBar,{mode:"indeterminate",className:e.loading?"":"lino-transparent",style:{height:"5px"}}):null}p.requiredModules=["prProgressSpinner"],p.iPool=_,p.propTypes={masking:i().element,mask:i().bool,fillHeight:i().bool,backgroundColor:i().string},p.defaultProps={fillHeight:!1,backgroundColor:"#007ad9"}},2985:(e,t,n)=>{n.r(t),n.d(t,{DataContext:()=>q,DialogFactory:()=>l.N,LinoLoadMask:()=>_.LinoLoadMask,LinoProgressBar:()=>_.LinoProgressBar,LoadingMask:()=>_.LoadingMask,RootURLContext:()=>K,URLContext:()=>W,name:()=>L});var s=n(537),i=n(9761),o=n.n(i),r=n(50),a=n(9281),_=n(6915),l=n(1562),c=n(3379),p=n.n(c),d=n(7795),u=n.n(d),h=n(569),m=n.n(h),b=n(3565),E=n.n(b),g=n(9216),f=n.n(g),A=n(4589),x=n.n(A),C=n(9593),P={};P.styleTagTransform=x(),P.setAttributes=E(),P.insert=m().bind(null,"head"),P.domAPI=u(),P.insertStyleElement=f();p()(C.Z,P);C.Z&&C.Z.locals&&C.Z.locals;var D=n(683);let M;M={classNames:n.e(1473).then(n.t.bind(n,116,23))};(0,a.RegisterImportPool)(M);class y extends a.Component{constructor(e){super(e),this.state={...this.state,activeIndex:null}}onMenuItemClick(e,t,n){if(t.disabled)return e.preventDefault(),!0;if(t.command)if(e.ctrlKey){let n=window.open(document.URL),s=0;const i=()=>{if(n.hasOwnProperty("App")&&!n.App.state.site_loading){let s=null;const i=e=>{e.every((e=>{if(null!==s)return!1;if(e.hasOwnProperty("items"))i(e.items);else if(e.id===t.id)return s=e,!1;return!0}))};i(n.App.state.menu_data),n.command=s.command,n.command({originalEvent:e,item:s})}else{if(s>20)return;s+=1,setTimeout((()=>i()),100)}};i()}else t.command({originalEvent:e,item:t});!t.items&&t.url||e.preventDefault(),n===this.state.activeIndex?this.setState({activeIndex:null}):this.setState({activeIndex:n}),this.props.onMenuItemClick&&this.props.onMenuItemClick({originalEvent:e,item:t})}render(){if(!this.state.ready)return null;let e=this.props.items&&this.props.items.map(((e,t)=>{if("is_a_seperator"===e)return(0,D.jsx)("hr",{},t);let n=this.state.activeIndex===t,s=this.ex.classNames.default(e.badgeStyleClass,{"active-menuitem":n});s+=" l-menuitem",e.id===this.props.activeElemId&&(s+=" l-linked-menu");let i=e.badge&&(0,D.jsx)("span",{className:"menuitem-badge",children:e.badge}),o=e.items&&(0,D.jsx)("i",{className:"pi pi-fw pi-angle-down menuitem-toggle-icon"});return(0,D.jsxs)("li",{className:s,id:e.id,children:[e.items&&!0===this.props.root&&(0,D.jsx)("div",{className:"arrow"}),(0,D.jsxs)("a",{href:e.url,onClick:n=>{this.onMenuItemClick(n,e,t)},target:e.target,children:[(0,D.jsx)("i",{className:e.icon}),(0,D.jsx)("span",{children:e.label}),o,i]}),(0,D.jsx)(y,{activeElemId:this.props.activeElemId,items:e.items,onMenuItemClick:this.props.onMenuItemClick})]},t)}));return e?(0,D.jsx)("ul",{className:this.props.className,children:e}):null}}y.requiredModules=["classNames"],y.iPool=M,y.defaultProps={className:null,items:null,onMenuItemClick:null,root:!1},y.propTypes={className:o().string,items:o().array,onMenuItemClick:o().func,root:o().bool};class w extends s.Component{constructor(e){super(e),this.state={navKeys:[37,38,39,13,40],activeNavKeys:!1},this.data={elemStore:window.App.data.miStore,activeElemId:null},this.onKeyDown=this.onKeyDown.bind(this),this.onMenuTrigger=this.onMenuTrigger.bind(this),this.walkDown=this.walkDown.bind(this),this.walkUp=this.walkUp.bind(this),this.walkRight=this.walkRight.bind(this),this.walkLeft=this.walkLeft.bind(this)}componentDidMount(){window.addEventListener("keydown",this.onKeyDown)}componentWillUnmount(){window.removeEventListener("keydown",this.onKeyDown)}matchId(e){return t=>t.id===e}walkDown(e,t){let n=t,s=e.slice(-1)[0];e.forEach((i=>{if(i!==s){let e=n.findIndex(this.matchId(i));n=n[e].items}else{let s=document.getElementById(i);s.classList.remove("active-menuitem");let o=n.findIndex(this.matchId(i));o<n.length-1?(s.classList.remove("l-selected-menu"),s=document.getElementById(n[o+1].id),s.classList.add("l-selected-menu"),s.getBoundingClientRect().bottom-window.innerHeight<0&&s.scrollIntoView({block:"center",behaviour:"smooth"})):e.length>1&&(document.getElementById(e.slice(-2)[0]).getElementsByTagName("a")[0].click(),s.classList.remove("l-selected-menu"),e=e.slice(0,-1),this.walkDown(e,t))}}))}walkUp(e,t){let n=t;e.forEach((s=>{if(s!==e.slice(-1)[0]){let e=n.findIndex(this.matchId(s));n=n[e].items}else{let i=document.getElementById(s);i.classList.remove("active-menuitem");let o=n.findIndex(this.matchId(s));0!==o?(i.classList.remove("l-selected-menu"),i=document.getElementById(n[o-1].id),i.classList.add("l-selected-menu"),i.getBoundingClientRect().top<80&&i.scrollIntoView({block:"center",behaviour:"smooth"})):e.length>1&&(document.getElementById(e.slice(-2)[0]).getElementsByTagName("a")[0].click(),i.classList.remove("l-selected-menu"),e=e.slice(0,-1),this.walkUp(e,t))}}))}walkRight(e,t){let n=t,s=Array.from(document.getElementsByClassName("l-selected-menu"));s.length&&s[0].classList.remove("l-selected-menu"),e.forEach((t=>{let s=n.findIndex(this.matchId(t));if(t!==e.slice(-1)[0])n=n[s].items;else{this.data.activeElemId=t;let e,i=document.getElementById(n[s].id);n[s].items&&(e=document.getElementById(n[s].items[0].id),e.classList.add("l-selected-menu")),i.getElementsByTagName("a")[0].click(),e||(i.classList.add("l-selected-menu"),this.onMenuTrigger())}}))}walkLeft(e,t){if(e.length>1){let t=document.getElementById(e.slice(-1)[0]);t.classList.remove("l-selected-menu"),t.classList.remove("active-menuitem"),t=document.getElementById(e.slice(-2)[0]),t.getElementsByTagName("a")[0].click(),t.classList.add("l-selected-menu")}}onMenuTrigger(){if(this.state.activeNavKeys)window.postMessage("ArrowsReleased","*"),Array.from(document.getElementsByClassName("l-selected-menu")).forEach((e=>e.classList.remove("l-selected-menu"))),Array.from(document.getElementsByClassName("active-menuitem")).forEach((e=>e.classList.remove("active-menuitem")));else{window.App.state.staticMenuInactive&&window.App.onToggleMenu(),window.postMessage("ArrowsTaken","*");let e=Array.from(document.getElementsByClassName("active-menuitem"));e.length?e.slice(-1)[0].classList.add("l-selected-menu"):document.getElementById(this.data.elemStore[0].id).classList.add("l-selected-menu")}this.setState({activeNavKeys:!this.state.activeNavKeys})}onKeyDown(e){if((""===document.activeElement.value||void 0===document.activeElement.value)&&(77===e.keyCode&&e.altKey||this.state.activeNavKeys)){if(77===e.keyCode&&e.altKey){let e=!1;if(this.state.activeNavKeys&&(e=!0),this.onMenuTrigger(),e)return}if(this.state.navKeys.includes(e.keyCode)){e.preventDefault();let t=[],n=!1,s=this.data.elemStore,i=s;if(Array.from(document.getElementsByClassName("active-menuitem")).forEach((e=>{if(n)e.classList.remove("active-menuitem");else{let s=i.findIndex(this.matchId(e.id));s>=0?(i=i[s].items,t.push(e.id),void 0===i&&(n=!0)):e.classList.remove("active-menuitem")}})),t.length||t.push(s[0].id),t.length){let e=document.getElementById(t.slice(-1)[0]),n=Array.from(e.getElementsByClassName("l-selected-menu"));n.length?t.push(n[0].id):t.length>1?(e=document.getElementById(t.slice(-2)[0]),n=Array.from(e.getElementsByClassName("l-selected-menu")),n.length&&(t=t.slice(0,-1),t.push(n[0].id))):(n=Array.from(document.getElementsByClassName("l-selected-menu")),n.length&&(t=t.slice(0,-1),t.push(n[0].id)))}40===e.keyCode?this.walkDown(t,s):38===e.keyCode?this.walkUp(t,s):39===e.keyCode||13===e.keyCode?this.walkRight(t,s):37===e.keyCode&&this.walkLeft(t,s)}}}render(){return(0,D.jsx)("div",{className:"menu",children:(0,D.jsx)(y,{activeElemId:this.data.activeElemId,items:this.props.model,className:"layout-main-menu",onMenuItemClick:this.props.onMenuItemClick,root:!0})})}}w.defaultProps={model:null,onMenuItemClick:null},w.propTypes={model:o().array,onMenuItemClick:o().func};var B=n(759),O={};O.styleTagTransform=x(),O.setAttributes=E(),O.insert=m().bind(null,"head"),O.domAPI=u(),O.insertStyleElement=f();p()(B.Z,O);B.Z&&B.Z.locals&&B.Z.locals;let k;k={prOverlayPanel:Promise.all([n.e(9880),n.e(5155),n.e(9961),n.e(5894),n.e(1751)]).then(n.bind(n,9053)),prCard:Promise.all([n.e(9880),n.e(5155)]).then(n.bind(n,9882)),prButton:Promise.all([n.e(7353),n.e(5155),n.e(9961),n.e(3081),n.e(9749),n.e(968)]).then(n.bind(n,7215))};(0,a.RegisterImportPool)(k);class I extends a.Component{constructor(e){super(e),this.state={...this.state,expanded:!1},this.onClick=this.onClick.bind(this)}onClick(e){this.pop&&this.pop.toggle(e),this.setState({expanded:!this.state.expanded}),e.preventDefault()}renderActAsOverLay(){let{act_as_title_text:e,act_as_subtext:t}=this.props;return(0,D.jsx)(this.ex.prOverlayPanel.OverlayPanel,{ref:e=>this.op=e,appendTo:this.props.authAppendTo,className:"l-actas",children:(0,D.jsx)(this.ex.prCard.Card,{title:e,subTitle:t,children:this.props.authorities.map((e=>(0,D.jsxs)(s.Fragment,{children:[(0,D.jsx)(this.ex.prButton.Button,{label:e[1],onClick:t=>{this.op.hide(),this.props.onAuthoritiesSelect(e)}}),(0,D.jsx)("br",{})]},e[0])))})})}render(){if(!this.state.ready)return null;let{username:e,su_name:t,su_id:n}=this.props,{act_as_button_text:i,act_as_self_text:o,my_setting_text:r}=this.props;e=t?`${e} acting as ${t}`:e;let a=window.App.data.selectedLanguage||window.App.state.user_settings.lang;return(0,D.jsxs)("div",{className:"profile",children:[(0,D.jsx)(this.ex.prButton.Button,{label:window.App.state.site_data.languages[a],onClick:e=>this.lsop.toggle(e)}),(0,D.jsx)("span",{children:" | "}),(0,D.jsx)(this.ex.prOverlayPanel.OverlayPanel,{ref:e=>this.lsop=e,children:Object.keys(window.App.state.site_data.languages).filter((e=>e!=a)).map((e=>(0,D.jsxs)(s.Fragment,{children:[(0,D.jsx)(this.ex.prButton.Button,{label:window.App.state.site_data.languages[e],onClick:t=>{window.App.data.selectedLanguage=e,window.App.fetch_user_settings(n,!1,!0)}}),(0,D.jsx)("br",{})]},e)))}),this.props.logged_in?(0,D.jsxs)(s.Fragment,{children:[(0,D.jsx)(this.ex.prButton.Button,{icon:"pi pi-cog",iconPos:"right",label:e,onClick:this.onClick}),(0,D.jsxs)(this.ex.prOverlayPanel.OverlayPanel,{ref:e=>this.pop=e,children:[(0,D.jsx)(this.ex.prButton.Button,{icon:"pi pi-power-off",label:"Sign out",onClick:this.props.onSignOutIn}),(0,D.jsx)("br",{}),n&&(0,D.jsx)(this.ex.prButton.Button,{icon:"pi pi-user",label:o,onClick:this.props.onActAsSelf}),(0,D.jsx)("br",{}),this.props.authorities.length>0&&(0,D.jsx)(this.ex.prButton.Button,{icon:"pi pi-users",label:i,onClick:e=>{e.target=this.actAsEl,this.op.toggle(e)},ref:e=>this.actAsEl=e}),(0,D.jsx)("br",{}),(0,D.jsx)(this.ex.prButton.Button,{icon:"pi pi-sliders-v",label:r,onClick:this.props.onMysettings})]}),this.renderActAsOverLay()]}):(0,D.jsxs)(s.Fragment,{children:[(0,D.jsx)(this.ex.prButton.Button,{icon:"pi pi-power-off",label:"Sign in",onClick:this.props.onSignOutIn}),window.App.state.site_data.allow_online_registration&&(0,D.jsx)(this.ex.prButton.Button,{icon:"pi pi-plus-circle",label:"Create account",onClick:this.props.createAccount})]})]})}}I.requiredModules=["prOverlayPanel","prCard","prButton"],I.iPool=k,I.propTypes={logged_in:o().bool,username:o().string.isRequired,onSignOutIn:o().func.isRequired,authorities:o().array,onAuthoritiesSelect:o().func,onActAsSelf:o().func,authAppendTo:o().instanceOf(Element),su_name:o().string,su_id:o().oneOfType([o().number,o().instanceOf(void 0)]),act_as_button_text:o().string,act_as_title_text:o().string,act_as_subtext:o().string,act_as_self_text:o().string,my_setting_text:o().string,onMysettings:o().func.isRequired},I.defaultProps={authorities:[]};let v;v={classNames:n.e(1473).then(n.t.bind(n,116,23))};(0,a.RegisterImportPool)(v);class R extends a.Component{constructor(e){super(e),this.renderChatButton=this.renderChatButton.bind(this),this.onReady=this.onReady.bind(this)}onReady(){setTimeout(window.App.handleZoom,1e3)}renderChatButton(){return(0,D.jsx)("a",{onClick:this.props.onChatButton,ref:e=>window.App.chatButton=e,children:(0,D.jsx)("span",{className:this.ex.classNames.default("layout-topbar-icon pi pi-comments",{"no-ws":!this.props.WS})})})}render(){if(!this.state.ready)return null;let e="l-site-title ";return"whitewall"===window.App.data.themeName&&"l-whitewall-site-title ",(0,D.jsxs)("div",{ref:e=>window.App.tbContainer=e,className:"layout-topbar clearfix",children:[(0,D.jsx)("a",{className:"layout-menu-button",onClick:this.props.onToggleMenu,children:(0,D.jsx)("span",{className:"pi pi-bars"})}),(0,D.jsx)("a",{className:"layout-home-button",onClick:this.props.onHomeButton,children:(0,D.jsx)("span",{className:"pi pi-home"})}),window.App.state.site_data.editing_frontend&&(0,D.jsx)("a",{className:"layout-home-button",onClick:e=>{let t="_self";e.ctrlKey&&(t="_blank"),window.open(location.origin,t)},children:(0,D.jsx)("span",{className:"pi pi-globe"})}),(0,D.jsxs)("div",{className:"layout-topbar-icons",style:{display:"inline"},children:[!window.App.state.site_loading&&!window.App.state.site_data.no_user_model&&(0,D.jsx)(I,{username:window.App.state.user_settings.username,logged_in:window.App.state.user_settings.logged_in,authorities:window.App.state.user_settings.authorities,onActAsSelf:()=>window.App.onAuthoritiesSelect([void 0]),su_id:window.App.state.su_id,su_name:window.App.state.user_settings.su_name,act_as_subtext:window.App.state.user_settings.act_as_subtext,act_as_title_text:window.App.state.user_settings.act_as_title_text,act_as_button_text:window.App.state.user_settings.act_as_button_text,act_as_self_text:window.App.state.user_settings.act_as_self_text,onAuthoritiesSelect:window.App.onAuthoritiesSelect,my_setting_text:window.App.state.user_settings.my_setting_text,onSignOutIn:e=>window.App.onSignOutIn(e),createAccount:window.App.createAccount,authAppendTo:window.App.topDiv,onMysettings:e=>window.App.onMysettings(e)}),this.props.useChat&&this.renderChatButton()]})]})}}R.requiredModules=["classNames"],R.iPool=v,R.defaultProps={onToggleMenu:null,unseenCount:0},R.propTypes={onToggleMenu:o().func.isRequired,onHomeButton:o().func.isRequired,onChatButton:o().func,useChat:o().bool,WS:o().bool,unseenCount:o().number};const L="SiteContext";let T;T={classNames:n.e(1473).then(n.t.bind(n,116,23)),_:n.e(2844).then(n.t.bind(n,8289,23)),prScrollPanel:Promise.all([n.e(9880),n.e(5155)]).then(n.bind(n,6579)),u:Promise.resolve().then(n.bind(n,6367)),DashboardItems:n.e(5421).then(n.bind(n,9072)),nc:Promise.all([n.e(1473),n.e(2844),n.e(2158)]).then(n.bind(n,5527)),lb:n.e(9779).then(n.bind(n,8928))};function j(e){let[t,n]=s.useState("static"),[i,o]=s.useState("dark"),[r,_]=s.useState(!1),[l,c]=s.useState(!1),[p,d]=s.useState(!1);const u=(0,a.getExReady)(T,["prScrollPanel","classNames"],(e=>{e.classNames=e.classNames.default}));return u.ready?(0,D.jsxs)("div",{className:u.classNames("layout-wrapper",{"layout-overlay":"overlay"===t,"layout-static":"static"===t,"layout-static-sidebar-inactive":r&&"static"===t,"layout-overlay-sidebar-active":l&&"overlay"===t,"layout-mobile-sidebar-active":p}),ref:t=>e.APP.topDiv=t,children:[(0,D.jsx)(R,{onToggleMenu:e=>{c(!l),_(!r),d(!p),e&&e.preventDefault()},onHomeButton:e.APP.onHomeButton,WS:e.APP.state.WS,useChat:!1}),(0,D.jsx)("div",{className:u.classNames("layout-sidebar",{"layout-sidebar-dark":"dark"===i}),children:(0,D.jsx)(u.prScrollPanel.ScrollPanel,{style:{height:"100%"},children:(0,D.jsx)("div",{className:"layout-sidebar-scroll-content",children:(0,D.jsx)(w,{model:e.APP.state.menu_data,onMenuItemClick:e=>{e.item.items||(c(!1),d(!1))}})})})}),e.children]}):null}(0,a.RegisterImportPool)(T),Storage.prototype.setObject=function(e,t){this.setItem(e,JSON.stringify(t))},Storage.prototype.getObject=function(e){var t=this.getItem(e);return t&&JSON.parse(t)};class U extends a.Component{constructor(e){super(e),this.state={...this.state,initialized:!1}}componentWillUnmount(){let e=this.state.context.controller;e.isSlave&&delete e.parent.children[e.actionHandler.refName],delete e.APP.rps[e.actionHandler.refName]}}U.iPool=T,U.Context=a.URLContextType;class W extends U{constructor(e){super(e),this.state={...this.state,context:null}}onReady(){let e=this.props.parentContext;new this.ex.nc.Context({APP:e.APP,value:{},next:t=>{const n=e=>{Object.assign(e,this.props.params),t.pushStatus(this.props.status,e),t.history.replace(e)};t.setRoot(this),t.setParent(e),this.props.inherit?(t.value=e.copy(),t.value.static=e.value.static,t.value.controller=t,n(t.value)):this.props.simple?t.basicContext(this.props.path,n):t.buildURLContext(this.props.path,n)}})}render(){let e=this.state.initialized?(0,D.jsx)(W.Context.Provider,{value:this.state.context,children:this.props.children?this.props.children:this.props.getChildren(this.state.context)}):null;return this.props.simple?e:(0,D.jsxs)("div",{ref:e=>this.contextEntry=e,children:[e,(0,D.jsx)("div",{ref:e=>this.chInPx=e,style:{width:"1ch",visibility:"hidden"}})]})}}W.requiredModules=["nc"],W.propTypes={children:(e,...t)=>{if(null===e.getChildren)return o().element.isRequired(e,...t)},getChildren:(e,...t)=>{if(null===e.children)return o().func.isRequired(e,...t)},inherit:o().bool,params:o().object,parentContext:o().object.isRequired,path:(e,...t)=>{if(!e.inherit)return o().string.isRequired(e,...t)},simple:o().bool,status:o().object},W.defaultProps={children:null,getChildren:null,inherit:!1,params:{},simple:!0,status:{}};class K extends U{constructor(e){super(e),this.state={...this.state,context:e.APP.URLContext.value,hasActor:null},this.state.context.controller.setRoot(this),this.onChInPxRef=this.onChInPxRef.bind(this)}onChInPxRef(e){if(this.chInPx=e,e){let e=this.state.context.controller;e.attachDataContext(new q({root:this,context:{success:!1},next:()=>{e.build((t=>{t.clone?(Object.assign(t,t.clone),e.APP.navigate(`${t.path}?rs=${t.rs}`,{replace:!0})):t.rs||(t.rs=e.newSlug(),e.APP.navigate(`${t.path}?rs=${t.rs}`,{replace:!0})),e.history.replace(t),t.hasActor||(delete t.clone,delete t.mutableData,delete t.immutableData,t.runnable&&(e.actionHandler.runAction(t.runnable),delete t.runnable))}))}}))}}render(){return this.state.ready?(0,D.jsx)(j,{APP:this.props.APP,children:(0,D.jsxs)("div",{className:"layout-main",ref:e=>this.contextEntry=e,children:[this.state.initialized&&(0,D.jsx)(U.Context.Provider,{value:this.state.context,children:this.state.hasActor?(0,D.jsx)(this.ex.lb.LinoBody,{actorData:this.state.context.static.actorData}):(0,D.jsx)(this.ex.DashboardItems.DashboardItems,{ref:e=>{this.props.APP.dashboard=e,this.props.APP.setRpRef(e,"dItems")},dashboard_items:this.props.APP.state.user_settings?this.props.APP.state.user_settings.dashboard_items:0,user:this.props.APP.state.user_settings?this.props.APP.state.user_settings.username:"notloaded"})}),(0,D.jsx)("div",{ref:this.onChInPxRef,style:{width:"1ch",visibility:"hidden"}})]})}):null}}K.requiredModules=["DashboardItems","lb"],K.propTypes={APP:o().object.isRequired};class q extends a.DynDep{constructor(...e){return super(...e),this.saveUploadHandlerEvent=e=>{this.mutableContext.UploadHandlerEvent=e},this}async prepare(){this.ex._=this.ex._.default}onReady({root:e,context:t={},next:n}){this.root=e,this.refStore={Leaves:{},slaveLeaves:{},virtualLeaves:{}},this.backupContext=this.backupContext.bind(this),this.clearMod=this.clearMod.bind(this),this.isModified=this.isModified.bind(this),this.prepContext=this.prepContext.bind(this),this.set=this.set.bind(this),this.setLeafRef=this.setLeafRef.bind(this),this.update=this.update.bind(this),this.updateState=this.updateState.bind(this),this.set(t,!0),n(this)}prepContext(e){if(e.UploadHandlerEvent=null,e.modifiedRows={},e.modified=[],e.rows){let n=this.root.context[r.URL_PARAM_LIMIT];e.pks=e.rows.map((e=>e[this.root.context.static.actorData.pk_index]));for(var t=0;t<e.rows.length;t++)e.modifiedRows[t]=[];e.pageCount=Math.floor(e.count/n)}return e}backupContext(e){this.contextBackup=this.ex._.cloneDeep(e)}clearMod(){if(this.mutableContext.UploadHandlerEvent=null,this.mutableContext.modified=[],this.mutableContext.rows)for(var e=0;e<this.mutableContext.rows.length;e++)this.mutableContext.modifiedRows[e]=[];Object.assign(this.mutableContext,this.ex._.cloneDeep(this.contextBackup))}isModified(e){if(null!==this.mutableContext.UploadHandlerEvent)return!0;if(void 0!==e)return isNaN(parseInt(e))?this.mutableContext.modified.length>0:this.mutableContext.modifiedRows[e].length>0;if(this.mutableContext.modified.length)return!0;for(const e of Object.values(this.mutableContext.modifiedRows))if(e.length)return!0;return!1}set(e,t,n={},s=(()=>null)){this.backupContext(e),this.mutableContext=this.prepContext(e),t||this.root.setState({context:this.mutableContext,displayMode:this.root.context[r.URL_PARAM_DISPLAY_MODE],...n}),s(this.mutableContext)}setLeafRef({name:e,ref:t,type:n,input:s}){this.refStore[n+"Leaves"][e]=t}update(e={}){Object.assign(this.mutableContext,e),this.root.setState({context:this.mutableContext})}updateState(e,t={}){this.mutableContext=Object.assign({},this.mutableContext,e),this.root.setState({context:this.mutableContext,...t})}}q.requiredModules=["u","_"],q.iPool=T,q.Context=a.DataContextType},5649:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",s=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),s&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),s&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,s,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(s)for(var a=0;a<this.length;a++){var _=this[a][0];null!=_&&(r[_]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);s&&r[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},7757:e=>{e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var s=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),o="/*# ".concat(i," */");return[t].concat([o]).join("\n")}return[t].join("\n")}},9593:(e,t,n)=>{n.d(t,{Z:()=>a});var s=n(7757),i=n.n(s),o=n(5649),r=n.n(o)()(i());r.push([e.id,".l-selected-menu {\n    background: black;\n}\nli.l-linked-menu.l-menuitem > a, li.l-menuitem.active-menuitem > a {\n    color: #0388e5;\n}\nul li.l-menuitem a {\n    color: #ffffff;\n}\n","",{version:3,sources:["webpack://./lino_react/react/components/AppMenu.css"],names:[],mappings:"AAAA;IACI,iBAAiB;AACrB;AACA;IACI,cAAc;AAClB;AACA;IACI,cAAc;AAClB",sourcesContent:[".l-selected-menu {\n    background: black;\n}\nli.l-linked-menu.l-menuitem > a, li.l-menuitem.active-menuitem > a {\n    color: #0388e5;\n}\nul li.l-menuitem a {\n    color: #ffffff;\n}\n"],sourceRoot:""}]);const a=r},759:(e,t,n)=>{n.d(t,{Z:()=>a});var s=n(7757),i=n.n(s),o=n(5649),r=n.n(o)()(i());r.push([e.id,".l-site-title {\n    font-family: roman;\n    font-style: italic;\n    font-size: x-large;\n}\n","",{version:3,sources:["webpack://./lino_react/react/components/AppTopBar.css"],names:[],mappings:"AAAA;IACI,kBAAkB;IAClB,kBAAkB;IAClB,kBAAkB;AACtB",sourcesContent:[".l-site-title {\n    font-family: roman;\n    font-style: italic;\n    font-size: x-large;\n}\n"],sourceRoot:""}]);const a=r},2651:(e,t,n)=>{n.d(t,{Z:()=>a});var s=n(7757),i=n.n(s),o=n(5649),r=n.n(o)()(i());r.push([e.id,".l-bbar .hidden{\n    opacity: 0;\n}\n.p-inputtext.p-component {\n    padding: 0.3rem 0.3rem;\n}\n.p-component.p-button {\n    color: black;\n    border: 0;\n    padding: 0.3rem 0.3rem;\n    vertical-align: middle;\n    font-size: 0.85rem;\n}\n.p-component.p-button:not(.p-highlight) {\n    background: transparent;\n}\n.p-component.p-button.p-button-icon-only {\n    width: 1.6rem;\n    padding: 0.3rem;\n}\n.p-button.p-button-icon-only .pi {\n    font-size: 0.85rem;\n}\n.p-splitbutton.p-component {\n    vertical-align: middle;\n}\ndiv.p-button.p-togglebutton.l-bbar-editor-button .p-button-icon-left {\n    color: black;\n}\n.l-whitewall-body-container div.p-button.p-togglebutton.l-bbar-editor-button .p-button-icon-left {\n    color: unset;\n}\ndiv.p-button.p-togglebutton.l-bbar-editor-button {\n    background: transparent;\n    border: 0;\n}\ndiv.p-button.p-togglebutton.l-bbar-editor-button:hover {\n    color: white;\n    background: #116fbf;\n    border-color: #116fbf;\n}\n.p-progress-spinner .p-progress-spinner-circle {\n    stroke-linecap: butt;\n}\n","",{version:3,sources:["webpack://./lino_react/react/components/LinoBbar.css"],names:[],mappings:"AAAA;IACI,UAAU;AACd;AACA;IACI,sBAAsB;AAC1B;AACA;IACI,YAAY;IACZ,SAAS;IACT,sBAAsB;IACtB,sBAAsB;IACtB,kBAAkB;AACtB;AACA;IACI,uBAAuB;AAC3B;AACA;IACI,aAAa;IACb,eAAe;AACnB;AACA;IACI,kBAAkB;AACtB;AACA;IACI,sBAAsB;AAC1B;AACA;IACI,YAAY;AAChB;AACA;IACI,YAAY;AAChB;AACA;IACI,uBAAuB;IACvB,SAAS;AACb;AACA;IACI,YAAY;IACZ,mBAAmB;IACnB,qBAAqB;AACzB;AACA;IACI,oBAAoB;AACxB",sourcesContent:[".l-bbar .hidden{\n    opacity: 0;\n}\n.p-inputtext.p-component {\n    padding: 0.3rem 0.3rem;\n}\n.p-component.p-button {\n    color: black;\n    border: 0;\n    padding: 0.3rem 0.3rem;\n    vertical-align: middle;\n    font-size: 0.85rem;\n}\n.p-component.p-button:not(.p-highlight) {\n    background: transparent;\n}\n.p-component.p-button.p-button-icon-only {\n    width: 1.6rem;\n    padding: 0.3rem;\n}\n.p-button.p-button-icon-only .pi {\n    font-size: 0.85rem;\n}\n.p-splitbutton.p-component {\n    vertical-align: middle;\n}\ndiv.p-button.p-togglebutton.l-bbar-editor-button .p-button-icon-left {\n    color: black;\n}\n.l-whitewall-body-container div.p-button.p-togglebutton.l-bbar-editor-button .p-button-icon-left {\n    color: unset;\n}\ndiv.p-button.p-togglebutton.l-bbar-editor-button {\n    background: transparent;\n    border: 0;\n}\ndiv.p-button.p-togglebutton.l-bbar-editor-button:hover {\n    color: white;\n    background: #116fbf;\n    border-color: #116fbf;\n}\n.p-progress-spinner .p-progress-spinner-circle {\n    stroke-linecap: butt;\n}\n"],sourceRoot:""}]);const a=r},4989:(e,t,n)=>{var s=n(3379),i=n.n(s),o=n(7795),r=n.n(o),a=n(569),_=n.n(a),l=n(3565),c=n.n(l),p=n(9216),d=n.n(p),u=n(4589),h=n.n(u),m=n(2651),b={};b.styleTagTransform=h(),b.setAttributes=c(),b.insert=_().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=d();i()(m.Z,b),m.Z&&m.Z.locals&&m.Z.locals},3379:e=>{var t=[];function n(e){for(var n=-1,s=0;s<t.length;s++)if(t[s].identifier===e){n=s;break}return n}function s(e,s){for(var o={},r=[],a=0;a<e.length;a++){var _=e[a],l=s.base?_[0]+s.base:_[0],c=o[l]||0,p="".concat(l," ").concat(c);o[l]=c+1;var d=n(p),u={css:_[1],media:_[2],sourceMap:_[3],supports:_[4],layer:_[5]};if(-1!==d)t[d].references++,t[d].updater(u);else{var h=i(u,s);s.byIndex=a,t.splice(a,0,{identifier:p,updater:h,references:1})}r.push(p)}return r}function i(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var o=s(e=e||[],i=i||{});return function(e){e=e||[];for(var r=0;r<o.length;r++){var a=n(o[r]);t[a].references--}for(var _=s(e,i),l=0;l<o.length;l++){var c=n(o[l]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}o=_}}},569:e=>{var t={};e.exports=function(e,n){var s=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(n)}},9216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var s="";n.supports&&(s+="@supports (".concat(n.supports,") {")),n.media&&(s+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(s+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),s+=n.css,i&&(s+="}"),n.media&&(s+="}"),n.supports&&(s+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}}]);
//# sourceMappingURL=main.SiteContext_App.969634d108a699ece8c3.js.map