"use strict";(self.webpackChunklino_react=self.webpackChunklino_react||[]).push([[5421],{845:(e,t,s)=>{s.r(t),s.d(t,{DashboardItems:()=>u,name:()=>h});s(1914);var r=s(2972),a=s.n(r),o=s(9281),n=s(1300),d=s(6552);let i;i={queryString:Promise.all([s.e(1473),s.e(6521)]).then(s.t.bind(s,5198,19)),AbortController:s.e(1473).then(s.t.bind(s,4862,23)),whatwgFetch:s.e(1473).then(s.bind(s,7058)),prProgressSpinner:Promise.all([s.e(9880),s.e(5155)]).then(s.bind(s,8169)),lm:Promise.resolve().then(s.bind(s,552))};(0,o.RegisterImportPool)(i);class l extends o.Component{constructor(){super(),this.state={...this.state,data:[],loaded:!1,placeholder:"Loading..."},this.reloadData=this.reloadData.bind(this),this.reload=this.reloadData}onReady(){this.controller=new this.ex.AbortController.default,this.reloadData()}componentWillUnmount(){this.controller.abort()}reloadData(){this.setState({loaded:!1});let e={fmt:"json"};window.App.add_su(e),e[n.URL_PARAM_LINO_VERSION]=window.App.state.site_data.revision_number,e[n.URL_PARAM_USER_LANGUAGE]=window.App.data.selectedLanguage||window.App.state.user_settings.lang,this.ex.whatwgFetch.fetch(this.props.endpoint+`?${this.ex.queryString.stringify(e)}`,{signal:this.controller.signal}).then((e=>200!==e.status?(this.setState({placeholder:"Something went wrong"}),{status:e.status$}):e.json())).then((e=>{this.props.post_data(e),this.setState({data:e,loaded:!0,everloaded:!0})})).catch((function(e){"AbortError"===e.name&&console.log("request aborted",e)}))}render(){if(!this.state.ready)return null;const{data:e,loaded:t,placeholder:s,everloaded:r}=this.state,{render:a}=this.props;return r&&!t?(0,d.jsx)(this.ex.lm.LoadingMask,{mask:!0,children:a(e)}):(0,d.jsx)(this.ex.lm.LoadingMask,{mask:!1,children:t||r&&this.props.useEverLoaded?a(e):this.props.hideLoading?(0,d.jsx)("div",{}):(0,d.jsx)(this.ex.prProgressSpinner.ProgressSpinner,{})})}}l.requiredModules=["queryString","AbortController","whatwgFetch","prProgressSpinner","lm"],l.iPool=i,l.propTypes={endpoint:a().string.isRequired,render:a().func.isRequired,post_data:a().func,hideLoading:a().bool,useEverLoaded:a().bool},l.defaultProps={post_data:e=>e,hideLoading:!1,useEverLoaded:!1};const h="DashboardItems";let p;p={prButton:Promise.all([s.e(7353),s.e(5155),s.e(7320),s.e(2109),s.e(6839),s.e(968)]).then(s.bind(s,4917)),lm:Promise.resolve().then(s.bind(s,552))};(0,o.RegisterImportPool)(p);class u extends o.Component{constructor(){super(),this.state={...this.state,stamp:Date(),unloaded:!0},this.reloadData=this.reload,this.onDataGet=this.onDataGet.bind(this)}reload(){Object.keys(window.App.rps).filter((e=>e.includes("dashboard"))).forEach((e=>{window.App.rps[e].reload()}))}onDataGet(e){this.setState({unloaded:!1})}renderDashboard(e,t){return s=>{if(!s.version_mismatch||"dashboard-0"!==t)return s.html?(0,d.jsxs)("div",{children:[e&&(0,d.jsx)(this.ex.prButton.Button,{icon:"pi pi-refresh",style:{float:"right"},onClick:()=>{let e=window.App.rps[t];e&&e.reload()}}),(0,d.jsx)("div",{dangerouslySetInnerHTML:{__html:s.html}})]}):void 0;window.App.reset(null,!0)}}render(){if(!this.state.ready)return null;const e=this.state,t=this.props;let s=t.dashboard_items;return void 0===s&&(s=0),(0,d.jsxs)(this.ex.lm.LoadingMask,{mask:e.unloaded,fillHeight:!0,backgroundColor:"",children:[(0,d.jsx)(l,{ref:e=>{window.App.setRpRef(e,"dashboard-main")},endpoint:"api/main_html",useEverLoaded:!0,hideLoading:!0,post_data:this.onDataGet,render:this.renderDashboard(!1,"dashboard-main")},`${t.user}-${e.stamp}`),[...Array(s).keys()].map((s=>(0,d.jsx)(l,{ref:e=>{window.App.setRpRef(e,`dashboard-${s}`)},endpoint:`dashboard/${s}`,post_data:this.onDataGet,hideLoading:!0,render:this.renderDashboard(!0,`dashboard-${s}`)},`${t.user}-${s}-${e.stamp}`)))]})}}u.requiredModules=["prButton","lm"],u.iPool=p,u.propTypes={user:a().string},u.defaultProps={P:0}}}]);
//# sourceMappingURL=main.DashboardItems_SiteContext.f00515b27ce222c801c5.js.map