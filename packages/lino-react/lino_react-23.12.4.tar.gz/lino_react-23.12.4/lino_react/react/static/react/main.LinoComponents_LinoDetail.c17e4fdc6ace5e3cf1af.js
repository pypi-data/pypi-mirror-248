"use strict";(self.webpackChunklino_react=self.webpackChunklino_react||[]).push([[6622],{6392:(e,t,s)=>{s.d(t,{E:()=>d});var n=s(1914),i=s(2972),_=s.n(i),a=s(9281),l=s(9158),r=s(1300),o=s(6552);let p;p={_:s.e(5312).then(s.t.bind(s,8452,23))};(0,a.RegisterImportPool)(p);class d extends l.AutoComplete{async prepare(){this.ex._=this.ex._.default,await super.prepare()}constructor(e){super(e),this.wrapperClasses.push("l-ForeignKeyElement"),this.state={...this.state,currentValue:null},this.dataKeyHidden=e[r.URL_PARAM_WINDOW_TYPE]===r.WINDOW_TYPE_TABLE?e.elem.fields_index_hidden:e.elem.name+"Hidden",this.hasClearButton=!1,this.getSnapshotBeforeUpdate=this.getSnapshotBeforeUpdate.bind(this),this.componentDidUpdate=this.componentDidUpdate.bind(this),this.choicesURL=this.choicesURL.bind(this),this.getInput=this.getInput.bind(this),this.getValue=this.getValue.bind(this),this.innerHTML=this.innerHTML.bind(this),this.OnExternalLinkClick=this.OnExternalLinkClick.bind(this),this.onSelect=this.onSelect.bind(this),this.clear=this.clear.bind(this)}onReady(){this.setState({currentValue:this.getValue()}),super.onReady()}getSnapshotBeforeUpdate(e,t){if(!this.state.ready)return null;let s=this.getValue();return this.ex._.isEqual(s,this.state.currentValue)?{}:{contextUpdate:s}}componentDidUpdate(e,t,s){s.contextUpdate&&this.setState({value:{...s.contextUpdate},currentValue:s.contextUpdate})}choicesURL(e,t,s){let n=this.props.urlParams,i=n.static.actorData,_=i.chooser_dict&&i.chooser_dict[this.props.elem.name],a={query:e};_&&_.forEach((e=>{if(this.props[r.URL_PARAM_WINDOW_TYPE]!==r.WINDOW_TYPE_TABLE){let t=this.getValueByName(e+"Hidden");void 0===t&&(t=this.getValueByName(e)),a[e]=t}else{let t=i.col.find((t=>t.name===e));a[e]=this.getValueByName(t.fields_index_hidden||t.fields_index)}}));let l=n.controller.actionHandler;return`${n.action_dialog?"apchoices":"choices"}/${n.packId}/${n.actorId}${n.action_dialog?`/${n.an}`:""}/${this.props.elem.name}?${l.parser.stringify(Object.assign(l.defaultStaticParams(),{...a,[r.URL_PARAM_START]:t,[r.URL_PARAM_LIMIT]:s}))}`}getInput(){return super.getInput({onClear:this.clear})}getValue(){return{text:super.getValue(),value:this.getValueByName(this.dataKeyHidden)}}OnExternalLinkClick(e){let t=this.props.elem.field_options.related_actor_id;e.stopPropagation();let s=this.props.urlParams.controller;s.history.pushPath({pathname:`/api/${t.split(".").join("/")}/${this.getValueByName(this.dataKeyHidden)}`,params:s.actionHandler.defaultStaticParams()})}onSelect(e){this.setState({value:e.value}),this.update({[this.dataKey]:e.value.text,[this.dataKeyHidden]:e.value.value})}clear(){this.update({[this.dataKey]:"",[this.dataKeyHidden]:null}),this.setState({value:{text:"",value:null},[r.URL_PARAM_FILTER]:""})}innerHTML(){return null===this.state.value?null:(0,o.jsxs)(n.Fragment,{children:[this.state.value.text&&this.props.link&&this.props.elem.field_options.view_permission&&(0,o.jsx)("div",{className:"l-span-clickable",ref:e=>{e&&(e.onclick=this.OnExternalLinkClick)},children:"↗  "}),(0,o.jsx)("div",{style:{whiteSpace:"nowrap",width:"100%"},children:this.state.value.text||" "})]})}}d.requiredModules=["_"].concat(l.AutoComplete.requiredModules),d.iPool=Object.assign(p,l.AutoComplete.iPool.copy()),d.propTypes={...l.AutoComplete.propTypes,simple:_().bool,link:_().bool},d.defaultProps={...l.AutoComplete.defaultProps,simple:!1,link:!0}},3900:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LinoLayout:()=>LinoLayout,name:()=>name});var _LinoComponents_css__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9466),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1914),prop_types__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(2972),prop_types__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_9__),_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1300),_Base__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9281),_Base__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_Base__WEBPACK_IMPORTED_MODULE_3__),_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1230),_ForeignKeyElement__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(6392),_TextFieldElement__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6003),_datetime__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9426),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(6552),_class,_class2,_class3,_class4,_class5,_class6,_class7,_class8;const name="LinoComponents";let ex;const exModulePromises=ex={classNames:__webpack_require__.e(1473).then(__webpack_require__.t.bind(__webpack_require__,4507,23)),_:__webpack_require__.e(5312).then(__webpack_require__.t.bind(__webpack_require__,8452,23)),weakKey:__webpack_require__.e(1473).then(__webpack_require__.t.bind(__webpack_require__,9295,23)),prTabView:Promise.all([__webpack_require__.e(3486),__webpack_require__.e(1864)]).then(__webpack_require__.bind(__webpack_require__,5532)),prPanel:Promise.all([__webpack_require__.e(3486),__webpack_require__.e(4709),__webpack_require__.e(6999)]).then(__webpack_require__.bind(__webpack_require__,2124)),prInputText:Promise.resolve().then(__webpack_require__.bind(__webpack_require__,8706)),prCheckbox:Promise.all([__webpack_require__.e(3486),__webpack_require__.e(9179)]).then(__webpack_require__.bind(__webpack_require__,8777)),prFieldset:Promise.all([__webpack_require__.e(3486),__webpack_require__.e(4709),__webpack_require__.e(905)]).then(__webpack_require__.bind(__webpack_require__,6530)),prFileUpload:Promise.all([__webpack_require__.e(3486),__webpack_require__.e(9880),__webpack_require__.e(4709),__webpack_require__.e(6869),__webpack_require__.e(5656)]).then(__webpack_require__.bind(__webpack_require__,4070)),prSplitter:__webpack_require__.e(3486).then(__webpack_require__.bind(__webpack_require__,2988)),prButton:Promise.resolve().then(__webpack_require__.bind(__webpack_require__,4917)),prPassword:Promise.all([__webpack_require__.e(3486),__webpack_require__.e(8016)]).then(__webpack_require__.bind(__webpack_require__,423)),prProgressSpinner:__webpack_require__.e(9880).then(__webpack_require__.bind(__webpack_require__,8169)),lb:Promise.all([__webpack_require__.e(532),__webpack_require__.e(9779)]).then(__webpack_require__.bind(__webpack_require__,1462)),sc:Promise.resolve().then(__webpack_require__.bind(__webpack_require__,4069))};function LinoProgressSpinner(e){const t=(0,_Base__WEBPACK_IMPORTED_MODULE_3__.getExReady)(ex,["prProgressSpinner"]);return t.ready?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(t.prProgressSpinner.ProgressSpinner,{animationDuration:"1.5s",strokeWidth:"4",style:{height:"35px",width:"35px"}}):null}(0,_Base__WEBPACK_IMPORTED_MODULE_3__.RegisterImportPool)(ex);const LinoComponents={TabPanel:(_class=class extends _Base__WEBPACK_IMPORTED_MODULE_3__.Component{async prepare(){this.ex._=this.ex._.default}constructor(e){super(e),this.state={...this.state,activeIndex:e.urlParams.tab||0}}getSnapshotBeforeUpdate(e,t){if(!this.state.ready)return null;let s={},n=this.props.urlParams.tab||0;return this.state.activeIndex!=n&&(s.tIndex=n),this.ex._.isEqual(e,this.props)||(s.render=!0),Object.keys(s).length?s:null}componentDidUpdate(e,t,s){s&&("tIndex"in s?this.setState({activeIndex:s.tIndex}):"render"in s&&this.setState({loading:!1}))}render(){return this.state.ready?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(this.ex.prTabView.TabView,{activeIndex:this.state.activeIndex,onTabChange:e=>this.props.urlParams.controller.history.replaceState({tab:e.index}),className:this.ex.classNames.default("lino-panel"),children:react__WEBPACK_IMPORTED_MODULE_1__.Children.map(this.props.children,((e,t)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(this.ex.prTabView.TabPanel,{header:e.props.elem.label,contentClassName:"lino-panel",children:e},t)))}):null}},_class.requiredModules=["prTabView","classNames","_"],_class.iPool=ex,_class),Panel:(_class2=class extends _Base__WEBPACK_IMPORTED_MODULE_3__.Component{async prepare(){this.ex.classNames=this.ex.classNames.default,this.ex._=this.ex._.default}constructor(e){super(e),this.state={...this.state,children:null},this.flexs={},this.maintainTableWidth=_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.maintainTableWidth.bind(this),this.messageInterceptor=this.messageInterceptor.bind(this),this.setChildren=this.setChildren.bind(this)}onReady(){this.panel_classes=this.ex.classNames("l-panel",{"l-panel-vertical":this.props.elem.vertical,"l-panel-horizontal":!this.props.elem.vertical,"l-panel-fieldset":this.props.elem.isFieldSet,"l-whitewall-panel-header":"whitewall"===window.App.data.themeName}),this.setChildren(this.props),Object.keys(this.flexs).length>1&&window.addEventListener("message",this.messageInterceptor)}getSnapshotBeforeUpdate(e,t){return this.state.ready?this.ex._.isEqual(e,this.props)?null:"requireRefresh":null}componentDidUpdate(e,t,s){null!==s&&"requireRefresh"===s&&(this.setChildren(this.props),this.setState({loading:!1}))}componentWillUnmount(){Object.keys(this.flexs).length>1&&window.removeEventListener("message",this.messageInterceptor)}messageInterceptor(e){e.data}setChildren(e){let{resizable_panel:t}=e.urlParams.controller.APP.state.site_data;t=t&&!e.urlParams.controller.static.isMobile&&e.elem.hasOwnProperty("vertical")&&!e.elem.vertical&&e.parent&&["main","TabPanel"].includes(e.parent.react_name);let s=react__WEBPACK_IMPORTED_MODULE_1__.Children.map(e.children,((e,s)=>{let n={};e.props.elem.value.flex&&(n.flex=`1 1 ${e.props.elem.value.flex}%`);let i={style:n,key:s,className:this.ex.classNames("l-component")};return t?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(this.ex.prSplitter.SplitterPanel,{...i,children:e}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{...i,children:e})}));t&&(s=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(this.ex.prSplitter.Splitter,{style:{width:"inherit"},children:s})),this.setState({children:s})}render(){return this.state.ready?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{className:this.panel_classes,children:[(!this.props.parent||"TabPanel"!==this.props.parent.react_name)&&this.props.elem.label&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("h1",{children:this.props.elem.label}),this.state.children]}):null}},_class2.requiredModules=["classNames","_","prSplitter"],_class2.iPool=ex,_class2),SlaveSummaryPanel:(_class3=class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentDelayedValue{render(){if(!this.state.ready)return null;let e={height:"100%",width:"100%",display:"flex",flexDirection:"column"},t=null===this.state.value&&this.delayed?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(LinoProgressSpinner,{}):this.innerHTML(_constants__WEBPACK_IMPORTED_MODULE_2__.DANGEROUS_HTML);return this.props[_constants__WEBPACK_IMPORTED_MODULE_2__.URL_PARAM_WINDOW_TYPE]===_constants__WEBPACK_IMPORTED_MODULE_2__.WINDOW_TYPE_TABLE?t:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(this.ex.prPanel.Panel,{className:"l-slave-summary-panel",header:this.props.elem.label,icons:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(this.ex.prButton.Button,{className:"p-transparent-button",style:{border:"0px",background:"transparent",color:"black"},onClick:e=>{let t=this.props.urlParams;t.controller.history.pushPath({pathname:`/api/${this.actorID.split(".").join("/")}`,params:{mk:t.pk,mt:t.static.actorData.content_type}})},icon:"pi pi-external-link",label:""}),style:e,children:t})}},_class3.requiredModules=_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentDelayedValue.requiredModules.concat(["prPanel","prButton"]),_class3.iPool=Object.assign(ex,_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentDelayedValue.iPool.copy()),_class3),ChoiceListFieldElement:class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInputChoices{constructor(e){super(e),this.options=e.urlParams.controller.APP.state.site_data.choicelists[e.elem.field_options.store]}},ChoicesFieldElement:class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInputChoices{constructor(e){super(e),this.options=e.elem.field_options.store.map((e=>({text:e[1],value:e[0]})))}},URLFieldElement:class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput{constructor(e){super(e),this.innerHTML=this.innerHTML.bind(this)}innerHTML(){let e=this.getValue();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{className:this.filled()&&this.props[_constants__WEBPACK_IMPORTED_MODULE_2__.URL_PARAM_WINDOW_TYPE]!==_constants__WEBPACK_IMPORTED_MODULE_2__.WINDOW_TYPE_TABLE?"l-ellipsis l-card":"l-ellipsis",style:{display:"block",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",maxWidth:"290px"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("a",{href:e,title:e,children:e||" "})})}},DisplayElement:(_class4=class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentDelayedValue{render(){if(!this.state.ready)return null;let e=null===this.state.value&&this.delayed?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(LinoProgressSpinner,{}):this.innerHTML(_constants__WEBPACK_IMPORTED_MODULE_2__.DANGEROUS_HTML),t=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.Labeled,{...this.props,elem:this.props.elem,isFilled:this.filled(),children:e});return this.props.elem.value.collapsible?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(this.ex.prFieldset.Fieldset,{toggleable:!0,collapsed:this.props.urlParams.static.isMobile,children:t}):t}},_class4.requiredModules=["prFieldset"].concat(_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentDelayedValue.requiredModules),_class4.iPool=Object.assign(ex,_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentDelayedValue.iPool.copy()),_class4),ConstantElement:e=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{dangerouslySetInnerHTML:{__html:e.elem.value.html||" "}}),CharFieldElement:class CharFieldElement extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput{constructor(props){super(props),this.re=props.elem.field_options.maskRe&&eval(props.elem.field_options.maskRe),this.inputState={...this.inputState,onChangeUpdateAssert:(t=>!(this.re&&!this.re.exec(e.target.value))).bind(this)}}},DecimalFieldElement:class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput{constructor(e){super(e),this.inputState={...this.inputState,inputProps:{keyfilter:"num"}}}},IntegerFieldElement:class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput{constructor(e){super(e),this.inputState={...this.inputState,inputProps:{keyfilter:"int"}}}},UppercaseTextFieldElement:class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput{constructor(e){super(e),this.inputState={...this.inputState,inputProps:{onInput:e=>{event.target.value=(""+event.target.value).toUpperCase()}}}}},IBANFieldElement:class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput{constructor(e){super(e),this.inputState={...this.inputState,inputProps:{onInput:e=>{e.target.value=(""+e.target.value).toUpperCase().replace(/[^ ]{4}(?! )(?!$)/g,(e=>e+" "))}}}}},PasswordFieldElement:(_class5=class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput{async prepare(){await super.prepare(),this.inputState={...this.inputState,inputOnly:!0,inputComponent:this.ex.prPassword.Password,inputProps:{feedback:!1,promptLabel:""}}}},_class5.requiredModules=["prPassword"].concat(_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput.requiredModules),_class5.iPool=Object.assign(ex,_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput.iPool.copy()),_class5),AutoFieldElement:class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput{constructor(e){super(e),this.inputState={...this.inputState,inputProps:{type:"text",keyfilter:"pint"}}}},BooleanFieldElement:(_class6=class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput{constructor(e){super(e),this.innerHTML=()=>this.getInput(),this.onChangeUpdate=this.onChangeUpdate.bind(this),this.innerHTML=this.innerHTML.bind(this)}async prepare(){await super.prepare(),this.inputState={...this.inputState,inputComponent:this.ex.prCheckbox.Checkbox,onChangeUpdateAssert:e=>!(this.props[_constants__WEBPACK_IMPORTED_MODULE_2__.URL_PARAM_WINDOW_TYPE]===_constants__WEBPACK_IMPORTED_MODULE_2__.WINDOW_TYPE_TABLE&&"Enter"===e.originalEvent.key)}}onChangeUpdate(e){this.update({[this.dataKey]:e.checked}),this.setState({})}render(){return this.state.ready?(this.inputState.inputProps={readOnly:this.disabled(),checked:this.getValue()||!1},super.render()):null}},_class6.requiredModules=["prCheckbox"].concat(_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput.requiredModules),_class6.iPool=Object.assign(ex,_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput.iPool.copy()),_class6),PreviewTextFieldElement:_TextFieldElement__WEBPACK_IMPORTED_MODULE_6__.v,TextFieldElement:_TextFieldElement__WEBPACK_IMPORTED_MODULE_6__.S,DateFieldElement:_datetime__WEBPACK_IMPORTED_MODULE_7__.DateFieldElement,TimeFieldElement:_datetime__WEBPACK_IMPORTED_MODULE_7__.TimeFieldElement,ForeignKeyElement:_ForeignKeyElement__WEBPACK_IMPORTED_MODULE_5__.E,FileFieldElement:(_class7=class extends _LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput{constructor(e){super(e),this.disabled=this.disabled.bind(this)}async prepare(){await super.prepare(),this.ex.weakKey=this.ex.weakKey.default,this.UPLOAD_HANDLER_EVENT={files:{},options:null}}componentWillUnmount(){this.props.urlParams.controller.dataContext.saveUploadHandlerEvent(null)}disabled(){return this.props[_constants__WEBPACK_IMPORTED_MODULE_2__.URL_PARAM_WINDOW_TYPE]===_constants__WEBPACK_IMPORTED_MODULE_2__.WINDOW_TYPE_DETAIL||super.disabled()}getInput(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(this.ex.prFileUpload.FileUpload,{auto:!0,customUpload:!0,multiple:!0,name:this.dataKey,onRemove:e=>{delete this.UPLOAD_HANDLER_EVENT.files[this.ex.weakKey(e.file)],Object.keys(this.UPLOAD_HANDLER_EVENT).length||this.props.urlParams.controller.dataContext.saveUploadHandlerEvent(null)},uploadHandler:e=>{e.files.forEach(((e,t)=>{this.UPLOAD_HANDLER_EVENT.files[this.ex.weakKey(e)]=e})),this.UPLOAD_HANDLER_EVENT.options=e.options,this.props.urlParams.controller.dataContext.saveUploadHandlerEvent(this.UPLOAD_HANDLER_EVENT)},url:`api/${this.props.urlParams.packId}/${this.props.urlParams.actorId}`})}innerHTML(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("a",{href:"/media/"+this.getValue(),children:[" ",this.getValue()||" "," "]})}},_class7.requiredModules=["prFileUpload","weakKey"].concat(_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput.requiredModules),_class7.iPool=Object.assign(ex,_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentInput.iPool.copy()),_class7),SlaveContainer:(_class8=class extends _Base__WEBPACK_IMPORTED_MODULE_3__.Component{render(){return this.state.ready?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(this.ex.sc.URLContext,{getChildren:e=>{let t=this.ex.lb.LinoBody,s=e[_constants__WEBPACK_IMPORTED_MODULE_2__.URL_PARAM_DISPLAY_MODE],n=[_constants__WEBPACK_IMPORTED_MODULE_2__.DISPLAY_MODE_SUMMARY,_constants__WEBPACK_IMPORTED_MODULE_2__.DISPLAY_MODE_HTML].includes(s)?this.props.elem[s]:null;return e.controller.filled(n)&&(t=LinoComponents[n.react_name]),e.controller.filled(n)?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(t,{elem:n,...this.props}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(t,{actorData:e.static.actorData,inDetail:!0})},params:{[_constants__WEBPACK_IMPORTED_MODULE_2__.URL_PARAM_MASTER_PK]:this.props.urlParams.pk,[_constants__WEBPACK_IMPORTED_MODULE_2__.URL_PARAM_MASTER_TYPE]:this.props.urlParams.static.actorData.content_type},parentContext:this.props.urlParams.controller,path:`/api/${this.props.elem.actor_id.split(".").join("/")}`,simple:!1}):null}},_class8.requiredModules=["lb","sc"],_class8.iPool=ex,_class8),SimpleRemoteComboFieldElement:e=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_ForeignKeyElement__WEBPACK_IMPORTED_MODULE_5__.E,{...e,simple:!0,link:!1}),UnknownElement:e=>{const t=react__WEBPACK_IMPORTED_MODULE_1__.useContext(_Base__WEBPACK_IMPORTED_MODULE_3__.DataContextType);let s=_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.ABCComponent.getValueByName({name:e[_constants__WEBPACK_IMPORTED_MODULE_2__.URL_PARAM_WINDOW_TYPE]===_constants__WEBPACK_IMPORTED_MODULE_2__.WINDOW_TYPE_TABLE?e.elem.fields_index:e.elem.name,props:e,context:t});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.Labeled,{...e,elem:e.elem,labeled:e.labeled,isFilled:e.urlParams.controller.filled(s),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:s||" "})})}};LinoComponents.Panel.defaultProps={header:!0},LinoComponents.ActionParamsPanel=LinoComponents.Panel,LinoComponents.ParamsPanel=LinoComponents.Panel,LinoComponents.DetailMainPanel=LinoComponents.Panel,LinoComponents.ComplexRemoteComboFieldElement=LinoComponents.ForeignKeyElement,LinoComponents.QuantityFieldElement=LinoComponents.CharFieldElement,LinoComponents.HtmlBoxElement=LinoComponents.SlaveSummaryPanel,LinoComponents.DateTimeFieldElement=LinoComponents.DisplayElement,LinoComponents.GenericForeignKeyElement=LinoComponents.DisplayElement,LinoComponents.IncompleteDateFieldElement=LinoComponents.CharFieldElement,LinoComponents.ManyToManyElement=LinoComponents.DisplayElement,LinoComponents.StoryElement=LinoComponents.SlaveSummaryPanel,LinoComponents.ListElement=LinoComponents.SlaveSummaryPanel,LinoComponents.GridElement=LinoComponents.SlaveContainer;class LinoLayout extends _Base__WEBPACK_IMPORTED_MODULE_3__.Component{async prepare(){this.ex.weakKey=this.ex.weakKey.default}constructor(e){super(e),this.inputCount=0,this.renderComponent=this.renderComponent.bind(this)}render(){if(!this.state.ready)return null;this.inputCount=0;let e=this.props.elem?this.props.elem:this.context.controller.APP.state.site_data.form_panels[this.props.window_layout].main;return this.renderComponent(e.react_name,{...this.props,elem:e})}renderComponent(e,t){let s=LinoComponents[e];return void 0===s&&(s=LinoComponents.UnknownElement,console.warn(`${e} does not exist`)),this.inputCount+=1,t.tabIndex=this.props.tabIndex>-1?this.props.tabIndex:this.inputCount,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(s,{...t,urlParams:this.context,editing_mode:t.editing_mode||this.context.editing_mode,children:t.elem.items&&t.elem.items.filter((e=>!e.hidden)).map(((e,s)=>this.renderComponent(e.react_name,{...t,editing_mode:t.editing_mode||this.context.editing_mode,key:this.ex.weakKey(e),elem:e,parent:t.elem,urlParams:this.context})))})}}LinoLayout.requiredModules=["weakKey"],LinoLayout.iPool=ex,LinoLayout.contextType=_Base__WEBPACK_IMPORTED_MODULE_3__.URLContextType,LinoLayout.propTypes={..._LinoComponentUtils__WEBPACK_IMPORTED_MODULE_4__.LeafComponentBase.propTypesFromLinoLayout,window_layout:prop_types__WEBPACK_IMPORTED_MODULE_9___default().string},LinoLayout.defaultProps={editing_mode:!1,tabIndex:-1}},6003:(e,t,s)=>{s.d(t,{v:()=>C,S:()=>P});s(3232);var n=s(1914),i=s(9281),_=(s(8702),s(6552));let a;a={queryString:Promise.resolve().then(s.t.bind(s,5198,19))};(0,i.RegisterImportPool)(a);const l=[{value:"Mention @People"}],r=[{value:"Tag #content"}],o=({silentFetch:e,signal:t})=>({allowedChars:/^[A-Za-z0-9\s]*$/,mentionDenotationChars:window.App.state.site_data.suggestors,source:function(s,n,i){if(0===s.length){n("@"===i?l:r,s)}else a.resolve(["queryString"]).then((({queryString:_})=>{e({path:`suggestions?${_.stringify({query:s,trigger:i})}`,signal:t}).then((e=>n(e.suggestions,s)))}))},renderItem:function(e,t){let s="";return e&&(e.value&&(s+=e.value),e.title&&(s+=": "+e.title)),s.toLowerCase().split(t.toLowerCase()).join("<span class='search-match'>"+t+"</span>")},listItemClass:"ql-mention-list-item",mentionContainerClass:"ql-mention-list-container",mentionListClass:"ql-mention-list",dataAttributes:["value","link","title","denotationChar"]}),p=(0,_.jsxs)(n.Fragment,{children:[(0,_.jsxs)("span",{className:"ql-formats",children:[(0,_.jsxs)("select",{className:"ql-header",defaultValue:"0",children:[(0,_.jsx)("option",{value:"1",children:"Heading"}),(0,_.jsx)("option",{value:"2",children:"Subheading"}),(0,_.jsx)("option",{value:"0",children:"Normal"})]}),(0,_.jsxs)("select",{className:"ql-font",children:[(0,_.jsx)("option",{defaultValue:!0}),(0,_.jsx)("option",{value:"serif"}),(0,_.jsx)("option",{value:"monospace"})]})]}),(0,_.jsx)("span",{className:"ql-formats",children:(0,_.jsxs)("select",{className:"ql-size",children:[(0,_.jsx)("option",{value:"small"}),(0,_.jsx)("option",{defaultValue:!0}),(0,_.jsx)("option",{value:"large"}),(0,_.jsx)("option",{value:"huge"})]})}),(0,_.jsxs)("span",{className:"ql-formats",children:[(0,_.jsx)("button",{className:"ql-script",value:"sub"}),(0,_.jsx)("button",{className:"ql-script",value:"super"})]}),(0,_.jsxs)("span",{className:"ql-formats",children:[(0,_.jsx)("button",{type:"button",className:"ql-bold","aria-label":"Bold"}),(0,_.jsx)("button",{type:"button",className:"ql-italic","aria-label":"Italic"}),(0,_.jsx)("button",{type:"button",className:"ql-underline","aria-label":"Underline"})]}),(0,_.jsxs)("span",{className:"ql-formats",children:[(0,_.jsx)("select",{className:"ql-color"}),(0,_.jsx)("select",{className:"ql-background"})]}),(0,_.jsxs)("span",{className:"ql-formats",children:[(0,_.jsx)("button",{type:"button",className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,_.jsx)("button",{type:"button",className:"ql-list",value:"bullet","aria-label":"Unordered List"}),(0,_.jsxs)("select",{className:"ql-align",children:[(0,_.jsx)("option",{defaultValue:!0}),(0,_.jsx)("option",{value:"center"}),(0,_.jsx)("option",{value:"right"}),(0,_.jsx)("option",{value:"justify"})]})]}),(0,_.jsxs)("span",{className:"ql-formats",children:[(0,_.jsx)("button",{type:"button",className:"ql-link","aria-label":"Insert Link"}),(0,_.jsx)("button",{type:"button",className:"ql-image","aria-label":"Insert Image"}),(0,_.jsx)("button",{type:"button",className:"ql-code-block","aria-label":"Insert Code Block"})]}),(0,_.jsx)("span",{className:"ql-formats",children:(0,_.jsx)("button",{type:"button",className:"ql-clean","aria-label":"Remove Styles"})})]}),d={header:p,headerMain:(e={})=>(0,_.jsxs)(n.Fragment,{children:[p,(0,_.jsx)("span",{className:"ql-formats",children:(0,_.jsx)("button",{type:"button",ref:e.ref,"aria-label":"Open in own window",children:(0,_.jsx)("i",{className:"pi pi-external-link"})})})]})};var u=s(1300),h=s(1230);let c;c={AbortController:s.e(1473).then(s.t.bind(s,4862,23)),prButton:Promise.resolve().then(s.bind(s,4917)),prEditor:s.e(3486).then(s.bind(s,2354)),prDialog:Promise.all([s.e(9880),s.e(5092)]).then(s.bind(s,7295))};(0,i.RegisterImportPool)(c);class m extends i.Component{async prepare(){this.controller=new this.ex.AbortController.default}render(){return this.state.ready?(0,_.jsx)("div",{className:"l-editor",onKeyDown:e=>{[13,9,33,34,35,36,46].includes(e.keyCode)||e.altKey||e.metaKey||e.shiftKey?e.stopPropagation():e.ctrlKey&&83===e.keyCode&&(e.stopPropagation(),e.preventDefault(),this.props.onDone(e))},children:(0,_.jsx)(this.ex.prDialog.Dialog,{header:this.props.label,icons:(0,_.jsx)(this.ex.prButton.Button,{className:"p-transparent-button",style:{border:"0px",background:"transparent",color:"black"},onClick:e=>{this.props.onDone(e)},icon:"pi pi-save",tooltip:"Save!",label:""}),maximizable:!0,modal:!0,onHide:e=>{this.props.onClose(e)},style:{width:"70vw",height:"85vw"},contentStyle:{height:"100%"},visible:this.props.visible,children:(0,_.jsx)(this.ex.prEditor.Editor,{headerTemplate:d.header,modules:{mention:o({silentFetch:this.props.silentFetch,signal:this.controller.signal})},onTextChange:e=>this.props.onTextChange(e),value:this.props.value})})}):null}}let E;m.requiredModules=["AbortController","prButton","prEditor","prDialog"],m.iPool=c;E={AbortController:s.e(1473).then(s.t.bind(s,4862,23)),prButton:Promise.resolve().then(s.bind(s,4917)),prEditor:s.e(3486).then(s.bind(s,2354)),prPanel:Promise.all([s.e(3486),s.e(4709),s.e(6999)]).then(s.bind(s,2124))};(0,i.RegisterImportPool)(E);class P extends h.LeafComponentInput{constructor(e){super(e),this.state={...this.state,new_window:!1},this.ownWindowButton=n.createRef(),this.getInput=this.getInput.bind(this),this.innerHTML=this.innerHTML.bind(this),this.onDiagClose=this.onDiagClose.bind(this),this.onDiagDone=this.onDiagDone.bind(this),this.onTextChange=this.onTextChange.bind(this),this.onQuillLoad=this.onQuillLoad.bind(this),this.updateValue=this.updateValue.bind(this)}async prepare(){await super.prepare(),this.controller=new this.ex.AbortController.default,this.setLeafRef({input:!0,type:this.props.elem.field_options.virtualField?"virtual":""})}componentWillUnmount(){this.controller.abort()}getInput(){return(0,_.jsx)(n.Fragment,{children:(0,_.jsx)("div",{className:"l-editor",style:{position:"relative"},onClick:e=>{e.stopPropagation()},onKeyDown:e=>{[13,9,33,34,35,36,46].includes(e.keyCode)&&e.stopPropagation()},children:(0,_.jsx)(this.ex.prEditor.Editor,{headerTemplate:this.props.elem.field_options.noEditorHeader?(0,_.jsx)("div",{}):d.headerMain({ref:this.ownWindowButton}),modules:{mention:o({silentFetch:this.props.urlParams.controller.actionHandler.silentFetch,signal:this.controller.signal})},onLoad:this.onQuillLoad,onTextChange:this.onTextChange,ref:e=>this.inputEl=e,style:{height:"100%"},tabIndex:this.props.tabIndex,value:this.getValue()})})})}innerHTML(){if(this.props.elem.field_options.alwaysEditable)return(0,_.jsx)(n.Fragment,{children:this.getInput()});let e=super.innerHTML(u.DANGEROUS_HTML);return this.props[u.URL_PARAM_WINDOW_TYPE]===u.WINDOW_TYPE_TABLE?e:(0,_.jsx)(this.ex.prPanel.Panel,{headerTemplate:(0,_.jsxs)("div",{className:"p-panel-header",children:[this.props.elem.label,!this.disabled()&&(0,_.jsx)(this.ex.prButton.Button,{className:"p-transparent-button",style:{border:"0px",background:"transparent",color:"black"},onClick:e=>{e.stopPropagation(),this.setState({new_window:!0})},icon:"pi pi-pencil",tooltip:"Edit this text in own window",tooltipOptions:{position:"left"},label:""})]}),style:{display:"flex",flexDirection:"column",height:"100%"},children:e})}updateValue(e){this.update({[this.dataKey]:e})}onDiagClose(e){this.setState({new_window:!1})}onDiagDone(){this.setState({new_window:!1}),this.submit()}onTextChange(e){let t=e.htmlValue||"";this.updateValue(t),this.setState({})}onQuillLoad(){this.tabIndexMatch()&&this.inputEl.quill.focus(),this.props.elem.field_options.noEditorHeader||this.ownWindowButton.current.addEventListener("click",(e=>{e.stopPropagation(),this.setState({new_window:!0})}))}render(){return this.state.ready?(0,_.jsxs)(n.Fragment,{children:[this.props.editing_mode||this.props.elem.field_options.noHeaderDecore?super.render():this.innerHTML(),(0,_.jsx)(m,{silentFetch:this.props.urlParams.controller.actionHandler.silentFetch,onTextChange:this.onTextChange,onClose:this.onDiagClose,onDone:this.onDiagDone,value:this.getValue(),visible:this.state.new_window})]}):null}}P.requiredModules=["AbortController","prButton","prEditor","prPanel"].concat(h.LeafComponentInput.requiredModules),P.iPool=Object.assign(E,h.LeafComponentInput.iPool.copy());const C=P},9426:(e,t,s)=>{s.r(t),s.d(t,{DateFieldElement:()=>u,DateFilter:()=>c,TimeFieldElement:()=>h,name:()=>o});s(1914);var n=s(2972),i=s.n(n),_=s(1300),a=s(1230),l=s(9281),r=s(6552);const o="datetime";let p;p={prCalendar:Promise.all([s.e(1295),s.e(3486),s.e(7353),s.e(5155),s.e(7320),s.e(2109),s.e(4873),s.e(6839),s.e(3588)]).then(s.bind(s,3736))};(0,l.RegisterImportPool)(p);class d extends a.LeafComponentInput{constructor(e){super(e),this.innerHTML=()=>(0,r.jsx)("div",{children:super.getValue()||" "}),this.isValid=e=>null===e||e instanceof Date||this.str2date(e)instanceof Date,this.getInput=this.getInput.bind(this),this.getValue=this.getValue.bind(this),this.innerHTML=this.innerHTML.bind(this),this.isValid=this.isValid.bind(this),this.updateValue=this.updateValue.bind(this)}getInput(e={}){return(0,r.jsx)(this.ex.prCalendar.Calendar,{...e,className:"l-DateFieldElement",inputMode:this.props.urlParams.controller.static.isMobile?"numeric":"none",inputStyle:{width:"100%"},keepInvalid:!0,onChange:e=>this.updateValue(e),onClearButtonClick:e=>{e.value=null,this.updateValue(e)},onSelect:e=>this.updateValue(e),ref:this.onInputRef,showButtonBar:!0,showIcon:this.props[_.URL_PARAM_WINDOW_TYPE]!==_.WINDOW_TYPE_TABLE,showOnFocus:!1,style:{width:"100%"},tabIndex:this.props.tabIndex,value:this.getValue()})}getValue(){let e=super.getValue();return this.props.urlParams.controller.filled(e)?this.str2date(e):null}updateValue(e){let t=e.value;this.props.urlParams.controller.filled(t)?t instanceof Date&&(t=this.date2str(t)):t=null,this.container.classList.remove("dangling-modification"),this.container.classList.remove("unsaved-modification"),this.isValid(t)?(this.update({[this.dataKey]:t}),this.setCellStyle(this.container)):this.container.classList.add("dangling-modification")}}d.requiredModules=["prCalendar"].concat(a.LeafComponentInput.requiredModules),d.iPool=Object.assign(p,a.LeafComponentInput.iPool.copy());class u extends d{constructor(e){super(e),this.date2str=this.date2str.bind(this),this.getInput=this.getInput.bind(this),this.str2date=this.str2date.bind(this)}date2str(e){return("0"+e.getDate()).slice(-2)+"."+("0"+(e.getMonth()+1)).slice(-2)+"."+e.getFullYear()}getInput(){return super.getInput({dateFormat:"dd.mm.yy",yearNavigator:!0,yearRange:"1900:2900"})}str2date(e){let t=e.split(".");return 3===t.length&&!t.includes("")&&4===t[2].length&&new Date(t[2],t[1]-1,t[0])}}class h extends d{constructor(e){super(e),this.date2str=this.date2str.bind(this),this.getInput=this.getInput.bind(this),this.str2date=this.str2date.bind(this)}date2str(e){return("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)}getInput(){return super.getInput({hourFormat:"24",showTime:!0,timeOnly:!0})}str2date(e){let t=/^(\d(?:\d(?=[.,:; ]?\d\d|[.,:; ]\d|$))?)?[.,:; ]?(\d{0,2})$/g;if(e.match(t)){let s=t.exec(e),n=new Date,i=s[1],_=s[2];return n.setHours(i||0),n.setMinutes(_||0),n}return!1}}class c extends u{constructor(e){super(e),this.filled=()=>this.props.parent.context.controller.filled(this.props.value),this.disabled=()=>!1,this.update=e=>this.props.parent.pushFilter({value:e[this.dataKey]}),this.disabled=this.disabled.bind(this),this.filled=this.filled.bind(this),this.getValue=this.getValue.bind(this),this.update=this.update.bind(this)}getValue(){return this.filled()?this.str2date(this.props.parent.state.value):null}}c.propTypes={parent:i().object.isRequired},c.defaultProps={editing_mode:!0,hide_label:!0}}}]);
//# sourceMappingURL=main.LinoComponents_LinoDetail.c17e4fdc6ace5e3cf1af.js.map